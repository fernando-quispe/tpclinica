import{$ as F,$a as Wc,$b as nm,A as Oc,Aa as St,B as Tp,C as xc,Ca as Gc,Da as Xn,E as ot,Ea as Zn,F as Jn,Fa as Mp,G as Wt,Ga as Lp,H as Mc,Ha as Vp,I as Yn,Ia as Fp,J as Ap,Ja as Up,K as _n,Ka as jp,L as Kt,La as $p,Lb as Xp,M as Lc,Ma as In,N as bp,O as Vc,P as Fc,Pa as Bp,Q as ze,Qb as Qs,R as Sp,Ra as di,Rb as Zp,S as Ie,Sb as Js,T as ue,Ta as er,Tb as em,Ua as qp,Ub as Hc,V as X,Vb as Ys,W as ci,Wb as Xs,X as Rp,Xa as zp,Xb as Zs,Y as ie,Ya as Gp,Yb as Qc,Z as Uc,Zb as tm,_ as H,_a as pe,_b as eo,a as V,aa as Ue,ab as Wp,ac as Jc,b as Re,ba as Cp,bc as rm,ca as ui,cc as im,d as qt,da as Hs,db as Kp,dc as $e,e as _,ea as Pp,eb as Hp,ec as sm,f as vp,fa as li,fb as Kc,fc as pi,g as Rc,ga as jc,gb as fi,gc as om,h as At,hc as am,i as Cc,ia as tt,ib as Qp,ic as mi,j as Pc,jc as to,k as zt,ka as Dp,l as Je,la as Ht,m as _p,ma as at,n as Ip,na as $c,o as Gt,p as Dc,pb as Jp,pc as cm,q as Nc,r as kc,ra as Bc,rc as no,s as Ce,sa as Np,sc as um,t as j,ta as bt,tc as ro,u as ai,ua as qc,ub as Yp,v as wp,va as kp,w as Ep,wa as hi,x as ee,xa as Op,y as Ks,ya as zc,z as qe,za as xp}from"./chunk-JRU3JP26.js";var yi=class{},so=class{},wn=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),a=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let a=this.headers.get(t);if(!a)return;a=a.filter(c=>s.indexOf(c)===-1),a.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}break}}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var Xc=class{encodeKey(e){return lm(e)}encodeValue(e){return lm(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function AI(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[a,c]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=t.get(a)||[];l.push(c),t.set(a,l)}),t}var bI=/%(\d[a-f0-9])/gi,SI={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function lm(n){return encodeURIComponent(n).replace(bI,(e,t)=>SI[t]??e)}function io(n){return`${n}`}var Qt=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Xc,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=AI(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(io):[io(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(io(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(io(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Zc=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function RI(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function hm(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function dm(n){return typeof Blob<"u"&&n instanceof Blob}function fm(n){return typeof FormData<"u"&&n instanceof FormData}function CI(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var gi=class n{constructor(e,t,r,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(RI(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new wn,this.context??=new Zc,!this.params)this.params=new Qt,this.urlWithParams=t;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),l=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+l+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||hm(this.body)||dm(this.body)||fm(this.body)||CI(this.body)?this.body:this.body instanceof Qt?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||fm(this.body)?null:dm(this.body)?this.body.type||null:hm(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Qt?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,a=e.body!==void 0?e.body:this.body,c=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,h=e.headers||this.headers,f=e.params||this.params,g=e.context??this.context;return e.setHeaders!==void 0&&(h=Object.keys(e.setHeaders).reduce((I,R)=>I.set(R,e.setHeaders[R]),h)),e.setParams&&(f=Object.keys(e.setParams).reduce((I,R)=>I.set(R,e.setParams[R]),f)),new n(t,r,a,{params:f,headers:h,context:g,reportProgress:l,responseType:i,withCredentials:c,transferCache:s})}},tr=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(tr||{}),vi=class{constructor(e,t=co.Ok,r="OK"){this.headers=e.headers||new wn,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},eu=class n extends vi{constructor(e={}){super(e),this.type=tr.ResponseHeader}clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},oo=class n extends vi{constructor(e={}){super(e),this.type=tr.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},ao=class extends vi{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},co=function(n){return n[n.Continue=100]="Continue",n[n.SwitchingProtocols=101]="SwitchingProtocols",n[n.Processing=102]="Processing",n[n.EarlyHints=103]="EarlyHints",n[n.Ok=200]="Ok",n[n.Created=201]="Created",n[n.Accepted=202]="Accepted",n[n.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",n[n.NoContent=204]="NoContent",n[n.ResetContent=205]="ResetContent",n[n.PartialContent=206]="PartialContent",n[n.MultiStatus=207]="MultiStatus",n[n.AlreadyReported=208]="AlreadyReported",n[n.ImUsed=226]="ImUsed",n[n.MultipleChoices=300]="MultipleChoices",n[n.MovedPermanently=301]="MovedPermanently",n[n.Found=302]="Found",n[n.SeeOther=303]="SeeOther",n[n.NotModified=304]="NotModified",n[n.UseProxy=305]="UseProxy",n[n.Unused=306]="Unused",n[n.TemporaryRedirect=307]="TemporaryRedirect",n[n.PermanentRedirect=308]="PermanentRedirect",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.PaymentRequired=402]="PaymentRequired",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.MethodNotAllowed=405]="MethodNotAllowed",n[n.NotAcceptable=406]="NotAcceptable",n[n.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",n[n.RequestTimeout=408]="RequestTimeout",n[n.Conflict=409]="Conflict",n[n.Gone=410]="Gone",n[n.LengthRequired=411]="LengthRequired",n[n.PreconditionFailed=412]="PreconditionFailed",n[n.PayloadTooLarge=413]="PayloadTooLarge",n[n.UriTooLong=414]="UriTooLong",n[n.UnsupportedMediaType=415]="UnsupportedMediaType",n[n.RangeNotSatisfiable=416]="RangeNotSatisfiable",n[n.ExpectationFailed=417]="ExpectationFailed",n[n.ImATeapot=418]="ImATeapot",n[n.MisdirectedRequest=421]="MisdirectedRequest",n[n.UnprocessableEntity=422]="UnprocessableEntity",n[n.Locked=423]="Locked",n[n.FailedDependency=424]="FailedDependency",n[n.TooEarly=425]="TooEarly",n[n.UpgradeRequired=426]="UpgradeRequired",n[n.PreconditionRequired=428]="PreconditionRequired",n[n.TooManyRequests=429]="TooManyRequests",n[n.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",n[n.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",n[n.InternalServerError=500]="InternalServerError",n[n.NotImplemented=501]="NotImplemented",n[n.BadGateway=502]="BadGateway",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout",n[n.HttpVersionNotSupported=505]="HttpVersionNotSupported",n[n.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",n[n.InsufficientStorage=507]="InsufficientStorage",n[n.LoopDetected=508]="LoopDetected",n[n.NotExtended=510]="NotExtended",n[n.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",n}(co||{});function Yc(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var PI=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,s={}){let a;if(r instanceof gi)a=r;else{let h;s.headers instanceof wn?h=s.headers:h=new wn(s.headers);let f;s.params&&(s.params instanceof Qt?f=s.params:f=new Qt({fromObject:s.params})),a=new gi(r,i,s.body!==void 0?s.body:null,{headers:h,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let c=j(a).pipe(Wt(h=>this.handler.handle(h)));if(r instanceof gi||s.observe==="events")return c;let l=c.pipe(ot(h=>h instanceof oo));switch(s.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return l.pipe(ee(h=>{if(h.body!==null&&!(h.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return h.body}));case"blob":return l.pipe(ee(h=>{if(h.body!==null&&!(h.body instanceof Blob))throw new Error("Response is not a Blob.");return h.body}));case"text":return l.pipe(ee(h=>{if(h.body!==null&&typeof h.body!="string")throw new Error("Response is not a string.");return h.body}));case"json":default:return l.pipe(ee(h=>h.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new Qt().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,s={}){return this.request("PATCH",r,Yc(s,i))}post(r,i,s={}){return this.request("POST",r,Yc(s,i))}put(r,i,s={}){return this.request("PUT",r,Yc(s,i))}};e.\u0275fac=function(i){return new(i||e)(H(yi))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();function ym(n,e){return e(n)}function DI(n,e){return(t,r)=>e.intercept(t,{handle:i=>n(i,r)})}function NI(n,e,t){return(r,i)=>at(t,()=>e(r,s=>n(s,i)))}var kI=new ie(""),nu=new ie(""),OI=new ie(""),xI=new ie("");function MI(){let n=null;return(e,t)=>{n===null&&(n=(F(kI,{optional:!0})??[]).reduceRight(DI,ym));let r=F(fi),i=r.add();return n(e,t).pipe(_n(()=>r.remove(i)))}}var pm=(()=>{let e=class e extends yi{constructor(r,i){super(),this.backend=r,this.injector=i,this.chain=null,this.pendingTasks=F(fi);let s=F(xI,{optional:!0});this.backend=s??r}handle(r){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(nu),...this.injector.get(OI,[])]));this.chain=s.reduceRight((a,c)=>NI(a,c,this.injector),ym)}let i=this.pendingTasks.add();return this.chain(r,s=>this.backend.handle(s)).pipe(_n(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(H(so),H(Ht))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();var LI=/^\)\]\}',?\n/;function VI(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var mm=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new ue(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?Ce(i.\u0275loadImpl()):j(null)).pipe(ze(()=>new At(a=>{let c=i.build();if(c.open(r.method,r.urlWithParams),r.withCredentials&&(c.withCredentials=!0),r.headers.forEach((C,x)=>c.setRequestHeader(C,x.join(","))),r.headers.has("Accept")||c.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let C=r.detectContentTypeHeader();C!==null&&c.setRequestHeader("Content-Type",C)}if(r.responseType){let C=r.responseType.toLowerCase();c.responseType=C!=="json"?C:"text"}let l=r.serializeBody(),h=null,f=()=>{if(h!==null)return h;let C=c.statusText||"OK",x=new wn(c.getAllResponseHeaders()),q=VI(c)||r.url;return h=new eu({headers:x,status:c.status,statusText:C,url:q}),h},g=()=>{let{headers:C,status:x,statusText:q,url:Q}=f(),K=null;x!==co.NoContent&&(K=typeof c.response>"u"?c.responseText:c.response),x===0&&(x=K?co.Ok:0);let _e=x>=200&&x<300;if(r.responseType==="json"&&typeof K=="string"){let ne=K;K=K.replace(LI,"");try{K=K!==""?JSON.parse(K):null}catch(E){K=ne,_e&&(_e=!1,K={error:E,text:K})}}_e?(a.next(new oo({body:K,headers:C,status:x,statusText:q,url:Q||void 0})),a.complete()):a.error(new ao({error:K,headers:C,status:x,statusText:q,url:Q||void 0}))},I=C=>{let{url:x}=f(),q=new ao({error:C,status:c.status||0,statusText:c.statusText||"Unknown Error",url:x||void 0});a.error(q)},R=!1,N=C=>{R||(a.next(f()),R=!0);let x={type:tr.DownloadProgress,loaded:C.loaded};C.lengthComputable&&(x.total=C.total),r.responseType==="text"&&c.responseText&&(x.partialText=c.responseText),a.next(x)},O=C=>{let x={type:tr.UploadProgress,loaded:C.loaded};C.lengthComputable&&(x.total=C.total),a.next(x)};return c.addEventListener("load",g),c.addEventListener("error",I),c.addEventListener("timeout",I),c.addEventListener("abort",I),r.reportProgress&&(c.addEventListener("progress",N),l!==null&&c.upload&&c.upload.addEventListener("progress",O)),c.send(l),a.next({type:tr.Sent}),()=>{c.removeEventListener("error",I),c.removeEventListener("abort",I),c.removeEventListener("load",g),c.removeEventListener("timeout",I),r.reportProgress&&(c.removeEventListener("progress",N),l!==null&&c.upload&&c.upload.removeEventListener("progress",O)),c.readyState!==c.DONE&&c.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(H(ro))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),vm=new ie(""),FI="XSRF-TOKEN",UI=new ie("",{providedIn:"root",factory:()=>FI}),jI="X-XSRF-TOKEN",$I=new ie("",{providedIn:"root",factory:()=>jI}),uo=class{},BI=(()=>{let e=class e{constructor(r,i,s){this.doc=r,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=to(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(H($e),H(St),H(UI))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();function qI(n,e){let t=n.url.toLowerCase();if(!F(vm)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=F(uo).getToken(),i=F($I);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var _m=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(_m||{});function zI(n,e){return{\u0275kind:n,\u0275providers:e}}function GI(...n){let e=[PI,mm,pm,{provide:yi,useExisting:pm},{provide:so,useExisting:mm},{provide:nu,useValue:qI,multi:!0},{provide:vm,useValue:!0},{provide:uo,useClass:BI}];for(let t of n)e.push(...t.\u0275providers);return tt(e)}var gm=new ie("");function WI(){return zI(_m.LegacyInterceptors,[{provide:gm,useFactory:MI},{provide:nu,useExisting:gm,multi:!0}])}var EC=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=li({type:e}),e.\u0275inj=ci({providers:[GI(WI())]});let n=e;return n})();var su=class extends im{constructor(){super(...arguments),this.supportsDOMEvents=!0}},ou=class n extends su{static makeCurrent(){rm(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=HI();return t==null?null:QI(t)}resetBaseElement(){_i=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return to(document.cookie,e)}},_i=null;function HI(){return _i=_i||document.querySelector("base"),_i?_i.getAttribute("href"):null}function QI(n){return new URL(n,document.baseURI).pathname}var JI=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),au=new ie(""),Tm=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(a=>a.supports(r)),!i)throw new ue(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(H(au),H(pe))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),lo=class{constructor(e){this._doc=e}},ru="ng-app-id",Am=(()=>{let e=class e{constructor(r,i,s,a={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=a,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=no(a),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${ru}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let a=s.get(r);return a.usage+=i,a.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,a=s?.get(i);if(a?.parentNode===r)return s.delete(i),a.removeAttribute(ru),a;{let c=this.doc.createElement("style");return this.nonce&&c.setAttribute("nonce",this.nonce),c.textContent=i,this.platformIsServer&&c.setAttribute(ru,this.appId),r.appendChild(c),c}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),a=this.styleRef,c=a.get(i)?.elements;c?c.push(s):a.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(H($e),H(zc),H(Gc,8),H(St))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),iu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},uu=/%COMP%/g,bm="%COMP%",YI=`_nghost-${bm}`,XI=`_ngcontent-${bm}`,ZI=!0,ew=new ie("",{providedIn:"root",factory:()=>ZI});function tw(n){return XI.replace(uu,n)}function nw(n){return YI.replace(uu,n)}function Sm(n,e){return e.map(t=>t.replace(uu,n))}var Im=(()=>{let e=class e{constructor(r,i,s,a,c,l,h,f=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=a,this.doc=c,this.platformId=l,this.ngZone=h,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=no(l),this.defaultRenderer=new Ii(r,c,h,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ui.ShadowDom&&(i=Re(V({},i),{encapsulation:ui.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof ho?s.applyToHost(r):s instanceof wi&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,a=s.get(i.id);if(!a){let c=this.doc,l=this.ngZone,h=this.eventManager,f=this.sharedStylesHost,g=this.removeStylesOnCompDestroy,I=this.platformIsServer;switch(i.encapsulation){case ui.Emulated:a=new ho(h,f,i,this.appId,g,c,l,I);break;case ui.ShadowDom:return new cu(h,f,r,i,c,l,this.nonce,I);default:a=new wi(h,f,i,g,c,l,I);break}s.set(i.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(H(Tm),H(Am),H(zc),H(ew),H($e),H(St),H(pe),H(Gc))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),Ii=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(iu[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(wm(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(wm(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ue(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=iu[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=iu[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(di.DashCase|di.Important)?e.style.setProperty(t,r,i&di.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&di.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Jc().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function wm(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var cu=class extends Ii{constructor(e,t,r,i,s,a,c,l){super(e,s,a,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=Sm(i.id,i.styles);for(let f of h){let g=document.createElement("style");c&&g.setAttribute("nonce",c),g.textContent=f,this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},wi=class extends Ii{constructor(e,t,r,i,s,a,c,l){super(e,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=l?Sm(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},ho=class extends wi{constructor(e,t,r,i,s,a,c,l){let h=i+"-"+r.id;super(e,t,r,s,a,c,l,h),this.contentAttr=tw(h),this.hostAttr=nw(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},rw=(()=>{let e=class e extends lo{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(H($e))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),Em=["alt","control","meta","shift"],iw={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},sw={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},ow=(()=>{let e=class e extends lo{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let a=e.parseEventName(i),c=e.eventCallback(a.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Jc().onAndCancel(r,a.domEventName,c))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let a=e._normalizeKey(i.pop()),c="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),c="code."),Em.forEach(f=>{let g=i.indexOf(f);g>-1&&(i.splice(g,1),c+=f+".")}),c+=a,i.length!=0||a.length===0)return null;let h={};return h.domEventName=s,h.fullKey=c,h}static matchEventFullKeyCode(r,i){let s=iw[r.key]||r.key,a="";return i.indexOf("code.")>-1&&(s=r.code,a="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Em.forEach(c=>{if(c!==s){let l=sw[c];l(r)&&(a+=c+".")}}),a+=s,a===i)}static eventCallback(r,i,s){return a=>{e.matchEventFullKeyCode(a,r)&&s.runGuarded(()=>i(a))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(H($e))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();function qC(n,e){return tm(V({rootComponent:n},aw(e)))}function aw(n){return{appProviders:[...dw,...n?.providers??[]],platformProviders:hw}}function cw(){ou.makeCurrent()}function uw(){return new qc}function lw(){return Op(document),document}var hw=[{provide:St,useValue:cm},{provide:xp,useValue:cw,multi:!0},{provide:$e,useFactory:lw,deps:[]}];var dw=[{provide:Dp,useValue:"root"},{provide:qc,useFactory:uw,deps:[]},{provide:au,useClass:rw,multi:!0,deps:[$e,pe,St]},{provide:au,useClass:ow,multi:!0,deps:[$e]},Im,Am,Tm,{provide:zp,useExisting:Im},{provide:ro,useClass:JI,deps:[]},[]];var Rm=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(H($e))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var fw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:function(i){let s=null;return i?s=new(i||e):s=H(pw),s},providedIn:"root"});let n=e;return n})(),pw=(()=>{let e=class e extends fw{constructor(r){super(),this._doc=r}sanitize(r,i){if(i==null)return null;switch(r){case In.NONE:return i;case In.HTML:return Zn(i,"HTML")?Xn(i):$p(this._doc,String(i)).toString();case In.STYLE:return Zn(i,"Style")?Xn(i):i;case In.SCRIPT:if(Zn(i,"Script"))return Xn(i);throw new ue(5200,!1);case In.URL:return Zn(i,"URL")?Xn(i):jp(String(i));case In.RESOURCE_URL:if(Zn(i,"ResourceURL"))return Xn(i);throw new ue(5201,!1);default:throw new ue(5202,!1)}}bypassSecurityTrustHtml(r){return Mp(r)}bypassSecurityTrustStyle(r){return Lp(r)}bypassSecurityTrustScript(r){return Vp(r)}bypassSecurityTrustUrl(r){return Fp(r)}bypassSecurityTrustResourceUrl(r){return Up(r)}};e.\u0275fac=function(i){return new(i||e)(H($e))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var W="primary",Vi=Symbol("RouteTitle"),pu=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function or(n){return new pu(n)}function gw(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let a=r[s],c=n[s];if(a.startsWith(":"))i[a.substring(1)]=c;else if(a!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function yw(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ct(n[t],e[t]))return!1;return!0}function ct(n,e){let t=n?mu(n):void 0,r=e?mu(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Lm(n[i],e[i]))return!1;return!0}function mu(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Lm(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Vm(n){return n.length>0?n[n.length-1]:null}function en(n){return wp(n)?n:em(n)?Ce(Promise.resolve(n)):j(n)}var vw={exact:Um,subset:jm},Fm={exact:_w,subset:Iw,ignored:()=>!0};function Cm(n,e,t){return vw[t.paths](n.root,e.root,t.matrixParams)&&Fm[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function _w(n,e){return ct(n,e)}function Um(n,e,t){if(!Tn(n.segments,e.segments)||!mo(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Um(n.children[r],e.children[r],t))return!1;return!0}function Iw(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Lm(n[t],e[t]))}function jm(n,e,t){return $m(n,e,e.segments,t)}function $m(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Tn(i,t)||e.hasChildren()||!mo(i,t,r))}else if(n.segments.length===t.length){if(!Tn(n.segments,t)||!mo(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!jm(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Tn(n.segments,i)||!mo(n.segments,i,r)||!n.children[W]?!1:$m(n.children[W],e,s,r)}}function mo(n,e,t){return e.every((r,i)=>Fm[t](n[i].parameters,r.parameters))}var Jt=class{constructor(e=new se([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=or(this.queryParams),this._queryParamMap}toString(){return Tw.serialize(this)}},se=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return go(this)}},En=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=or(this.parameters),this._parameterMap}toString(){return qm(this)}};function ww(n,e){return Tn(n,e)&&n.every((t,r)=>ct(t.parameters,e[r].parameters))}function Tn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function Ew(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===W&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==W&&(t=t.concat(e(i,r)))}),t}var Fi=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>new Ci,providedIn:"root"});let n=e;return n})(),Ci=class{parse(e){let t=new yu(e);return new Jt(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Ei(e.root,!0)}`,r=Sw(e.queryParams),i=typeof e.fragment=="string"?`#${Aw(e.fragment)}`:"";return`${t}${r}${i}`}},Tw=new Ci;function go(n){return n.segments.map(e=>qm(e)).join("/")}function Ei(n,e){if(!n.hasChildren())return go(n);if(e){let t=n.children[W]?Ei(n.children[W],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==W&&r.push(`${i}:${Ei(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=Ew(n,(r,i)=>i===W?[Ei(n.children[W],!1)]:[`${i}:${Ei(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[W]!=null?`${go(n)}/${t[0]}`:`${go(n)}/(${t.join("//")})`}}function Bm(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function fo(n){return Bm(n).replace(/%3B/gi,";")}function Aw(n){return encodeURI(n)}function gu(n){return Bm(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function yo(n){return decodeURIComponent(n)}function Pm(n){return yo(n.replace(/\+/g,"%20"))}function qm(n){return`${gu(n.path)}${bw(n.parameters)}`}function bw(n){return Object.entries(n).map(([e,t])=>`;${gu(e)}=${gu(t)}`).join("")}function Sw(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${fo(t)}=${fo(i)}`).join("&"):`${fo(t)}=${fo(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Rw=/^[^\/()?;#]+/;function lu(n){let e=n.match(Rw);return e?e[0]:""}var Cw=/^[^\/()?;=#]+/;function Pw(n){let e=n.match(Cw);return e?e[0]:""}var Dw=/^[^=?&#]+/;function Nw(n){let e=n.match(Dw);return e?e[0]:""}var kw=/^[^&#]+/;function Ow(n){let e=n.match(kw);return e?e[0]:""}var yu=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new se([],{}):new se([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[W]=new se(e,t)),r}parseSegment(){let e=lu(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ue(4009,!1);return this.capture(e),new En(yo(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Pw(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=lu(this.remaining);i&&(r=i,this.capture(r))}e[yo(t)]=yo(r)}parseQueryParam(e){let t=Nw(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=Ow(this.remaining);a&&(r=a,this.capture(r))}let i=Pm(t),s=Pm(r);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=lu(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ue(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=W);let a=this.parseChildren();t[s]=Object.keys(a).length===1?a[W]:new se([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ue(4011,!1)}};function zm(n){return n.segments.length>0?new se([],{[W]:n}):n}function Gm(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Gm(i);if(r===W&&s.segments.length===0&&s.hasChildren())for(let[a,c]of Object.entries(s.children))e[a]=c;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new se(n.segments,e);return xw(t)}function xw(n){if(n.numberOfChildren===1&&n.children[W]){let e=n.children[W];return new se(n.segments.concat(e.segments),e.children)}return n}function ar(n){return n instanceof Jt}function Mw(n,e,t=null,r=null){let i=Wm(n);return Km(i,e,t,r)}function Wm(n){let e;function t(s){let a={};for(let l of s.children){let h=t(l);a[l.outlet]=h}let c=new se(s.url,a);return s===n&&(e=c),c}let r=t(n.root),i=zm(r);return e??i}function Km(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return hu(i,i,i,t,r);let s=Lw(e);if(s.toRoot())return hu(i,i,new se([],{}),t,r);let a=Vw(s,i,n),c=a.processChildren?bi(a.segmentGroup,a.index,s.commands):Qm(a.segmentGroup,a.index,s.commands);return hu(i,a.segmentGroup,c,t,r)}function vo(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Pi(n){return typeof n=="object"&&n!=null&&n.outlets}function hu(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([l,h])=>{s[l]=Array.isArray(h)?h.map(f=>`${f}`):`${h}`});let a;n===e?a=t:a=Hm(n,e,t);let c=zm(Gm(a));return new Jt(c,s,i)}function Hm(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Hm(s,e,t)}),new se(n.segments,r)}var _o=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&vo(r[0]))throw new ue(4003,!1);let i=r.find(Pi);if(i&&i!==Vm(r))throw new ue(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Lw(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new _o(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([l,h])=>{c[l]=typeof h=="string"?h.split("/"):h}),[...i,{outlets:c}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((c,l)=>{l==0&&c==="."||(l==0&&c===""?t=!0:c===".."?e++:c!=""&&i.push(c))}),i):[...i,s]},[]);return new _o(t,e,r)}var ir=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function Vw(n,e,t){if(n.isAbsolute)return new ir(e,!0,0);if(!t)return new ir(e,!1,NaN);if(t.parent===null)return new ir(t,!0,0);let r=vo(n.commands[0])?0:1,i=t.segments.length-1+r;return Fw(t,i,n.numberOfDoubleDots)}function Fw(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ue(4005,!1);i=r.segments.length}return new ir(r,!1,i-s)}function Uw(n){return Pi(n[0])?n[0].outlets:{[W]:n}}function Qm(n,e,t){if(n??=new se([],{}),n.segments.length===0&&n.hasChildren())return bi(n,e,t);let r=jw(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new se(n.segments.slice(0,r.pathIndex),{});return s.children[W]=new se(n.segments.slice(r.pathIndex),n.children),bi(s,0,i)}else return r.match&&i.length===0?new se(n.segments,{}):r.match&&!n.hasChildren()?vu(n,e,t):r.match?bi(n,0,i):vu(n,e,t)}function bi(n,e,t){if(t.length===0)return new se(n.segments,{});{let r=Uw(t),i={};if(Object.keys(r).some(s=>s!==W)&&n.children[W]&&n.numberOfChildren===1&&n.children[W].segments.length===0){let s=bi(n.children[W],e,t);return new se(n.segments,s.children)}return Object.entries(r).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=Qm(n.children[s],e,a))}),Object.entries(n.children).forEach(([s,a])=>{r[s]===void 0&&(i[s]=a)}),new se(n.segments,i)}}function jw(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let a=n.segments[i],c=t[r];if(Pi(c))break;let l=`${c}`,h=r<t.length-1?t[r+1]:null;if(i>0&&l===void 0)break;if(l&&h&&typeof h=="object"&&h.outlets===void 0){if(!Nm(l,h,a))return s;r+=2}else{if(!Nm(l,{},a))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function vu(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Pi(s)){let l=$w(s.outlets);return new se(r,l)}if(i===0&&vo(t[0])){let l=n.segments[e];r.push(new En(l.path,Dm(t[0]))),i++;continue}let a=Pi(s)?s.outlets[W]:`${s}`,c=i<t.length-1?t[i+1]:null;a&&c&&vo(c)?(r.push(new En(a,Dm(c))),i+=2):(r.push(new En(a,{})),i++)}return new se(r,{})}function $w(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=vu(new se([],{}),0,r))}),e}function Dm(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Nm(n,e,t){return n==t.path&&ct(e,t.parameters)}var Si="imperative",Te=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Te||{}),Ye=class{constructor(e,t){this.id=e,this.url=t}},cr=class extends Ye{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Te.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ut=class extends Ye{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Te.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},We=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(We||{}),Io=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Io||{}),Yt=class extends Ye{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Te.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Xt=class extends Ye{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Te.NavigationSkipped}},Di=class extends Ye{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Te.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},wo=class extends Ye{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Te.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_u=class extends Ye{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Te.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Iu=class extends Ye{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Te.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},wu=class extends Ye{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Te.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Eu=class extends Ye{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Te.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tu=class{constructor(e){this.route=e,this.type=Te.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Au=class{constructor(e){this.route=e,this.type=Te.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},bu=class{constructor(e){this.snapshot=e,this.type=Te.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Su=class{constructor(e){this.snapshot=e,this.type=Te.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ru=class{constructor(e){this.snapshot=e,this.type=Te.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Cu=class{constructor(e){this.snapshot=e,this.type=Te.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Eo=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=Te.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Ni=class{},ki=class{constructor(e){this.url=e}};var Pu=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ui,this.attachRef=null}},Ui=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Pu,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),To=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Du(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Du(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Nu(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Nu(e,this._root).map(t=>t.value)}};function Du(n,e){if(n===e.value)return e;for(let t of e.children){let r=Du(n,t);if(r)return r}return null}function Nu(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Nu(n,t);if(r.length)return r.unshift(e),r}return[]}var Ge=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function rr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ao=class extends To{constructor(e,t){super(e),this.snapshot=t,$u(this,e)}toString(){return this.snapshot.toString()}};function Jm(n){let e=Bw(n),t=new Je([new En("",{})]),r=new Je({}),i=new Je({}),s=new Je({}),a=new Je(""),c=new Zt(t,r,s,a,i,W,n,e.root);return c.snapshot=e.root,new Ao(new Ge(c,[]),e)}function Bw(n){let e={},t={},r={},i="",s=new Oi([],e,r,i,t,W,n,null,{});return new bo("",new Ge(s,[]))}var Zt=class{constructor(e,t,r,i,s,a,c,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=c,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(ee(h=>h[Vi]))??j(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ee(e=>or(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ee(e=>or(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function ju(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:V(V({},e.params),n.params),data:V(V({},e.data),n.data),resolve:V(V(V(V({},n.data),e.data),i?.data),n._resolvedData)}:r={params:V({},n.params),data:V({},n.data),resolve:V(V({},n.data),n._resolvedData??{})},i&&Xm(i)&&(r.resolve[Vi]=i.title),r}var Oi=class{get title(){return this.data?.[Vi]}constructor(e,t,r,i,s,a,c,l,h){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=a,this.component=c,this.routeConfig=l,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=or(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=or(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},bo=class extends To{constructor(e,t){super(t),this.url=e,$u(this,t)}toString(){return Ym(this._root)}};function $u(n,e){e.value._routerState=n,e.children.forEach(t=>$u(n,t))}function Ym(n){let e=n.children.length>0?` { ${n.children.map(Ym).join(", ")} } `:"";return`${n.value}${e}`}function du(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ct(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),ct(e.params,t.params)||n.paramsSubject.next(t.params),yw(e.url,t.url)||n.urlSubject.next(t.url),ct(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function ku(n,e){let t=ct(n.params,e.params)&&ww(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||ku(n.parent,e.parent))}function Xm(n){return typeof n.title=="string"||n.title===null}var qw=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=W,this.activateEvents=new hi,this.deactivateEvents=new hi,this.attachEvents=new hi,this.detachEvents=new hi,this.parentContexts=F(Ui),this.location=F(Wp),this.changeDetector=F(Qc),this.environmentInjector=F(Ht),this.inputBinder=F(Po,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ue(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ue(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ue(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new ue(4013,!1);this._activatedRoute=r;let s=this.location,c=r.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,h=new Ou(r,l,s.injector);this.activated=s.createComponent(c,{index:s.length,injector:h,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=jc({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[$c]});let n=e;return n})(),Ou=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Zt?this.route:e===Ui?this.childContexts:this.parent.get(e,t)}},Po=new ie(""),km=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Ks([i.queryParams,i.params,i.data]).pipe(ze(([a,c,l],h)=>(l=V(V(V({},a),c),l),h===0?j(l):Promise.resolve(l)))).subscribe(a=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let c=nm(i.component);if(!c){this.unsubscribeFromRouteData(r);return}for(let{templateName:l}of c.inputs)r.activatedComponentRef.setInput(l,a[l])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();function zw(n,e,t){let r=xi(n,e._root,t?t._root:void 0);return new Ao(r,e)}function xi(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=Gw(n,e,t);return new Ge(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(c=>xi(n,c)),a}}let r=Ww(e.value),i=e.children.map(s=>xi(n,s));return new Ge(r,i)}}function Gw(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return xi(n,r,i);return xi(n,r)})}function Ww(n){return new Zt(new Je(n.url),new Je(n.params),new Je(n.queryParams),new Je(n.fragment),new Je(n.data),n.outlet,n.component,n)}var Zm="ngNavigationCancelingError";function eg(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=ar(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=tg(!1,We.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function tg(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Zm]=!0,t.cancellationCode=e,t}function Kw(n){return ng(n)&&ar(n.url)}function ng(n){return!!n&&n[Zm]}var Hw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Pp({type:e,selectors:[["ng-component"]],standalone:!0,features:[Xp],decls:1,vars:0,template:function(i,s){i&1&&Jp(0,"router-outlet")},dependencies:[qw],encapsulation:2});let n=e;return n})();function Qw(n,e){return n.providers&&!n._injector&&(n._injector=Kc(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Bu(n){let e=n.children&&n.children.map(Bu),t=e?Re(V({},n),{children:e}):V({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==W&&(t.component=Hw),t}function lt(n){return n.outlet||W}function Jw(n,e){let t=n.filter(r=>lt(r)===e);return t.push(...n.filter(r=>lt(r)!==e)),t}function ji(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Yw=(n,e,t,r)=>ee(i=>(new xu(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),xu=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),du(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=rr(t);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],r),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=rr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){let a=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=rr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=rr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Cu(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Su(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(du(i),i===s)if(i.component){let a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(c.contexts),a.attachRef=c.componentRef,a.route=c.route.value,a.outlet&&a.outlet.attach(c.componentRef,c.route.value),du(c.route.value),this.activateChildRoutes(e,null,a.children)}else{let c=ji(i.snapshot);a.attachRef=null,a.route=i,a.injector=c,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,r)}},So=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},sr=class{constructor(e,t){this.component=e,this.route=t}};function Xw(n,e,t){let r=n._root,i=e?e._root:null;return Ti(r,i,t,[r.value])}function Zw(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function lr(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!Rp(n)?n:e.get(n):r}function Ti(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=rr(e);return n.children.forEach(a=>{eE(a,s[a.value.outlet],t,r.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,c])=>Ri(c,t.getContext(a),i)),i}function eE(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,a=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let l=tE(a,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new So(r)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?Ti(n,e,c?c.children:null,r,i):Ti(n,e,t,r,i),l&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new sr(c.outlet.component,a))}else a&&Ri(e,c,i),i.canActivateChecks.push(new So(r)),s.component?Ti(n,null,c?c.children:null,r,i):Ti(n,null,t,r,i);return i}function tE(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Tn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Tn(n.url,e.url)||!ct(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ku(n,e)||!ct(n.queryParams,e.queryParams);case"paramsChange":default:return!ku(n,e)}}function Ri(n,e,t){let r=rr(n),i=n.value;Object.entries(r).forEach(([s,a])=>{i.component?e?Ri(a,e.children.getContext(s),t):Ri(a,null,t):Ri(a,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new sr(e.outlet.component,i)):t.canDeactivateChecks.push(new sr(null,i)):t.canDeactivateChecks.push(new sr(null,i))}function $i(n){return typeof n=="function"}function nE(n){return typeof n=="boolean"}function rE(n){return n&&$i(n.canLoad)}function iE(n){return n&&$i(n.canActivate)}function sE(n){return n&&$i(n.canActivateChild)}function oE(n){return n&&$i(n.canDeactivate)}function aE(n){return n&&$i(n.canMatch)}function rg(n){return n instanceof Ep||n?.name==="EmptyError"}var po=Symbol("INITIAL_VALUE");function ur(){return ze(n=>Ks(n.map(e=>e.pipe(Yn(1),Fc(po)))).pipe(ee(e=>{for(let t of e)if(t!==!0){if(t===po)return po;if(t===!1||t instanceof Jt)return t}return!0}),ot(e=>e!==po),Yn(1)))}function cE(n,e){return qe(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return a.length===0&&s.length===0?j(Re(V({},t),{guardsResult:!0})):uE(a,r,i,n).pipe(qe(c=>c&&nE(c)?lE(r,s,n,e):j(c)),ee(c=>Re(V({},t),{guardsResult:c})))})}function uE(n,e,t,r){return Ce(n).pipe(qe(i=>mE(i.component,i.route,t,e,r)),Kt(i=>i!==!0,!0))}function lE(n,e,t,r){return Ce(e).pipe(Wt(i=>Tp(dE(i.route.parent,r),hE(i.route,r),pE(n,i.path,t),fE(n,i.route,t))),Kt(i=>i!==!0,!0))}function hE(n,e){return n!==null&&e&&e(new Ru(n)),j(!0)}function dE(n,e){return n!==null&&e&&e(new bu(n)),j(!0)}function fE(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return j(!0);let i=r.map(s=>xc(()=>{let a=ji(e)??t,c=lr(s,a),l=iE(c)?c.canActivate(e,n):at(a,()=>c(e,n));return en(l).pipe(Kt())}));return j(i).pipe(ur())}function pE(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>Zw(a)).filter(a=>a!==null).map(a=>xc(()=>{let c=a.guards.map(l=>{let h=ji(a.node)??t,f=lr(l,h),g=sE(f)?f.canActivateChild(r,n):at(h,()=>f(r,n));return en(g).pipe(Kt())});return j(c).pipe(ur())}));return j(s).pipe(ur())}function mE(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return j(!0);let a=s.map(c=>{let l=ji(e)??i,h=lr(c,l),f=oE(h)?h.canDeactivate(n,e,t,r):at(l,()=>h(n,e,t,r));return en(f).pipe(Kt())});return j(a).pipe(ur())}function gE(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return j(!0);let s=i.map(a=>{let c=lr(a,n),l=rE(c)?c.canLoad(e,t):at(n,()=>c(e,t));return en(l)});return j(s).pipe(ur(),ig(r))}function ig(n){return Rc(Ie(e=>{if(ar(e))throw eg(n,e)}),ee(e=>e===!0))}function yE(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return j(!0);let s=i.map(a=>{let c=lr(a,n),l=aE(c)?c.canMatch(e,t):at(n,()=>c(e,t));return en(l)});return j(s).pipe(ur(),ig(r))}var Mi=class{constructor(e){this.segmentGroup=e||null}},Ro=class extends Error{constructor(e){super(),this.urlTree=e}};function nr(n){return ai(new Mi(n))}function vE(n){return ai(new ue(4e3,!1))}function _E(n){return ai(tg(!1,We.GuardRejected))}var Mu=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return j(r);if(i.numberOfChildren>1||!i.children[W])return vE(e.redirectTo);i=i.children[W]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new Ro(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Jt(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let c=s.substring(1);r[i]=t[c]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),a={};return Object.entries(t.children).forEach(([c,l])=>{a[c]=this.createSegmentGroup(e,l,r,i)}),new se(s,a)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ue(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Lu={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function IE(n,e,t,r,i){let s=qu(n,e,t);return s.matched?(r=Qw(e,r),yE(r,e,t,i).pipe(ee(a=>a===!0?s:V({},Lu)))):j(s)}function qu(n,e,t){if(e.path==="**")return wE(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?V({},Lu):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||gw)(t,n,e);if(!i)return V({},Lu);let s={};Object.entries(i.posParams??{}).forEach(([c,l])=>{s[c]=l.path});let a=i.consumed.length>0?V(V({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function wE(n){return{matched:!0,parameters:n.length>0?Vm(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Om(n,e,t,r){return t.length>0&&AE(n,t,r)?{segmentGroup:new se(e,TE(r,new se(t,n.children))),slicedSegments:[]}:t.length===0&&bE(n,t,r)?{segmentGroup:new se(n.segments,EE(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new se(n.segments,n.children),slicedSegments:t}}function EE(n,e,t,r){let i={};for(let s of t)if(Do(n,e,s)&&!r[lt(s)]){let a=new se([],{});i[lt(s)]=a}return V(V({},r),i)}function TE(n,e){let t={};t[W]=e;for(let r of n)if(r.path===""&&lt(r)!==W){let i=new se([],{});t[lt(r)]=i}return t}function AE(n,e,t){return t.some(r=>Do(n,e,r)&&lt(r)!==W)}function bE(n,e,t){return t.some(r=>Do(n,e,r))}function Do(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function SE(n,e,t,r){return lt(n)!==r&&(r===W||!Do(e,t,n))?!1:qu(e,n,t).matched}function RE(n,e,t){return e.length===0&&!n.children[t]}var Vu=class{};function CE(n,e,t,r,i,s,a="emptyOnly"){return new Fu(n,e,t,r,i,a,s).recognize()}var PE=31,Fu=class{constructor(e,t,r,i,s,a,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=c,this.applyRedirects=new Mu(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ue(4002,`'${e.segmentGroup}'`)}recognize(){let e=Om(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ee(t=>{let r=new Oi([],Object.freeze({}),Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,{},W,this.rootComponentType,null,{}),i=new Ge(r,t),s=new bo("",i),a=Mw(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(s._root,null),{state:s,tree:a}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,W).pipe(Jn(r=>{if(r instanceof Ro)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Mi?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=ju(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(ee(s=>s instanceof Ge?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return Ce(i).pipe(Wt(s=>{let a=r.children[s],c=Jw(t,s);return this.processSegmentGroup(e,c,a,s)}),Vc((s,a)=>(s.push(...a),s)),Mc(null),bp(),qe(s=>{if(s===null)return nr(r);let a=sg(s);return DE(a),j(a)}))}processSegment(e,t,r,i,s,a){return Ce(t).pipe(Wt(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,a).pipe(Jn(l=>{if(l instanceof Mi)return j(null);throw l}))),Kt(c=>!!c),Jn(c=>{if(rg(c))return RE(r,i,s)?j(new Vu):nr(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,a,c){return SE(r,i,s,a)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,a):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,a):nr(i):nr(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,a){let{matched:c,consumedSegments:l,positionalParamSegments:h,remainingSegments:f}=qu(t,i,s);if(!c)return nr(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>PE&&(this.allowRedirects=!1));let g=this.applyRedirects.applyRedirectCommands(l,i.redirectTo,h);return this.applyRedirects.lineralizeSegments(i,g).pipe(qe(I=>this.processSegment(e,r,t,I.concat(f),a,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let a=IE(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(ze(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ze(({routes:l})=>{let h=r._loadedInjector??e,{consumedSegments:f,remainingSegments:g,parameters:I}=c,R=new Oi(f,I,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,kE(r),lt(r),r.component??r._loadedComponent??null,r,OE(r)),{segmentGroup:N,slicedSegments:O}=Om(t,f,g,l);if(O.length===0&&N.hasChildren())return this.processChildren(h,l,N).pipe(ee(x=>x===null?null:new Ge(R,x)));if(l.length===0&&O.length===0)return j(new Ge(R,[]));let C=lt(r)===s;return this.processSegment(h,l,N,O,C?W:s,!0).pipe(ee(x=>new Ge(R,x instanceof Ge?[x]:[])))}))):nr(t)))}getChildConfig(e,t,r){return t.children?j({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?j({routes:t._loadedRoutes,injector:t._loadedInjector}):gE(e,t,r,this.urlSerializer).pipe(qe(i=>i?this.configLoader.loadChildren(e,t).pipe(Ie(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):_E(t))):j({routes:[],injector:e})}};function DE(n){n.sort((e,t)=>e.value.outlet===W?-1:t.value.outlet===W?1:e.value.outlet.localeCompare(t.value.outlet))}function NE(n){let e=n.value.routeConfig;return e&&e.path===""}function sg(n){let e=[],t=new Set;for(let r of n){if(!NE(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=sg(r.children);e.push(new Ge(r.value,i))}return e.filter(r=>!t.has(r))}function kE(n){return n.data||{}}function OE(n){return n.resolve||{}}function xE(n,e,t,r,i,s){return qe(a=>CE(n,e,t,r,a.extractedUrl,i,s).pipe(ee(({state:c,tree:l})=>Re(V({},a),{targetSnapshot:c,urlAfterRedirects:l}))))}function ME(n,e){return qe(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return j(t);let s=new Set(i.map(l=>l.route)),a=new Set;for(let l of s)if(!a.has(l))for(let h of og(l))a.add(h);let c=0;return Ce(a).pipe(Wt(l=>s.has(l)?LE(l,r,n,e):(l.data=ju(l,l.parent,n).resolve,j(void 0))),Ie(()=>c++),Lc(1),qe(l=>c===a.size?j(t):Gt))})}function og(n){let e=n.children.map(t=>og(t)).flat();return[n,...e]}function LE(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Xm(i)&&(s[Vi]=i.title),VE(s,n,e,r).pipe(ee(a=>(n._resolvedData=a,n.data=ju(n,n.parent,t).resolve,null)))}function VE(n,e,t,r){let i=mu(n);if(i.length===0)return j({});let s={};return Ce(i).pipe(qe(a=>FE(n[a],e,t,r).pipe(Kt(),Ie(c=>{s[a]=c}))),Lc(1),Ap(s),Jn(a=>rg(a)?Gt:ai(a)))}function FE(n,e,t,r){let i=ji(e)??r,s=lr(n,i),a=s.resolve?s.resolve(e,t):at(i,()=>s(e,t));return en(a)}function fu(n){return ze(e=>{let t=n(e);return t?Ce(t).pipe(ee(()=>e)):j(e)})}var ag=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(a=>a.outlet===W);return i}getResolvedTitleForRoute(r){return r.data[Vi]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>F(UE),providedIn:"root"});let n=e;return n})(),UE=(()=>{let e=class e extends ag{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(H(Rm))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Bi=new ie("",{providedIn:"root",factory:()=>({})}),Li=new ie(""),zu=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=F(Zs)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return j(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=en(r.loadComponent()).pipe(ee(cg),Ie(a=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=a}),_n(()=>{this.componentLoaders.delete(r)})),s=new Pc(i,()=>new zt).pipe(Cc());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return j({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let a=jE(i,this.compiler,r,this.onLoadEndListener).pipe(_n(()=>{this.childrenLoaders.delete(i)})),c=new Pc(a,()=>new zt).pipe(Cc());return this.childrenLoaders.set(i,c),c}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function jE(n,e,t,r){return en(n.loadChildren()).pipe(ee(cg),qe(i=>i instanceof Hp||Array.isArray(i)?j(i):Ce(e.compileModuleAsync(i))),ee(i=>{r&&r(n);let s,a,c=!1;return Array.isArray(i)?(a=i,c=!0):(s=i.create(t).injector,a=s.get(Li,[],{optional:!0,self:!0}).flat()),{routes:a.map(Bu),injector:s}}))}function $E(n){return n&&typeof n=="object"&&"default"in n}function cg(n){return $E(n)?n.default:n}var Gu=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>F(BE),providedIn:"root"});let n=e;return n})(),BE=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),ug=new ie(""),lg=new ie("");function qE(n,e,t){let r=n.get(lg),i=n.get($e);return n.get(pe).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(h=>setTimeout(h));let s,a=new Promise(h=>{s=h}),c=i.startViewTransition(()=>(s(),zE(n))),{onViewTransitionCreated:l}=r;return l&&at(n,()=>l({transition:c,from:e,to:t})),a})}function zE(n){return new Promise(e=>{Wc(e,{injector:n})})}var Wu=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new zt,this.transitionAbortSubject=new zt,this.configLoader=F(zu),this.environmentInjector=F(Ht),this.urlSerializer=F(Fi),this.rootContexts=F(Ui),this.location=F(mi),this.inputBindingEnabled=F(Po,{optional:!0})!==null,this.titleStrategy=F(ag),this.options=F(Bi,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=F(Gu),this.createViewTransition=F(ug,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>j(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Tu(s)),i=s=>this.events.next(new Au(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Re(V(V({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Je({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Si,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ot(a=>a.id!==0),ee(a=>Re(V({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),ze(a=>{let c=!1,l=!1;return j(a).pipe(ze(h=>{if(this.navigationId>a.id)return this.cancelNavigationTransition(a,"",We.SupersededByNewNavigation),Gt;this.currentTransition=a,this.currentNavigation={id:h.id,initialUrl:h.rawUrl,extractedUrl:h.extractedUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?Re(V({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let f=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),g=h.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!f&&g!=="reload"){let I="";return this.events.next(new Xt(h.id,this.urlSerializer.serialize(h.rawUrl),I,Io.IgnoredSameUrlNavigation)),h.resolve(null),Gt}if(this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return j(h).pipe(ze(I=>{let R=this.transitions?.getValue();return this.events.next(new cr(I.id,this.urlSerializer.serialize(I.extractedUrl),I.source,I.restoredState)),R!==this.transitions?.getValue()?Gt:Promise.resolve(I)}),xE(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Ie(I=>{a.targetSnapshot=I.targetSnapshot,a.urlAfterRedirects=I.urlAfterRedirects,this.currentNavigation=Re(V({},this.currentNavigation),{finalUrl:I.urlAfterRedirects});let R=new wo(I.id,this.urlSerializer.serialize(I.extractedUrl),this.urlSerializer.serialize(I.urlAfterRedirects),I.targetSnapshot);this.events.next(R)}));if(f&&this.urlHandlingStrategy.shouldProcessUrl(h.currentRawUrl)){let{id:I,extractedUrl:R,source:N,restoredState:O,extras:C}=h,x=new cr(I,this.urlSerializer.serialize(R),N,O);this.events.next(x);let q=Jm(this.rootComponentType).snapshot;return this.currentTransition=a=Re(V({},h),{targetSnapshot:q,urlAfterRedirects:R,extras:Re(V({},C),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=R,j(a)}else{let I="";return this.events.next(new Xt(h.id,this.urlSerializer.serialize(h.extractedUrl),I,Io.IgnoredByUrlHandlingStrategy)),h.resolve(null),Gt}}),Ie(h=>{let f=new _u(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}),ee(h=>(this.currentTransition=a=Re(V({},h),{guards:Xw(h.targetSnapshot,h.currentSnapshot,this.rootContexts)}),a)),cE(this.environmentInjector,h=>this.events.next(h)),Ie(h=>{if(a.guardsResult=h.guardsResult,ar(h.guardsResult))throw eg(this.urlSerializer,h.guardsResult);let f=new Iu(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.events.next(f)}),ot(h=>h.guardsResult?!0:(this.cancelNavigationTransition(h,"",We.GuardRejected),!1)),fu(h=>{if(h.guards.canActivateChecks.length)return j(h).pipe(Ie(f=>{let g=new wu(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(g)}),ze(f=>{let g=!1;return j(f).pipe(ME(this.paramsInheritanceStrategy,this.environmentInjector),Ie({next:()=>g=!0,complete:()=>{g||this.cancelNavigationTransition(f,"",We.NoDataFromResolver)}}))}),Ie(f=>{let g=new Eu(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(g)}))}),fu(h=>{let f=g=>{let I=[];g.routeConfig?.loadComponent&&!g.routeConfig._loadedComponent&&I.push(this.configLoader.loadComponent(g.routeConfig).pipe(Ie(R=>{g.component=R}),ee(()=>{})));for(let R of g.children)I.push(...f(R));return I};return Ks(f(h.targetSnapshot.root)).pipe(Mc(null),Yn(1))}),fu(()=>this.afterPreactivation()),ze(()=>{let{currentSnapshot:h,targetSnapshot:f}=a,g=this.createViewTransition?.(this.environmentInjector,h.root,f.root);return g?Ce(g).pipe(ee(()=>a)):j(a)}),ee(h=>{let f=zw(r.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return this.currentTransition=a=Re(V({},h),{targetRouterState:f}),this.currentNavigation.targetRouterState=f,a}),Ie(()=>{this.events.next(new Ni)}),Yw(this.rootContexts,r.routeReuseStrategy,h=>this.events.next(h),this.inputBindingEnabled),Yn(1),Ie({next:h=>{c=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ut(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects))),this.titleStrategy?.updateTitle(h.targetRouterState.snapshot),h.resolve(!0)},complete:()=>{c=!0}}),Sp(this.transitionAbortSubject.pipe(Ie(h=>{throw h}))),_n(()=>{!c&&!l&&this.cancelNavigationTransition(a,"",We.SupersededByNewNavigation),this.currentTransition?.id===a.id&&(this.currentNavigation=null,this.currentTransition=null)}),Jn(h=>{if(l=!0,ng(h))this.events.next(new Yt(a.id,this.urlSerializer.serialize(a.extractedUrl),h.message,h.cancellationCode)),Kw(h)?this.events.next(new ki(h.url)):a.resolve(!1);else{this.events.next(new Di(a.id,this.urlSerializer.serialize(a.extractedUrl),h,a.targetSnapshot??void 0));try{a.resolve(r.errorHandler(h))}catch(f){this.options.resolveNavigationPromiseOnError?a.resolve(!1):a.reject(f)}}return Gt}))}))}cancelNavigationTransition(r,i,s){let a=new Yt(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(a),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function GE(n){return n!==Si}var WE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>F(KE),providedIn:"root"});let n=e;return n})(),Uu=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},KE=(()=>{let e=class e extends Uu{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Bc(e)))(s||e)}})(),e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),hg=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>F(HE),providedIn:"root"});let n=e;return n})(),HE=(()=>{let e=class e extends hg{constructor(){super(...arguments),this.location=F(mi),this.urlSerializer=F(Fi),this.options=F(Bi,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=F(Gu),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Jt,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Jm(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof cr)this.stateMemento=this.createStateMemento();else if(r instanceof Xt)this.rawUrlTree=i.initialUrl;else if(r instanceof wo){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Ni?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Yt&&(r.code===We.GuardRejected||r.code===We.NoDataFromResolver)?this.restoreHistory(i):r instanceof Di?this.restoreHistory(i,!0):r instanceof ut&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let a=this.browserPageId,c=V(V({},i.extras.state),this.generateNgRouterState(i.id,a));this.location.replaceState(s,"",c)}else{let a=V(V({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",a)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,a=this.currentPageId-s;a!==0?this.location.historyGo(a):this.currentUrlTree===r.finalUrl&&a===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Bc(e)))(s||e)}})(),e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ai=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Ai||{});function dg(n,e){n.events.pipe(ot(t=>t instanceof ut||t instanceof Yt||t instanceof Di||t instanceof Xt),ee(t=>t instanceof ut||t instanceof Xt?Ai.COMPLETE:(t instanceof Yt?t.code===We.Redirect||t.code===We.SupersededByNewNavigation:!1)?Ai.REDIRECTING:Ai.FAILED),ot(t=>t!==Ai.REDIRECTING),Yn(1)).subscribe(()=>{e()})}function QE(n){throw n}var JE={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},YE={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Rt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=F(Js),this.stateManager=F(hg),this.options=F(Bi,{optional:!0})||{},this.pendingTasks=F(fi),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=F(Wu),this.urlSerializer=F(Fi),this.location=F(mi),this.urlHandlingStrategy=F(Gu),this._events=new zt,this.errorHandler=this.options.errorHandler||QE,this.navigated=!1,this.routeReuseStrategy=F(WE),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=F(Li,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!F(Po,{optional:!0}),this.eventsSubscription=new vp,this.isNgZoneEnabled=F(pe)instanceof pe&&pe.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,a=this.navigationTransitions.currentNavigation;if(s!==null&&a!==null){if(this.stateManager.handleRouterEvent(i,a),i instanceof Yt&&i.code!==We.Redirect&&i.code!==We.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ut)this.navigated=!0;else if(i instanceof ki){let c=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),l={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||GE(s.source)};this.scheduleNavigation(c,Si,null,l,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}ZE(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Si,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let a={replaceUrl:!0},c=s?.navigationId?s:null;if(s){let h=V({},s);delete h.navigationId,delete h.\u0275routerPageId,Object.keys(h).length!==0&&(a.state=h)}let l=this.parseUrl(r);this.scheduleNavigation(l,i,c,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Bu),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:a,fragment:c,queryParamsHandling:l,preserveFragment:h}=i,f=h?this.currentUrlTree.fragment:c,g=null;switch(l){case"merge":g=V(V({},this.currentUrlTree.queryParams),a);break;case"preserve":g=this.currentUrlTree.queryParams;break;default:g=a||null}g!==null&&(g=this.removeEmptyProps(g));let I;try{let R=s?s.snapshot:this.routerState.snapshot.root;I=Wm(R)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),I=this.currentUrlTree.root}return Km(I,r,g,f??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=ar(r)?r:this.parseUrl(r),a=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(a,Si,null,i)}navigate(r,i={skipLocationChange:!1}){return XE(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=V({},JE):i===!1?s=V({},YE):s=i,ar(r))return Cm(this.currentUrlTree,r,s);let a=this.parseUrl(r);return Cm(this.currentUrlTree,a,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,a])=>(a!=null&&(i[s]=a),i),{})}scheduleNavigation(r,i,s,a,c){if(this.disposed)return Promise.resolve(!1);let l,h,f;c?(l=c.resolve,h=c.reject,f=c.promise):f=new Promise((I,R)=>{l=I,h=R});let g=this.pendingTasks.add();return dg(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(g))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:a,resolve:l,reject:h,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(I=>Promise.reject(I))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function XE(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ue(4008,!1)}function ZE(n){return!(n instanceof Ni)&&!(n instanceof ki)}var hP=(()=>{let e=class e{constructor(r,i,s,a,c,l){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=a,this.el=c,this.locationStrategy=l,this.href=null,this.commands=null,this.onChanges=new zt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let h=c.nativeElement.tagName?.toLowerCase();this.isAnchorElement=h==="a"||h==="area",this.isAnchorElement?this.subscription=r.events.subscribe(f=>{f instanceof ut&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,a,c){let l=this.urlTree;if(l===null||this.isAnchorElement&&(r!==0||i||s||a||c||typeof this.target=="string"&&this.target!="_self"))return!0;let h={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(l,h),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:Bp(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,a=this.el.nativeElement;i!==null?s.setAttribute(a,r,i):s.removeAttribute(a,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(er(Rt),er(Zt),Np("tabindex"),er(Gp),er(kp),er(pi))},e.\u0275dir=jc({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Yp("click",function(c){return s.onClick(c.button,c.ctrlKey,c.shiftKey,c.altKey,c.metaKey)}),i&2&&Qp("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Hs.HasDecoratorInputTransform,"preserveFragment","preserveFragment",eo],skipLocationChange:[Hs.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",eo],replaceUrl:[Hs.HasDecoratorInputTransform,"replaceUrl","replaceUrl",eo],routerLink:"routerLink"},standalone:!0,features:[Kp,$c]});let n=e;return n})();var Co=class{};var eT=(()=>{let e=class e{constructor(r,i,s,a,c){this.router=r,this.injector=s,this.preloadingStrategy=a,this.loader=c}setUpPreloading(){this.subscription=this.router.events.pipe(ot(r=>r instanceof ut),Wt(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let a of i){a.providers&&!a._injector&&(a._injector=Kc(a.providers,r,`Route: ${a.path}`));let c=a._injector??r,l=a._loadedInjector??c;(a.loadChildren&&!a._loadedRoutes&&a.canLoad===void 0||a.loadComponent&&!a._loadedComponent)&&s.push(this.preloadConfig(c,a)),(a.children||a._loadedRoutes)&&s.push(this.processRoutes(l,a.children??a._loadedRoutes))}return Ce(s).pipe(Oc())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=j(null);let a=s.pipe(qe(c=>c===null?j(void 0):(i._loadedRoutes=c.routes,i._loadedInjector=c.injector,this.processRoutes(c.injector??r,c.routes))));if(i.loadComponent&&!i._loadedComponent){let c=this.loader.loadComponent(i);return Ce([a,c]).pipe(Oc())}else return a})}};e.\u0275fac=function(i){return new(i||e)(H(Rt),H(Zs),H(Ht),H(Co),H(zu))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),fg=new ie(""),tT=(()=>{let e=class e{constructor(r,i,s,a,c={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=a,this.options=c,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=F(Ht),c.scrollPositionRestoration||="disabled",c.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof cr?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof ut?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Xt&&r.code===Io.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Eo&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>_(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),Wc(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Eo(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){qp()},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();function dP(n,...e){return tt([{provide:Li,multi:!0,useValue:n},[],{provide:Zt,useFactory:pg,deps:[Rt]},{provide:Ys,multi:!0,useFactory:mg},e.map(t=>t.\u0275providers)])}function pg(n){return n.routerState.root}function qi(n,e){return{\u0275kind:n,\u0275providers:e}}function mg(){let n=F(bt);return e=>{let t=n.get(Xs);if(e!==t.components[0])return;let r=n.get(Rt),i=n.get(gg);n.get(Ku)===1&&r.initialNavigation(),n.get(yg,null,Uc.Optional)?.setUpPreloading(),n.get(fg,null,Uc.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var gg=new ie("",{factory:()=>new zt}),Ku=new ie("",{providedIn:"root",factory:()=>1});function nT(){return qi(2,[{provide:Ku,useValue:0},{provide:Hc,multi:!0,deps:[bt],useFactory:e=>{let t=e.get(sm,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(Rt),s=e.get(gg);dg(i,()=>{r(!0)}),e.get(Wu).afterPreactivation=()=>(r(!0),s.closed?j(void 0):s),i.initialNavigation()}))}}])}function rT(){return qi(3,[{provide:Hc,multi:!0,useFactory:()=>{let e=F(Rt);return()=>{e.setUpLocationChangeListener()}}},{provide:Ku,useValue:2}])}var yg=new ie("");function iT(n){return qi(0,[{provide:yg,useExisting:eT},{provide:Co,useExisting:n}])}function sT(){return qi(8,[km,{provide:Po,useExisting:km}])}function oT(n){let e=[{provide:ug,useValue:qE},{provide:lg,useValue:V({skipNextTransition:!!n?.skipInitialTransition},n)}];return qi(9,e)}var xm=new ie("ROUTER_FORROOT_GUARD"),aT=[mi,{provide:Fi,useClass:Ci},Rt,Ui,{provide:Zt,useFactory:pg,deps:[Rt]},zu,[]],fP=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[aT,[],{provide:Li,multi:!0,useValue:r},{provide:xm,useFactory:hT,deps:[[Rt,new Ue,new Cp]]},{provide:Bi,useValue:i||{}},i?.useHash?uT():lT(),cT(),i?.preloadingStrategy?iT(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?dT(i):[],i?.bindToComponentInputs?sT().\u0275providers:[],i?.enableViewTransitions?oT().\u0275providers:[],fT()]}}static forChild(r){return{ngModule:e,providers:[{provide:Li,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(H(xm,8))},e.\u0275mod=li({type:e}),e.\u0275inj=ci({});let n=e;return n})();function cT(){return{provide:fg,useFactory:()=>{let n=F(um),e=F(pe),t=F(Bi),r=F(Wu),i=F(Fi);return t.scrollOffset&&n.setOffset(t.scrollOffset),new tT(i,r,n,e,t)}}}function uT(){return{provide:pi,useClass:am}}function lT(){return{provide:pi,useClass:om}}function hT(n){return"guarded"}function dT(n){return[n.initialNavigation==="disabled"?rT().\u0275providers:[],n.initialNavigation==="enabledBlocking"?nT().\u0275providers:[]]}var Mm=new ie("");function fT(){return[{provide:Mm,useFactory:mg},{provide:Ys,multi:!0,useExisting:Mm}]}var _g=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},pT=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],c=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Ig={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,c=a?n[i+1]:0,l=i+2<n.length,h=l?n[i+2]:0,f=s>>2,g=(s&3)<<4|c>>4,I=(c&15)<<2|h>>6,R=h&63;l||(R=64,a||(I=64)),r.push(t[f],t[g],t[I],t[R])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(_g(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):pT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||g==null)throw new Qu;let I=s<<2|c>>4;if(r.push(I),h!==64){let R=c<<4&240|h>>2;if(r.push(R),g!==64){let N=h<<6&192|g;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Qu=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},mT=function(n){let e=_g(n);return Ig.encodeByteArray(e,!0)},zi=function(n){return mT(n).replace(/\./g,"")},Yu=function(n){try{return Ig.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function gT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var yT=()=>gT().__FIREBASE_DEFAULTS__,vT=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},_T=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Yu(n[1]);return e&&JSON.parse(e)},ko=()=>{try{return yT()||vT()||_T()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Xu=n=>{var e,t;return(t=(e=ko())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},wg=n=>{let e=Xu(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Zu=()=>{var n;return(n=ko())===null||n===void 0?void 0:n.config},el=n=>{var e;return(e=ko())===null||e===void 0?void 0:e[`_${n}`]};var No=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Eg(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[zi(JSON.stringify(t)),zi(JSON.stringify(a)),""].join(".")}function we(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Tg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(we())}function IT(){var n;let e=(n=ko())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Ag(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function bg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Sg(){let n=we();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Rg(){return!IT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tl(){try{return typeof indexedDB=="object"}catch{return!1}}function Cg(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var wT="FirebaseError",Ke=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=wT,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ct.prototype.create)}},Ct=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?ET(s,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new Ke(i,c,r)}};function ET(n,e){return n.replace(TT,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var TT=/\{\$([^}]+)}/g;function Pg(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function An(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(vg(s)&&vg(a)){if(!An(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function vg(n){return n!==null&&typeof n=="object"}function Gi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function hr(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function dr(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Dg(n,e){let t=new Ju(n,e);return t.subscribe.bind(t)}var Ju=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");AT(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Hu),i.error===void 0&&(i.error=Hu),i.complete===void 0&&(i.complete=Hu);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function AT(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Hu(){}var gP=4*60*60*1e3;function me(n){return n&&n._delegate?n._delegate:n}var Xe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var bn="[DEFAULT]";var nl=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new No;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ST(e))try{this.getOrInitializeService({instanceIdentifier:bn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=bn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return _(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=bn){return this.instances.has(e)}getOptions(e=bn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:bT(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=bn){return this.component?this.component.multipleInstances?e:bn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function bT(n){return n===bn?void 0:n}function ST(n){return n.instantiationMode==="EAGER"}var Oo=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new nl(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var RT=[],J=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(J||{}),CT={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},PT=J.INFO,DT={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},NT=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=DT[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},tn=class{constructor(e){this.name=e,this._logLevel=PT,this._logHandler=NT,this._userLogHandler=null,RT.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in J))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?CT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...e),this._logHandler(this,J.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...e),this._logHandler(this,J.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,J.INFO,...e),this._logHandler(this,J.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,J.WARN,...e),this._logHandler(this,J.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...e),this._logHandler(this,J.ERROR,...e)}};var kT=(n,e)=>e.some(t=>n instanceof t),Ng,kg;function OT(){return Ng||(Ng=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xT(){return kg||(kg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Og=new WeakMap,il=new WeakMap,xg=new WeakMap,rl=new WeakMap,ol=new WeakMap;function MT(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(ht(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Og.set(t,n)}).catch(()=>{}),ol.set(e,n),e}function LT(n){if(il.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});il.set(n,e)}var sl={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return il.get(n);if(e==="objectStoreNames")return n.objectStoreNames||xg.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ht(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Mg(n){sl=n(sl)}function VT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(xo(this),e,...t);return xg.set(r,e.sort?e.sort():[e]),ht(r)}:xT().includes(n)?function(...e){return n.apply(xo(this),e),ht(Og.get(this))}:function(...e){return ht(n.apply(xo(this),e))}}function FT(n){return typeof n=="function"?VT(n):(n instanceof IDBTransaction&&LT(n),kT(n,OT())?new Proxy(n,sl):n)}function ht(n){if(n instanceof IDBRequest)return MT(n);if(rl.has(n))return rl.get(n);let e=FT(n);return e!==n&&(rl.set(n,e),ol.set(e,n)),e}var xo=n=>ol.get(n);function Vg(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),c=ht(a);return r&&a.addEventListener("upgradeneeded",l=>{r(ht(a.result),l.oldVersion,l.newVersion,ht(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}var UT=["get","getKey","getAll","getAllKeys","count"],jT=["put","add","delete","clear"],al=new Map;function Lg(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(al.get(e))return al.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=jT.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||UT.includes(t)))return;let s=function(a,...c){return _(this,null,function*(){let l=this.transaction(a,i?"readwrite":"readonly"),h=l.store;return r&&(h=h.index(c.shift())),(yield Promise.all([h[t](...c),i&&l.done]))[0]})};return al.set(e,s),s}Mg(n=>Re(V({},n),{get:(e,t,r)=>Lg(e,t)||n.get(e,t,r),has:(e,t)=>!!Lg(e,t)||n.has(e,t)}));var ul=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if($T(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function $T(n){let e=n.getComponent();return e?.type==="VERSION"}var ll="@firebase/app",Fg="0.10.5";var Sn=new tn("@firebase/app"),BT="@firebase/app-compat",qT="@firebase/analytics-compat",zT="@firebase/analytics",GT="@firebase/app-check-compat",WT="@firebase/app-check",KT="@firebase/auth",HT="@firebase/auth-compat",QT="@firebase/database",JT="@firebase/database-compat",YT="@firebase/functions",XT="@firebase/functions-compat",ZT="@firebase/installations",eA="@firebase/installations-compat",tA="@firebase/messaging",nA="@firebase/messaging-compat",rA="@firebase/performance",iA="@firebase/performance-compat",sA="@firebase/remote-config",oA="@firebase/remote-config-compat",aA="@firebase/storage",cA="@firebase/storage-compat",uA="@firebase/firestore",lA="@firebase/vertexai-preview",hA="@firebase/firestore-compat",dA="firebase",fA="10.12.2";var hl="[DEFAULT]",pA={[ll]:"fire-core",[BT]:"fire-core-compat",[zT]:"fire-analytics",[qT]:"fire-analytics-compat",[WT]:"fire-app-check",[GT]:"fire-app-check-compat",[KT]:"fire-auth",[HT]:"fire-auth-compat",[QT]:"fire-rtdb",[JT]:"fire-rtdb-compat",[YT]:"fire-fn",[XT]:"fire-fn-compat",[ZT]:"fire-iid",[eA]:"fire-iid-compat",[tA]:"fire-fcm",[nA]:"fire-fcm-compat",[rA]:"fire-perf",[iA]:"fire-perf-compat",[sA]:"fire-rc",[oA]:"fire-rc-compat",[aA]:"fire-gcs",[cA]:"fire-gcs-compat",[uA]:"fire-fst",[hA]:"fire-fst-compat",[lA]:"fire-vertex","fire-js":"fire-js",[dA]:"fire-js-all"};var Wi=new Map,mA=new Map,dl=new Map;function Ug(n,e){try{n.container.addComponent(e)}catch(t){Sn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function rn(n){let e=n.name;if(dl.has(e))return Sn.debug(`There were multiple attempts to register component ${e}.`),!1;dl.set(e,n);for(let t of Wi.values())Ug(t,n);for(let t of mA.values())Ug(t,n);return!0}function Hi(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function nt(n){return n.settings!==void 0}var gA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},nn=new Ct("app","Firebase",gA);var fl=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw nn.create("app-deleted",{appName:this._name})}};var sn=fA;function gl(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:hl,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw nn.create("bad-app-name",{appName:String(i)});if(t||(t=Zu()),!t)throw nn.create("no-options");let s=Wi.get(i);if(s){if(An(t,s.options)&&An(r,s.config))return s;throw nn.create("duplicate-app",{appName:i})}let a=new Oo(i);for(let l of dl.values())a.addComponent(l);let c=new fl(t,r,a);return Wi.set(i,c),c}function fr(n=hl){let e=Wi.get(n);if(!e&&n===hl&&Zu())return gl();if(!e)throw nn.create("no-app",{appName:n});return e}function Mo(){return Array.from(Wi.values())}function Ee(n,e,t){var r;let i=(r=pA[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Sn.warn(c.join(" "));return}rn(new Xe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var yA="firebase-heartbeat-database",vA=1,Ki="firebase-heartbeat-store",cl=null;function qg(){return cl||(cl=Vg(yA,vA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ki)}catch(t){console.warn(t)}}}}).catch(n=>{throw nn.create("idb-open",{originalErrorMessage:n.message})})),cl}function _A(n){return _(this,null,function*(){try{let t=(yield qg()).transaction(Ki),r=yield t.objectStore(Ki).get(zg(n));return yield t.done,r}catch(e){if(e instanceof Ke)Sn.warn(e.message);else{let t=nn.create("idb-get",{originalErrorMessage:e?.message});Sn.warn(t.message)}}})}function jg(n,e){return _(this,null,function*(){try{let r=(yield qg()).transaction(Ki,"readwrite");yield r.objectStore(Ki).put(e,zg(n)),yield r.done}catch(t){if(t instanceof Ke)Sn.warn(t.message);else{let r=nn.create("idb-set",{originalErrorMessage:t?.message});Sn.warn(r.message)}}})}function zg(n){return`${n.name}!${n.options.appId}`}var IA=1024,wA=30*24*60*60*1e3,pl=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new ml(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return _(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=$g();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let c=new Date(a.date).valueOf();return Date.now()-c<=wA}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return _(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=$g(),{heartbeatsToSend:r,unsentEntries:i}=EA(this._heartbeatsCache.heartbeats),s=zi(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function $g(){return new Date().toISOString().substring(0,10)}function EA(n,e=IA){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Bg(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Bg(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var ml=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return _(this,null,function*(){return tl()?Cg().then(()=>!0).catch(()=>!1):!1})}read(){return _(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield _A(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return _(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return jg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return _(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return jg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Bg(n){return zi(JSON.stringify({version:2,heartbeats:n})).length}function TA(n){rn(new Xe("platform-logger",e=>new ul(e),"PRIVATE")),rn(new Xe("heartbeat",e=>new pl(e),"PRIVATE")),Ee(ll,Fg,n),Ee(ll,Fg,"esm2017"),Ee("fire-js","")}TA("");var AA="firebase",bA="10.12.2";Ee(AA,bA,"app");var Cn=new Qs("ANGULARFIRE2_VERSION");function Vo(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Qi=(n,e)=>{let t=e?[e]:Mo(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},mr=class{constructor(){return Qi(SA)}},SA="app-check";function pr(){}var Lo=class{zone;delegate;constructor(e,t=Ip){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,r)}},yl=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",pr,{},pr,pr)),t.pipe(Ie({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},gr=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Lo(Zone.current)),this.insideAngular=t.run(()=>new Lo(Zone.current,_p)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(H(pe))};static \u0275prov=X({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Fo(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function RA(n){return Fo().ngZone.runOutsideAngular(()=>n())}function Rn(n){return Fo().ngZone.run(()=>n())}function CA(n){return PA(Fo())(n)}function PA(n){return function(t){return t=t.lift(new yl(n.ngZone)),t.pipe(kc(n.outsideAngular),Nc(n.insideAngular))}}var DA=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Rn(()=>n.apply(void 0,r))},Ae=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Rn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",pr,{},pr,pr))),r[s]=DA(r[s],t));let i=RA(()=>n.apply(this,r));if(!e)if(i instanceof At){let s=Fo();return i.pipe(kc(s.outsideAngular),Nc(s.insideAngular))}else return Rn(()=>i);return i instanceof At?i.pipe(CA):i instanceof Promise?Rn(()=>new Promise((s,a)=>i.then(c=>Rn(()=>s(c)),c=>Rn(()=>a(c))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Rn(()=>i)};var Pt=class{constructor(e){return e}},Pn=class{constructor(){return Mo()}};function NA(n){return n&&n.length===1?n[0]:new Pt(fr())}var vl=new ie("angularfire2._apps"),kA={provide:Pt,useFactory:NA,deps:[[new Ue,vl]]},OA={provide:Pn,deps:[[new Ue,vl]]};function xA(n){return(e,t)=>{let r=t.get(St);Ee("angularfire",Cn.full,"core"),Ee("angularfire",Cn.full,"app"),Ee("angular",Zp.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Pt(i)}}function tD(n,...e){return tt([kA,OA,{provide:vl,useFactory:xA(n),multi:!0,deps:[pe,bt,gr,...e]}])}var nD=Ae(gl,!0);function ay(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var cy=ay,uy=new Ct("auth","Firebase",ay());var zo=new tn("@firebase/auth");function MA(n,...e){zo.logLevel<=J.WARN&&zo.warn(`Auth (${sn}): ${n}`,...e)}function jo(n,...e){zo.logLevel<=J.ERROR&&zo.error(`Auth (${sn}): ${n}`,...e)}function ft(n,...e){throw $l(n,...e)}function Dn(n,...e){return $l(n,...e)}function ly(n,e,t){let r=Object.assign(Object.assign({},cy()),{[e]:t});return new Ct("auth","Firebase",r).create(e,{appName:n.name})}function kt(n){return ly(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $l(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return uy.create(n,...e)}function $(n,e,...t){if(!n)throw $l(e,...t)}function Dt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw jo(e),new Error(e)}function an(n,e){n||Dt(e)}function El(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function LA(){return Gg()==="http:"||Gg()==="https:"}function Gg(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function VA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(LA()||Ag()||"connection"in navigator)?navigator.onLine:!0}function FA(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Nn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,an(t>e,"Short delay should be less than long delay!"),this.isMobile=Tg()||bg()}get(){return VA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Bl(n,e){an(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Go=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Dt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Dt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Dt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var UA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var jA=new Nn(3e4,6e4);function cn(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function un(s,a,c,l){return _(this,arguments,function*(n,e,t,r,i={}){return hy(n,i,()=>_(this,null,function*(){let h={},f={};r&&(e==="GET"?f=r:h={body:JSON.stringify(r)});let g=Gi(Object.assign({key:n.config.apiKey},f)).slice(1),I=yield n._getAdditionalHeaders();return I["Content-Type"]="application/json",n.languageCode&&(I["X-Firebase-Locale"]=n.languageCode),Go.fetch()(dy(n,n.config.apiHost,t,g),Object.assign({method:e,headers:I,referrerPolicy:"no-referrer"},h))}))})}function hy(n,e,t){return _(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},UA),e);try{let i=new Tl(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw Uo(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let c=s.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Uo(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Uo(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Uo(n,"user-disabled",a);let f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw ly(n,f,h);ft(n,f)}}catch(i){if(i instanceof Ke)throw i;ft(n,"network-request-failed",{message:String(i)})}})}function rs(s,a,c,l){return _(this,arguments,function*(n,e,t,r,i={}){let h=yield un(n,e,t,r,i);return"mfaPendingCredential"in h&&ft(n,"multi-factor-auth-required",{_serverResponse:h}),h})}function dy(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Bl(n.config,i):`${n.config.apiScheme}://${i}`}function $A(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Tl=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Dn(this.auth,"network-request-failed")),jA.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Uo(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Dn(n,e,r);return i.customData._tokenResponse=t,i}function Wg(n){return n!==void 0&&n.enterprise!==void 0}var Al=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return $A(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function BA(n,e){return _(this,null,function*(){return un(n,"GET","/v2/recaptchaConfig",cn(n,e))})}function qA(n,e){return _(this,null,function*(){return un(n,"POST","/v1/accounts:delete",e)})}function fy(n,e){return _(this,null,function*(){return un(n,"POST","/v1/accounts:lookup",e)})}function Ji(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function ql(n,e=!1){return _(this,null,function*(){let t=me(n),r=yield t.getIdToken(e),i=zl(r);$(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Ji(_l(i.auth_time)),issuedAtTime:Ji(_l(i.iat)),expirationTime:Ji(_l(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function _l(n){return Number(n)*1e3}function zl(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return jo("JWT malformed, contained fewer than 3 sections"),null;try{let i=Yu(t);return i?JSON.parse(i):(jo("Failed to decode base64 JWT payload"),null)}catch(i){return jo("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Kg(n){let e=zl(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Xi(n,e,t=!1){return _(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Ke&&zA(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function zA({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var bl=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>_(this,null,function*(){yield this.iteration()}),t)}iteration(){return _(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Zi=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ji(this.lastLoginAt),this.creationTime=Ji(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Wo(n){return _(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Xi(n,fy(t,{idToken:r}));$(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?py(s.providerUserInfo):[],c=GA(n.providerData,a),l=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!c?.length,f=l?h:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Zi(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,g)})}function Gl(n){return _(this,null,function*(){let e=me(n);yield Wo(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function GA(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function py(n){return n.map(e=>{var{providerId:t}=e,r=Dc(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function WA(n,e){return _(this,null,function*(){let t=yield hy(n,{},()=>_(this,null,function*(){let r=Gi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=dy(n,i,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Go.fetch()(a,{method:"POST",headers:c,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function KA(n,e){return _(this,null,function*(){return un(n,"POST","/v2/accounts:revokeToken",cn(n,e))})}var Yi=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Kg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,"internal-error");let t=Kg(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return _(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return _(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield WA(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&($(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&($(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&($(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Dt("not implemented")}};function on(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var yr=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Dc(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new bl(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Zi(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return _(this,null,function*(){let t=yield Xi(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return ql(this,e)}reload(){return Gl(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return _(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Wo(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return _(this,null,function*(){if(nt(this.auth.app))return Promise.reject(kt(this.auth));let e=yield this.getIdToken();return yield Xi(this,qA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,c,l,h,f;let g=(r=t.displayName)!==null&&r!==void 0?r:void 0,I=(i=t.email)!==null&&i!==void 0?i:void 0,R=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,N=(a=t.photoURL)!==null&&a!==void 0?a:void 0,O=(c=t.tenantId)!==null&&c!==void 0?c:void 0,C=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,x=(h=t.createdAt)!==null&&h!==void 0?h:void 0,q=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:Q,emailVerified:K,isAnonymous:_e,providerData:ne,stsTokenManager:E}=t;$(Q&&E,e,"internal-error");let m=Yi.fromJSON(this.name,E);$(typeof Q=="string",e,"internal-error"),on(g,e.name),on(I,e.name),$(typeof K=="boolean",e,"internal-error"),$(typeof _e=="boolean",e,"internal-error"),on(R,e.name),on(N,e.name),on(O,e.name),on(C,e.name),on(x,e.name),on(q,e.name);let v=new n({uid:Q,auth:e,email:I,emailVerified:K,displayName:g,isAnonymous:_e,photoURL:N,phoneNumber:R,tenantId:O,stsTokenManager:m,createdAt:x,lastLoginAt:q});return ne&&Array.isArray(ne)&&(v.providerData=ne.map(w=>Object.assign({},w))),C&&(v._redirectEventId=C),v}static _fromIdTokenResponse(e,t,r=!1){return _(this,null,function*(){let i=new Yi;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Wo(s),s})}static _fromGetAccountInfoResponse(e,t,r){return _(this,null,function*(){let i=t.users[0];$(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?py(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,c=new Yi;c.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Zi(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,h),l})}};var Hg=new Map;function Nt(n){an(n instanceof Function,"Expected a class definition");let e=Hg.get(n);return e?(an(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Hg.set(n,e),e)}var HA=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return _(this,null,function*(){return!0})}_set(t,r){return _(this,null,function*(){this.storage[t]=r})}_get(t){return _(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return _(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Sl=HA;function $o(n,e,t){return`firebase:${n}:${e}:${t}`}var Ko=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=$o(this.userKey,i.apiKey,s),this.fullPersistenceKey=$o("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return _(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?yr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return _(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return _(this,null,function*(){if(!t.length)return new n(Nt(Sl),e,r);let i=(yield Promise.all(t.map(h=>_(this,null,function*(){if(yield h._isAvailable())return h})))).filter(h=>h),s=i[0]||Nt(Sl),a=$o(r,e.config.apiKey,e.name),c=null;for(let h of t)try{let f=yield h._get(a);if(f){let g=yr._fromJSON(e,f);h!==s&&(c=g),s=h;break}}catch{}let l=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],c&&(yield s._set(a,c.toJSON())),yield Promise.all(t.map(h=>_(this,null,function*(){if(h!==s)try{yield h._remove(a)}catch{}}))),new n(s,e,r))})}};function Qg(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(yy(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(my(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_y(e))return"Blackberry";if(Iy(e))return"Webos";if(Wl(e))return"Safari";if((e.includes("chrome/")||gy(e))&&!e.includes("edge/"))return"Chrome";if(vy(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function my(n=we()){return/firefox\//i.test(n)}function Wl(n=we()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function gy(n=we()){return/crios\//i.test(n)}function yy(n=we()){return/iemobile/i.test(n)}function vy(n=we()){return/android/i.test(n)}function _y(n=we()){return/blackberry/i.test(n)}function Iy(n=we()){return/webos/i.test(n)}function ta(n=we()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function QA(n=we()){var e;return ta(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function JA(){return Sg()&&document.documentMode===10}function wy(n=we()){return ta(n)||vy(n)||Iy(n)||_y(n)||/windows phone/i.test(n)||yy(n)}function YA(){try{return!!(window&&window!==window.top)}catch{return!1}}function Ey(n,e=[]){let t;switch(n){case"Browser":t=Qg(we());break;case"Worker":t=`${Qg(we())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${sn}/${r}`}var Rl=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,c)=>{try{let l=e(s);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return _(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function XA(t){return _(this,arguments,function*(n,e={}){return un(n,"GET","/v2/passwordPolicy",cn(n,e))})}var ZA=6,Cl=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:ZA,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Pl=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ho(this),this.idTokenSubscription=new Ho(this),this.beforeStateQueue=new Rl(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Nt(t)),this._initializationPromise=this.queue(()=>_(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Ko.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return _(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return _(this,null,function*(){try{let t=yield fy(this,{idToken:e}),r=yield yr._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return _(this,null,function*(){var t;if(nt(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return _(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return _(this,null,function*(){try{yield Wo(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=FA()}_delete(){return _(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return _(this,null,function*(){if(nt(this.app))return Promise.reject(kt(this));let t=e?me(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return _(this,null,function*(){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>_(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return _(this,null,function*(){return nt(this.app)?Promise.reject(kt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return nt(this.app)?Promise.reject(kt(this)):this.queue(()=>_(this,null,function*(){yield this.assertedPersistence.setPersistence(Nt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return _(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return _(this,null,function*(){let e=yield XA(this),t=new Cl(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ct("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return _(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield KA(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return _(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return _(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Nt(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=yield Ko.create(this,[Nt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return _(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>_(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return _(this,null,function*(){if(e===this.currentUser)return this.queue(()=>_(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if($(c,this,"internal-error"),c.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return _(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ey(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return _(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return _(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&MA(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function On(n){return me(n)}var Ho=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Dg(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var na={loadJS(){return _(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eb(n){na=n}function Ty(n){return na.loadJS(n)}function tb(){return na.recaptchaEnterpriseScript}function nb(){return na.gapiScript}function Ay(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var rb="recaptcha-enterprise",ib="NO_RECAPTCHA",Dl=class{constructor(e){this.type=rb,this.auth=On(e)}verify(e="verify",t=!1){return _(this,null,function*(){function r(s){return _(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,c)=>_(this,null,function*(){BA(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let h=new Al(l);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,a(h.siteKey)}}).catch(l=>{c(l)})}))})}function i(s,a,c){let l=window.grecaptcha;Wg(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(h=>{a(h)}).catch(()=>{a(ib)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(c=>{if(!t&&Wg(window.grecaptcha))i(c,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=tb();l.length!==0&&(l+=c),Ty(l).then(()=>{i(c,s,a)}).catch(h=>{a(h)})}}).catch(c=>{a(c)})})})}};function Jg(n,e,t,r=!1){return _(this,null,function*(){let i=new Dl(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function Nl(n,e,t,r){return _(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield Jg(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>_(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=yield Jg(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)}))})}function Kl(n,e){let t=Hi(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(An(s,e??{}))return i;ft(i,"already-initialized")}return t.initialize({options:e})}function sb(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Nt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Hl(n,e,t){let r=On(n);$(r._canInitEmulator,r,"emulator-config-failed"),$(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=by(e),{host:a,port:c}=ob(e),l=c===null?"":`:${c}`;r.config.emulator={url:`${s}//${a}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||ab()}function by(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ob(n){let e=by(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Yg(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:Yg(a)}}}function Yg(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function ab(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var es=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Dt("not implemented")}_getIdTokenResponse(e){return Dt("not implemented")}_linkToIdToken(e,t){return Dt("not implemented")}_getReauthenticationResolver(e){return Dt("not implemented")}};function cb(n,e){return _(this,null,function*(){return un(n,"POST","/v1/accounts:signUp",e)})}function ub(n,e){return _(this,null,function*(){return rs(n,"POST","/v1/accounts:signInWithPassword",cn(n,e))})}function lb(n,e){return _(this,null,function*(){return rs(n,"POST","/v1/accounts:signInWithEmailLink",cn(n,e))})}function hb(n,e){return _(this,null,function*(){return rs(n,"POST","/v1/accounts:signInWithEmailLink",cn(n,e))})}var ts=class n extends es{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return _(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nl(e,t,"signInWithPassword",ub);case"emailLink":return lb(e,{email:this._email,oobCode:this._password});default:ft(e,"internal-error")}})}_linkToIdToken(e,t){return _(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nl(e,r,"signUpPassword",cb);case"emailLink":return hb(e,{idToken:t,email:this._email,oobCode:this._password});default:ft(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Il(n,e){return _(this,null,function*(){return rs(n,"POST","/v1/accounts:signInWithIdp",cn(n,e))})}function db(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function fb(n){let e=hr(dr(n)).link,t=e?hr(dr(e)).deep_link_id:null,r=hr(dr(n)).deep_link_id;return(r?hr(dr(r)).link:null)||r||t||e||n}var Qo=class n{constructor(e){var t,r,i,s,a,c;let l=hr(dr(e)),h=(t=l.apiKey)!==null&&t!==void 0?t:null,f=(r=l.oobCode)!==null&&r!==void 0?r:null,g=db((i=l.mode)!==null&&i!==void 0?i:null);$(h&&f&&g,"argument-error"),this.apiKey=h,this.operation=g,this.code=f,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(c=l.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){let t=fb(e);try{return new n(t)}catch{return null}}};var Sy=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return ts._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Qo.parseLink(r);return $(i,"argument-error"),ts._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Jo=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var kl=class extends Jo{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function pb(n,e){return _(this,null,function*(){return rs(n,"POST","/v1/accounts:signUp",cn(n,e))})}var vr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return _(this,null,function*(){let s=yield yr._fromIdTokenResponse(e,r,i),a=Xg(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return _(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=Xg(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function Xg(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Ol=class n extends Ke{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Ry(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ol._fromErrorAndOperation(n,s,e,r):s})}function mb(n,e,t=!1){return _(this,null,function*(){let r=yield Xi(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return vr._forOperation(n,"link",r)})}function gb(n,e,t=!1){return _(this,null,function*(){let{auth:r}=n;if(nt(r.app))return Promise.reject(kt(r));let i="reauthenticate";try{let s=yield Xi(n,Ry(r,i,e,n),t);$(s.idToken,r,"internal-error");let a=zl(s.idToken);$(a,r,"internal-error");let{sub:c}=a;return $(n.uid===c,r,"user-mismatch"),vr._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&ft(r,"user-mismatch"),s}})}function Cy(n,e,t=!1){return _(this,null,function*(){if(nt(n.app))return Promise.reject(kt(n));let r="signIn",i=yield Ry(n,r,e),s=yield vr._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Ql(n,e){return _(this,null,function*(){return Cy(On(n),e)})}function Py(n){return _(this,null,function*(){let e=On(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function Jl(n,e,t){return _(this,null,function*(){if(nt(n.app))return Promise.reject(kt(n));let r=On(n),a=yield Nl(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",pb).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Py(n),l}),c=yield vr._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(c.user),c})}function Yl(n,e,t){return nt(n.app)?Promise.reject(kt(n)):Ql(me(n),Sy.credential(e,t)).catch(r=>_(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Py(n),r}))}function ra(n,e,t,r){return me(n).onIdTokenChanged(e,t,r)}function Xl(n,e,t){return me(n).beforeAuthStateChanged(e,t)}function ia(n,e,t,r){return me(n).onAuthStateChanged(e,t,r)}var Yo="__sak";var Xo=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Yo,"1"),this.storage.removeItem(Yo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function yb(){let n=we();return Wl(n)||ta(n)}var vb=1e3,_b=10,Ib=(()=>{class n extends Xo{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=yb()&&YA(),this.fallbackToPolling=wy(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,l,h)=>{this.notifyListeners(c,h)});return}let i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let c=this.storage.getItem(i);if(t.newValue!==c)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}let s=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},a=this.storage.getItem(i);JA()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,_b):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},vb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return _(this,null,function*(){yield qt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return _(this,null,function*(){let r=yield qt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return _(this,null,function*(){yield qt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Dy=Ib;var wb=(()=>{class n extends Xo{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Zl=wb;function Eb(n){return Promise.all(n.map(e=>_(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var Tb=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return _(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,c=this.handlersMap[s];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(c).map(f=>_(this,null,function*(){return f(r.origin,a)})),h=yield Eb(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:h})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Ny(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var xl=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return _(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((c,l)=>{let h=Ny("",20);i.port1.start();let f=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(g){let I=g;if(I.data.eventId===h)switch(I.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(I.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function dt(){return window}function Ab(n){dt().location.href=n}function ky(){return typeof dt().WorkerGlobalScope<"u"&&typeof dt().importScripts=="function"}function bb(){return _(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function Sb(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Rb(){return ky()?self:null}var Oy="firebaseLocalStorageDb",Cb=1,Zo="firebaseLocalStorage",xy="fbase_key",kn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function sa(n,e){return n.transaction([Zo],e?"readwrite":"readonly").objectStore(Zo)}function Pb(){let n=indexedDB.deleteDatabase(Oy);return new kn(n).toPromise()}function Ml(){let n=indexedDB.open(Oy,Cb);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Zo,{keyPath:xy})}catch(i){t(i)}}),n.addEventListener("success",()=>_(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Zo)?e(r):(r.close(),yield Pb(),e(yield Ml()))}))})}function Zg(n,e,t){return _(this,null,function*(){let r=sa(n,!0).put({[xy]:e,value:t});return new kn(r).toPromise()})}function Db(n,e){return _(this,null,function*(){let t=sa(n,!1).get(e),r=yield new kn(t).toPromise();return r===void 0?null:r.value})}function ey(n,e){let t=sa(n,!0).delete(e);return new kn(t).toPromise()}var Nb=800,kb=3,Ob=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return _(this,null,function*(){return this.db?this.db:(this.db=yield Ml(),this.db)})}_withRetries(t){return _(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>kb)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return _(this,null,function*(){return ky()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return _(this,null,function*(){this.receiver=Tb._getInstance(Rb()),this.receiver._subscribe("keyChanged",(t,r)=>_(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>_(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return _(this,null,function*(){var t,r;if(this.activeServiceWorker=yield bb(),!this.activeServiceWorker)return;this.sender=new xl(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return _(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||Sb()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return _(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Ml();return yield Zg(t,Yo,"1"),yield ey(t,Yo),!0}catch{}return!1})}_withPendingWrite(t){return _(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return _(this,null,function*(){return this._withPendingWrite(()=>_(this,null,function*(){return yield this._withRetries(i=>Zg(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return _(this,null,function*(){let r=yield this._withRetries(i=>Db(i,t));return this.localCache[t]=r,r})}_remove(t){return _(this,null,function*(){return this._withPendingWrite(()=>_(this,null,function*(){return yield this._withRetries(r=>ey(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return _(this,null,function*(){let t=yield this._withRetries(s=>{let a=sa(s,!1).getAll();return new kn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>_(this,null,function*(){return this._poll()}),Nb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),My=Ob;var lD=Ay("rcb"),hD=new Nn(3e4,6e4);function xb(n,e){return e?Nt(e):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var ns=class extends es{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Il(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Il(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Il(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Mb(n){return Cy(n.auth,new ns(n),n.bypassAuthState)}function Lb(n){let{auth:e,user:t}=n;return $(t,e,"internal-error"),gb(t,new ns(n),n.bypassAuthState)}function Vb(n){return _(this,null,function*(){let{auth:e,user:t}=n;return $(t,e,"internal-error"),mb(t,new ns(n),n.bypassAuthState)})}var Ll=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>_(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return _(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:c}=e;if(a){this.reject(a);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(l))}catch(h){this.reject(h)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Mb;case"linkViaPopup":case"linkViaRedirect":return Vb;case"reauthViaPopup":case"reauthViaRedirect":return Lb;default:ft(this.auth,"internal-error")}}resolve(e){an(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){an(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var dD=new Nn(2e3,1e4);var Fb="pendingRedirect",Bo=new Map,Vl=class n extends Ll{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return _(this,null,function*(){let e=Bo.get(this.auth._key());if(!e){try{let r=(yield Ub(this.resolver,this.auth))?yield qt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Bo.set(this.auth._key(),e)}return this.bypassAuthState||Bo.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return _(this,null,function*(){if(e.type==="signInViaRedirect")return qt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,qt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return _(this,null,function*(){})}cleanUp(){}};function Ub(n,e){return _(this,null,function*(){let t=Bb(e),r=$b(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function jb(n,e){Bo.set(n._key(),e)}function $b(n){return Nt(n._redirectPersistence)}function Bb(n){return $o(Fb,n.config.apiKey,n.name)}function qb(n,e,t=!1){return _(this,null,function*(){if(nt(n.app))return Promise.reject(kt(n));let r=On(n),i=xb(r,e),a=yield new Vl(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var zb=10*60*1e3,Fl=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Gb(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Ly(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Dn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zb&&this.cachedEventUids.clear(),this.cachedEventUids.has(ty(e))}saveEventToCache(e){this.cachedEventUids.add(ty(e)),this.lastProcessedEventTime=Date.now()}};function ty(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Ly({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Gb(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ly(n);default:return!1}}function Wb(t){return _(this,arguments,function*(n,e={}){return un(n,"GET","/v1/projects",e)})}var Kb=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Hb=/^https?/;function Qb(n){return _(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield Wb(n);for(let t of e)try{if(Jb(t))return}catch{}ft(n,"unauthorized-domain")})}function Jb(n){let e=El(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!Hb.test(t))return!1;if(Kb.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Yb=new Nn(3e4,6e4);function ny(){let n=dt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Xb(n){return new Promise((e,t)=>{var r,i,s;function a(){ny(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ny(),t(Dn(n,"network-request-failed"))},timeout:Yb.get()})}if(!((i=(r=dt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=dt().gapi)===null||s===void 0)&&s.load)a();else{let c=Ay("iframefcb");return dt()[c]=()=>{gapi.load?a():t(Dn(n,"network-request-failed"))},Ty(`${nb()}?onload=${c}`).catch(l=>t(l))}}).catch(e=>{throw qo=null,e})}var qo=null;function Zb(n){return qo=qo||Xb(n),qo}var eS=new Nn(5e3,15e3),tS="__/auth/iframe",nS="emulator/auth/iframe",rS={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sS(n){let e=n.config;$(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Bl(e,nS):`https://${n.config.authDomain}/${tS}`,r={apiKey:e.apiKey,appName:n.name,v:sn},i=iS.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Gi(r).slice(1)}`}function oS(n){return _(this,null,function*(){let e=yield Zb(n),t=dt().gapi;return $(t,n,"internal-error"),e.open({where:document.body,url:sS(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rS,dontclear:!0},r=>new Promise((i,s)=>_(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=Dn(n,"network-request-failed"),c=dt().setTimeout(()=>{s(a)},eS.get());function l(){dt().clearTimeout(c),i(r)}r.ping(l).then(l,()=>{s(a)})})))})}var aS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},cS=500,uS=600,lS="_blank",hS="http://localhost",ea=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function dS(n,e,t,r=cS,i=uS){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",l=Object.assign(Object.assign({},aS),{width:r.toString(),height:i.toString(),top:s,left:a}),h=we().toLowerCase();t&&(c=gy(h)?lS:t),my(h)&&(e=e||hS,l.scrollbars="yes");let f=Object.entries(l).reduce((I,[R,N])=>`${I}${R}=${N},`,"");if(QA(h)&&c!=="_self")return fS(e||"",c),new ea(null);let g=window.open(e||"",c,f);$(g,n,"popup-blocked");try{g.focus()}catch{}return new ea(g)}function fS(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var pS="__/auth/handler",mS="emulator/auth/handler",gS=encodeURIComponent("fac");function ry(n,e,t,r,i,s){return _(this,null,function*(){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:sn,eventId:i};if(e instanceof Jo){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Pg(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,g]of Object.entries(s||{}))a[f]=g}if(e instanceof kl){let f=e.getScopes().filter(g=>g!=="");f.length>0&&(a.scopes=f.join(","))}n.tenantId&&(a.tid=n.tenantId);let c=a;for(let f of Object.keys(c))c[f]===void 0&&delete c[f];let l=yield n._getAppCheckToken(),h=l?`#${gS}=${encodeURIComponent(l)}`:"";return`${yS(n)}?${Gi(c).slice(1)}${h}`})}function yS({config:n}){return n.emulator?Bl(n,mS):`https://${n.authDomain}/${pS}`}var wl="webStorageSupport",Ul=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zl,this._completeRedirectFn=qb,this._overrideRedirectResult=jb}_openPopup(e,t,r,i){return _(this,null,function*(){var s;an((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield ry(e,t,r,El(),i);return dS(e,a,Ny())})}_openRedirect(e,t,r,i){return _(this,null,function*(){yield this._originValidation(e);let s=yield ry(e,t,r,El(),i);return Ab(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(an(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return _(this,null,function*(){let t=yield oS(e),r=new Fl(e);return t.register("authEvent",i=>($(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(wl,{type:wl},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[wl];a!==void 0&&t(!!a),ft(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Qb(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return wy()||Wl()||ta()}},Vy=Ul;var iy="@firebase/auth",sy="1.7.4";var jl=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return _(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function vS(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _S(n){rn(new Xe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;$(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ey(n)},h=new Pl(r,i,s,l);return sb(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),rn(new Xe("auth-internal",e=>{let t=On(e.getProvider("auth").getImmediate());return(r=>new jl(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ee(iy,sy,vS(n)),Ee(iy,sy,"esm2017")}var IS=5*60,wS=el("authIdTokenMaxAge")||IS,oy=null,ES=n=>e=>_(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>wS)return;let i=t?.token;oy!==i&&(oy=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function eh(n=fr()){let e=Hi(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Kl(n,{popupRedirectResolver:Vy,persistence:[My,Dy,Zl]}),r=el("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=ES(s.toString());Xl(t,a,()=>a(t.currentUser)),ra(t,c=>a(c))}}let i=Xu("auth");return i&&Hl(t,`http://${i}`),t}function TS(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}eb({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Dn("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",TS().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_S("Browser");function Uy(n){return new At(function(e){var t=ia(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var jy="auth",is=class{constructor(e){return e}},ss=class{constructor(){return Qi(jy)}};var th=new ie("angularfire2.auth-instances");function dR(n,e){let t=Vo(jy,n,e);return t&&new is(t)}function fR(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new is(r)}}var pR={provide:ss,deps:[[new Ue,th]]},mR={provide:is,useFactory:dR,deps:[[new Ue,th],Pt]};function tN(n,...e){return Ee("angularfire",Cn.full,"auth"),tt([mR,pR,{provide:th,useFactory:fR(n),multi:!0,deps:[pe,bt,gr,Pn,[new Ue,mr],...e]}])}var nN=Ae(Uy,!0);var rN=Ae(Jl,!0);var iN=Ae(eh,!0);var sN=Ae(Yl,!0);var $y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},By={};var ln,nh;(function(){var n;function e(E,m){function v(){}v.prototype=m.prototype,E.D=m.prototype,E.prototype=new v,E.prototype.constructor=E,E.C=function(w,T,b){for(var y=Array(arguments.length-2),wt=2;wt<arguments.length;wt++)y[wt-2]=arguments[wt];return m.prototype[T].apply(w,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,m,v){v||(v=0);var w=Array(16);if(typeof m=="string")for(var T=0;16>T;++T)w[T]=m.charCodeAt(v++)|m.charCodeAt(v++)<<8|m.charCodeAt(v++)<<16|m.charCodeAt(v++)<<24;else for(T=0;16>T;++T)w[T]=m[v++]|m[v++]<<8|m[v++]<<16|m[v++]<<24;m=E.g[0],v=E.g[1],T=E.g[2];var b=E.g[3],y=m+(b^v&(T^b))+w[0]+3614090360&4294967295;m=v+(y<<7&4294967295|y>>>25),y=b+(T^m&(v^T))+w[1]+3905402710&4294967295,b=m+(y<<12&4294967295|y>>>20),y=T+(v^b&(m^v))+w[2]+606105819&4294967295,T=b+(y<<17&4294967295|y>>>15),y=v+(m^T&(b^m))+w[3]+3250441966&4294967295,v=T+(y<<22&4294967295|y>>>10),y=m+(b^v&(T^b))+w[4]+4118548399&4294967295,m=v+(y<<7&4294967295|y>>>25),y=b+(T^m&(v^T))+w[5]+1200080426&4294967295,b=m+(y<<12&4294967295|y>>>20),y=T+(v^b&(m^v))+w[6]+2821735955&4294967295,T=b+(y<<17&4294967295|y>>>15),y=v+(m^T&(b^m))+w[7]+4249261313&4294967295,v=T+(y<<22&4294967295|y>>>10),y=m+(b^v&(T^b))+w[8]+1770035416&4294967295,m=v+(y<<7&4294967295|y>>>25),y=b+(T^m&(v^T))+w[9]+2336552879&4294967295,b=m+(y<<12&4294967295|y>>>20),y=T+(v^b&(m^v))+w[10]+4294925233&4294967295,T=b+(y<<17&4294967295|y>>>15),y=v+(m^T&(b^m))+w[11]+2304563134&4294967295,v=T+(y<<22&4294967295|y>>>10),y=m+(b^v&(T^b))+w[12]+1804603682&4294967295,m=v+(y<<7&4294967295|y>>>25),y=b+(T^m&(v^T))+w[13]+4254626195&4294967295,b=m+(y<<12&4294967295|y>>>20),y=T+(v^b&(m^v))+w[14]+2792965006&4294967295,T=b+(y<<17&4294967295|y>>>15),y=v+(m^T&(b^m))+w[15]+1236535329&4294967295,v=T+(y<<22&4294967295|y>>>10),y=m+(T^b&(v^T))+w[1]+4129170786&4294967295,m=v+(y<<5&4294967295|y>>>27),y=b+(v^T&(m^v))+w[6]+3225465664&4294967295,b=m+(y<<9&4294967295|y>>>23),y=T+(m^v&(b^m))+w[11]+643717713&4294967295,T=b+(y<<14&4294967295|y>>>18),y=v+(b^m&(T^b))+w[0]+3921069994&4294967295,v=T+(y<<20&4294967295|y>>>12),y=m+(T^b&(v^T))+w[5]+3593408605&4294967295,m=v+(y<<5&4294967295|y>>>27),y=b+(v^T&(m^v))+w[10]+38016083&4294967295,b=m+(y<<9&4294967295|y>>>23),y=T+(m^v&(b^m))+w[15]+3634488961&4294967295,T=b+(y<<14&4294967295|y>>>18),y=v+(b^m&(T^b))+w[4]+3889429448&4294967295,v=T+(y<<20&4294967295|y>>>12),y=m+(T^b&(v^T))+w[9]+568446438&4294967295,m=v+(y<<5&4294967295|y>>>27),y=b+(v^T&(m^v))+w[14]+3275163606&4294967295,b=m+(y<<9&4294967295|y>>>23),y=T+(m^v&(b^m))+w[3]+4107603335&4294967295,T=b+(y<<14&4294967295|y>>>18),y=v+(b^m&(T^b))+w[8]+1163531501&4294967295,v=T+(y<<20&4294967295|y>>>12),y=m+(T^b&(v^T))+w[13]+2850285829&4294967295,m=v+(y<<5&4294967295|y>>>27),y=b+(v^T&(m^v))+w[2]+4243563512&4294967295,b=m+(y<<9&4294967295|y>>>23),y=T+(m^v&(b^m))+w[7]+1735328473&4294967295,T=b+(y<<14&4294967295|y>>>18),y=v+(b^m&(T^b))+w[12]+2368359562&4294967295,v=T+(y<<20&4294967295|y>>>12),y=m+(v^T^b)+w[5]+4294588738&4294967295,m=v+(y<<4&4294967295|y>>>28),y=b+(m^v^T)+w[8]+2272392833&4294967295,b=m+(y<<11&4294967295|y>>>21),y=T+(b^m^v)+w[11]+1839030562&4294967295,T=b+(y<<16&4294967295|y>>>16),y=v+(T^b^m)+w[14]+4259657740&4294967295,v=T+(y<<23&4294967295|y>>>9),y=m+(v^T^b)+w[1]+2763975236&4294967295,m=v+(y<<4&4294967295|y>>>28),y=b+(m^v^T)+w[4]+1272893353&4294967295,b=m+(y<<11&4294967295|y>>>21),y=T+(b^m^v)+w[7]+4139469664&4294967295,T=b+(y<<16&4294967295|y>>>16),y=v+(T^b^m)+w[10]+3200236656&4294967295,v=T+(y<<23&4294967295|y>>>9),y=m+(v^T^b)+w[13]+681279174&4294967295,m=v+(y<<4&4294967295|y>>>28),y=b+(m^v^T)+w[0]+3936430074&4294967295,b=m+(y<<11&4294967295|y>>>21),y=T+(b^m^v)+w[3]+3572445317&4294967295,T=b+(y<<16&4294967295|y>>>16),y=v+(T^b^m)+w[6]+76029189&4294967295,v=T+(y<<23&4294967295|y>>>9),y=m+(v^T^b)+w[9]+3654602809&4294967295,m=v+(y<<4&4294967295|y>>>28),y=b+(m^v^T)+w[12]+3873151461&4294967295,b=m+(y<<11&4294967295|y>>>21),y=T+(b^m^v)+w[15]+530742520&4294967295,T=b+(y<<16&4294967295|y>>>16),y=v+(T^b^m)+w[2]+3299628645&4294967295,v=T+(y<<23&4294967295|y>>>9),y=m+(T^(v|~b))+w[0]+4096336452&4294967295,m=v+(y<<6&4294967295|y>>>26),y=b+(v^(m|~T))+w[7]+1126891415&4294967295,b=m+(y<<10&4294967295|y>>>22),y=T+(m^(b|~v))+w[14]+2878612391&4294967295,T=b+(y<<15&4294967295|y>>>17),y=v+(b^(T|~m))+w[5]+4237533241&4294967295,v=T+(y<<21&4294967295|y>>>11),y=m+(T^(v|~b))+w[12]+1700485571&4294967295,m=v+(y<<6&4294967295|y>>>26),y=b+(v^(m|~T))+w[3]+2399980690&4294967295,b=m+(y<<10&4294967295|y>>>22),y=T+(m^(b|~v))+w[10]+4293915773&4294967295,T=b+(y<<15&4294967295|y>>>17),y=v+(b^(T|~m))+w[1]+2240044497&4294967295,v=T+(y<<21&4294967295|y>>>11),y=m+(T^(v|~b))+w[8]+1873313359&4294967295,m=v+(y<<6&4294967295|y>>>26),y=b+(v^(m|~T))+w[15]+4264355552&4294967295,b=m+(y<<10&4294967295|y>>>22),y=T+(m^(b|~v))+w[6]+2734768916&4294967295,T=b+(y<<15&4294967295|y>>>17),y=v+(b^(T|~m))+w[13]+1309151649&4294967295,v=T+(y<<21&4294967295|y>>>11),y=m+(T^(v|~b))+w[4]+4149444226&4294967295,m=v+(y<<6&4294967295|y>>>26),y=b+(v^(m|~T))+w[11]+3174756917&4294967295,b=m+(y<<10&4294967295|y>>>22),y=T+(m^(b|~v))+w[2]+718787259&4294967295,T=b+(y<<15&4294967295|y>>>17),y=v+(b^(T|~m))+w[9]+3951481745&4294967295,E.g[0]=E.g[0]+m&4294967295,E.g[1]=E.g[1]+(T+(y<<21&4294967295|y>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+b&4294967295}r.prototype.u=function(E,m){m===void 0&&(m=E.length);for(var v=m-this.blockSize,w=this.B,T=this.h,b=0;b<m;){if(T==0)for(;b<=v;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<m;)if(w[T++]=E.charCodeAt(b++),T==this.blockSize){i(this,w),T=0;break}}else for(;b<m;)if(w[T++]=E[b++],T==this.blockSize){i(this,w),T=0;break}}this.h=T,this.o+=m},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var m=1;m<E.length-8;++m)E[m]=0;var v=8*this.o;for(m=E.length-8;m<E.length;++m)E[m]=v&255,v/=256;for(this.u(E),E=Array(16),m=v=0;4>m;++m)for(var w=0;32>w;w+=8)E[v++]=this.g[m]>>>w&255;return E};function s(E,m){var v=c;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=m(E)}function a(E,m){this.h=m;for(var v=[],w=!0,T=E.length-1;0<=T;T--){var b=E[T]|0;w&&b==m||(v[T]=b,w=!1)}this.g=v}var c={};function l(E){return-128<=E&&128>E?s(E,function(m){return new a([m|0],0>m?-1:0)}):new a([E|0],0>E?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return g;if(0>E)return C(h(-E));for(var m=[],v=1,w=0;E>=v;w++)m[w]=E/v|0,v*=4294967296;return new a(m,0)}function f(E,m){if(E.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(E.charAt(0)=="-")return C(f(E.substring(1),m));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(m,8)),w=g,T=0;T<E.length;T+=8){var b=Math.min(8,E.length-T),y=parseInt(E.substring(T,T+b),m);8>b?(b=h(Math.pow(m,b)),w=w.j(b).add(h(y))):(w=w.j(v),w=w.add(h(y)))}return w}var g=l(0),I=l(1),R=l(16777216);n=a.prototype,n.m=function(){if(O(this))return-C(this).m();for(var E=0,m=1,v=0;v<this.g.length;v++){var w=this.i(v);E+=(0<=w?w:4294967296+w)*m,m*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(N(this))return"0";if(O(this))return"-"+C(this).toString(E);for(var m=h(Math.pow(E,6)),v=this,w="";;){var T=K(v,m).g;v=x(v,T.j(m));var b=((0<v.g.length?v.g[0]:v.h)>>>0).toString(E);if(v=T,N(v))return b+w;for(;6>b.length;)b="0"+b;w=b+w}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function N(E){if(E.h!=0)return!1;for(var m=0;m<E.g.length;m++)if(E.g[m]!=0)return!1;return!0}function O(E){return E.h==-1}n.l=function(E){return E=x(this,E),O(E)?-1:N(E)?0:1};function C(E){for(var m=E.g.length,v=[],w=0;w<m;w++)v[w]=~E.g[w];return new a(v,~E.h).add(I)}n.abs=function(){return O(this)?C(this):this},n.add=function(E){for(var m=Math.max(this.g.length,E.g.length),v=[],w=0,T=0;T<=m;T++){var b=w+(this.i(T)&65535)+(E.i(T)&65535),y=(b>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);w=y>>>16,b&=65535,y&=65535,v[T]=y<<16|b}return new a(v,v[v.length-1]&-2147483648?-1:0)};function x(E,m){return E.add(C(m))}n.j=function(E){if(N(this)||N(E))return g;if(O(this))return O(E)?C(this).j(C(E)):C(C(this).j(E));if(O(E))return C(this.j(C(E)));if(0>this.l(R)&&0>E.l(R))return h(this.m()*E.m());for(var m=this.g.length+E.g.length,v=[],w=0;w<2*m;w++)v[w]=0;for(w=0;w<this.g.length;w++)for(var T=0;T<E.g.length;T++){var b=this.i(w)>>>16,y=this.i(w)&65535,wt=E.i(T)>>>16,Br=E.i(T)&65535;v[2*w+2*T]+=y*Br,q(v,2*w+2*T),v[2*w+2*T+1]+=b*Br,q(v,2*w+2*T+1),v[2*w+2*T+1]+=y*wt,q(v,2*w+2*T+1),v[2*w+2*T+2]+=b*wt,q(v,2*w+2*T+2)}for(w=0;w<m;w++)v[w]=v[2*w+1]<<16|v[2*w];for(w=m;w<2*m;w++)v[w]=0;return new a(v,0)};function q(E,m){for(;(E[m]&65535)!=E[m];)E[m+1]+=E[m]>>>16,E[m]&=65535,m++}function Q(E,m){this.g=E,this.h=m}function K(E,m){if(N(m))throw Error("division by zero");if(N(E))return new Q(g,g);if(O(E))return m=K(C(E),m),new Q(C(m.g),C(m.h));if(O(m))return m=K(E,C(m)),new Q(C(m.g),m.h);if(30<E.g.length){if(O(E)||O(m))throw Error("slowDivide_ only works with positive integers.");for(var v=I,w=m;0>=w.l(E);)v=_e(v),w=_e(w);var T=ne(v,1),b=ne(w,1);for(w=ne(w,2),v=ne(v,2);!N(w);){var y=b.add(w);0>=y.l(E)&&(T=T.add(v),b=y),w=ne(w,1),v=ne(v,1)}return m=x(E,T.j(m)),new Q(T,m)}for(T=g;0<=E.l(m);){for(v=Math.max(1,Math.floor(E.m()/m.m())),w=Math.ceil(Math.log(v)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),b=h(v),y=b.j(m);O(y)||0<y.l(E);)v-=w,b=h(v),y=b.j(m);N(b)&&(b=I),T=T.add(b),E=x(E,y)}return new Q(T,E)}n.A=function(E){return K(this,E).h},n.and=function(E){for(var m=Math.max(this.g.length,E.g.length),v=[],w=0;w<m;w++)v[w]=this.i(w)&E.i(w);return new a(v,this.h&E.h)},n.or=function(E){for(var m=Math.max(this.g.length,E.g.length),v=[],w=0;w<m;w++)v[w]=this.i(w)|E.i(w);return new a(v,this.h|E.h)},n.xor=function(E){for(var m=Math.max(this.g.length,E.g.length),v=[],w=0;w<m;w++)v[w]=this.i(w)^E.i(w);return new a(v,this.h^E.h)};function _e(E){for(var m=E.g.length+1,v=[],w=0;w<m;w++)v[w]=E.i(w)<<1|E.i(w-1)>>>31;return new a(v,E.h)}function ne(E,m){var v=m>>5;m%=32;for(var w=E.g.length-v,T=[],b=0;b<w;b++)T[b]=0<m?E.i(b+v)>>>m|E.i(b+v+1)<<32-m:E.i(b+v);return new a(T,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,nh=By.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,ln=By.Integer=a}).apply(typeof $y<"u"?$y:typeof self<"u"?self:typeof window<"u"?window:{});var oa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ot={};var rh,ih,_r,sh,os,aa,oh,ah,ch;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,d){return o==Array.prototype||o==Object.prototype||(o[u]=d.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof oa=="object"&&oa];for(var u=0;u<o.length;++u){var d=o[u];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(o,u){if(u)e:{var d=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var A=o[p];if(!(A in d))break e;d=d[A]}o=o[o.length-1],p=d[o],u=u(p),u!=p&&u!=null&&e(d,o,{configurable:!0,writable:!0,value:u})}}function s(o,u){o instanceof String&&(o+="");var d=0,p=!1,A={next:function(){if(!p&&d<o.length){var S=d++;return{value:u(S,o[S]),done:!1}}return p=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(o){return o||function(){return s(this,function(u,d){return d})}});var a=a||{},c=this||self;function l(o){var u=typeof o;return u=u!="object"?u:o?Array.isArray(o)?"array":u:"null",u=="array"||u=="object"&&typeof o.length=="number"}function h(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function f(o,u,d){return o.call.apply(o.bind,arguments)}function g(o,u,d){if(!o)throw Error();if(2<arguments.length){var p=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,p),o.apply(u,A)}}return function(){return o.apply(u,arguments)}}function I(o,u,d){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:g,I.apply(null,arguments)}function R(o,u){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function N(o,u){function d(){}d.prototype=u.prototype,o.aa=u.prototype,o.prototype=new d,o.prototype.constructor=o,o.Qb=function(p,A,S){for(var k=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)k[oe-2]=arguments[oe];return u.prototype[A].apply(p,k)}}function O(o){let u=o.length;if(0<u){let d=Array(u);for(let p=0;p<u;p++)d[p]=o[p];return d}return[]}function C(o,u){for(let d=1;d<arguments.length;d++){let p=arguments[d];if(l(p)){let A=o.length||0,S=p.length||0;o.length=A+S;for(let k=0;k<S;k++)o[A+k]=p[k]}else o.push(p)}}class x{constructor(u,d){this.i=u,this.j=d,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function q(o){return/^[\s\xa0]*$/.test(o)}function Q(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function K(o){return K[" "](o),o}K[" "]=function(){};var _e=Q().indexOf("Gecko")!=-1&&!(Q().toLowerCase().indexOf("webkit")!=-1&&Q().indexOf("Edge")==-1)&&!(Q().indexOf("Trident")!=-1||Q().indexOf("MSIE")!=-1)&&Q().indexOf("Edge")==-1;function ne(o,u,d){for(let p in o)u.call(d,o[p],p,o)}function E(o,u){for(let d in o)u.call(void 0,o[d],d,o)}function m(o){let u={};for(let d in o)u[d]=o[d];return u}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(o,u){let d,p;for(let A=1;A<arguments.length;A++){p=arguments[A];for(d in p)o[d]=p[d];for(let S=0;S<v.length;S++)d=v[S],Object.prototype.hasOwnProperty.call(p,d)&&(o[d]=p[d])}}function T(o){var u=1;o=o.split(":");let d=[];for(;0<u&&o.length;)d.push(o.shift()),u--;return o.length&&d.push(o.join(":")),d}function b(o){c.setTimeout(()=>{throw o},0)}function y(){var o=nc;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class wt{constructor(){this.h=this.g=null}add(u,d){let p=Br.get();p.set(u,d),this.h?this.h.next=p:this.g=p,this.h=p}}var Br=new x(()=>new j_,o=>o.reset());class j_{constructor(){this.next=this.g=this.h=null}set(u,d){this.h=u,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let qr,zr=!1,nc=new wt,yf=()=>{let o=c.Promise.resolve(void 0);qr=()=>{o.then($_)}};var $_=()=>{for(var o;o=y();){try{o.h.call(o.g)}catch(d){b(d)}var u=Br;u.j(o),100>u.h&&(u.h++,o.next=u.g,u.g=o)}zr=!1};function Ut(){this.s=this.s,this.C=this.C}Ut.prototype.s=!1,Ut.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ut.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function De(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}De.prototype.h=function(){this.defaultPrevented=!0};var B_=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let d=()=>{};c.addEventListener("test",d,u),c.removeEventListener("test",d,u)}catch{}return o}();function Gr(o,u){if(De.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var d=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget){if(_e){e:{try{K(u.nodeName);var A=!0;break e}catch{}A=!1}A||(u=null)}}else d=="mouseover"?u=o.fromElement:d=="mouseout"&&(u=o.toElement);this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:q_[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Gr.aa.h.call(this)}}N(Gr,De);var q_={2:"touch",3:"pen",4:"mouse"};Gr.prototype.h=function(){Gr.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Wr="closure_listenable_"+(1e6*Math.random()|0),z_=0;function G_(o,u,d,p,A){this.listener=o,this.proxy=null,this.src=u,this.type=d,this.capture=!!p,this.ha=A,this.key=++z_,this.da=this.fa=!1}function Ds(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Ns(o){this.src=o,this.g={},this.h=0}Ns.prototype.add=function(o,u,d,p,A){var S=o.toString();o=this.g[S],o||(o=this.g[S]=[],this.h++);var k=ic(o,u,p,A);return-1<k?(u=o[k],d||(u.fa=!1)):(u=new G_(u,this.src,S,!!p,A),u.fa=d,o.push(u)),u};function rc(o,u){var d=u.type;if(d in o.g){var p=o.g[d],A=Array.prototype.indexOf.call(p,u,void 0),S;(S=0<=A)&&Array.prototype.splice.call(p,A,1),S&&(Ds(u),o.g[d].length==0&&(delete o.g[d],o.h--))}}function ic(o,u,d,p){for(var A=0;A<o.length;++A){var S=o[A];if(!S.da&&S.listener==u&&S.capture==!!d&&S.ha==p)return A}return-1}var sc="closure_lm_"+(1e6*Math.random()|0),oc={};function vf(o,u,d,p,A){if(p&&p.once)return If(o,u,d,p,A);if(Array.isArray(u)){for(var S=0;S<u.length;S++)vf(o,u[S],d,p,A);return null}return d=lc(d),o&&o[Wr]?o.K(u,d,h(p)?!!p.capture:!!p,A):_f(o,u,d,!1,p,A)}function _f(o,u,d,p,A,S){if(!u)throw Error("Invalid event type");var k=h(A)?!!A.capture:!!A,oe=cc(o);if(oe||(o[sc]=oe=new Ns(o)),d=oe.add(u,d,p,k,S),d.proxy)return d;if(p=W_(),d.proxy=p,p.src=o,p.listener=d,o.addEventListener)B_||(A=k),A===void 0&&(A=!1),o.addEventListener(u.toString(),p,A);else if(o.attachEvent)o.attachEvent(Ef(u.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function W_(){function o(d){return u.call(o.src,o.listener,d)}let u=K_;return o}function If(o,u,d,p,A){if(Array.isArray(u)){for(var S=0;S<u.length;S++)If(o,u[S],d,p,A);return null}return d=lc(d),o&&o[Wr]?o.L(u,d,h(p)?!!p.capture:!!p,A):_f(o,u,d,!0,p,A)}function wf(o,u,d,p,A){if(Array.isArray(u))for(var S=0;S<u.length;S++)wf(o,u[S],d,p,A);else p=h(p)?!!p.capture:!!p,d=lc(d),o&&o[Wr]?(o=o.i,u=String(u).toString(),u in o.g&&(S=o.g[u],d=ic(S,d,p,A),-1<d&&(Ds(S[d]),Array.prototype.splice.call(S,d,1),S.length==0&&(delete o.g[u],o.h--)))):o&&(o=cc(o))&&(u=o.g[u.toString()],o=-1,u&&(o=ic(u,d,p,A)),(d=-1<o?u[o]:null)&&ac(d))}function ac(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Wr])rc(u.i,o);else{var d=o.type,p=o.proxy;u.removeEventListener?u.removeEventListener(d,p,o.capture):u.detachEvent?u.detachEvent(Ef(d),p):u.addListener&&u.removeListener&&u.removeListener(p),(d=cc(u))?(rc(d,o),d.h==0&&(d.src=null,u[sc]=null)):Ds(o)}}}function Ef(o){return o in oc?oc[o]:oc[o]="on"+o}function K_(o,u){if(o.da)o=!0;else{u=new Gr(u,this);var d=o.listener,p=o.ha||o.src;o.fa&&ac(o),o=d.call(p,u)}return o}function cc(o){return o=o[sc],o instanceof Ns?o:null}var uc="__closure_events_fn_"+(1e9*Math.random()>>>0);function lc(o){return typeof o=="function"?o:(o[uc]||(o[uc]=function(u){return o.handleEvent(u)}),o[uc])}function Ne(){Ut.call(this),this.i=new Ns(this),this.M=this,this.F=null}N(Ne,Ut),Ne.prototype[Wr]=!0,Ne.prototype.removeEventListener=function(o,u,d,p){wf(this,o,u,d,p)};function Ve(o,u){var d,p=o.F;if(p)for(d=[];p;p=p.F)d.push(p);if(o=o.M,p=u.type||u,typeof u=="string")u=new De(u,o);else if(u instanceof De)u.target=u.target||o;else{var A=u;u=new De(p,o),w(u,A)}if(A=!0,d)for(var S=d.length-1;0<=S;S--){var k=u.g=d[S];A=ks(k,p,!0,u)&&A}if(k=u.g=o,A=ks(k,p,!0,u)&&A,A=ks(k,p,!1,u)&&A,d)for(S=0;S<d.length;S++)k=u.g=d[S],A=ks(k,p,!1,u)&&A}Ne.prototype.N=function(){if(Ne.aa.N.call(this),this.i){var o=this.i,u;for(u in o.g){for(var d=o.g[u],p=0;p<d.length;p++)Ds(d[p]);delete o.g[u],o.h--}}this.F=null},Ne.prototype.K=function(o,u,d,p){return this.i.add(String(o),u,!1,d,p)},Ne.prototype.L=function(o,u,d,p){return this.i.add(String(o),u,!0,d,p)};function ks(o,u,d,p){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();for(var A=!0,S=0;S<u.length;++S){var k=u[S];if(k&&!k.da&&k.capture==d){var oe=k.listener,Se=k.ha||k.src;k.fa&&rc(o.i,k),A=oe.call(Se,p)!==!1&&A}}return A&&!p.defaultPrevented}function Tf(o,u,d){if(typeof o=="function")d&&(o=I(o,d));else if(o&&typeof o.handleEvent=="function")o=I(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(o,u||0)}function Af(o){o.g=Tf(()=>{o.g=null,o.i&&(o.i=!1,Af(o))},o.l);let u=o.h;o.h=null,o.m.apply(null,u)}class H_ extends Ut{constructor(u,d){super(),this.m=u,this.l=d,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:Af(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Kr(o){Ut.call(this),this.h=o,this.g={}}N(Kr,Ut);var bf=[];function Sf(o){ne(o.g,function(u,d){this.g.hasOwnProperty(d)&&ac(u)},o),o.g={}}Kr.prototype.N=function(){Kr.aa.N.call(this),Sf(this)},Kr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hc=c.JSON.stringify,Q_=c.JSON.parse,J_=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function dc(){}dc.prototype.h=null;function Rf(o){return o.h||(o.h=o.i())}function Cf(){}var Hr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fc(){De.call(this,"d")}N(fc,De);function pc(){De.call(this,"c")}N(pc,De);var mn={},Pf=null;function Os(){return Pf=Pf||new Ne}mn.La="serverreachability";function Df(o){De.call(this,mn.La,o)}N(Df,De);function Qr(o){let u=Os();Ve(u,new Df(u))}mn.STAT_EVENT="statevent";function Nf(o,u){De.call(this,mn.STAT_EVENT,o),this.stat=u}N(Nf,De);function Fe(o){let u=Os();Ve(u,new Nf(u,o))}mn.Ma="timingevent";function kf(o,u){De.call(this,mn.Ma,o),this.size=u}N(kf,De);function Jr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},u)}function Yr(){this.g=!0}Yr.prototype.xa=function(){this.g=!1};function Y_(o,u,d,p,A,S){o.info(function(){if(o.g)if(S)for(var k="",oe=S.split("&"),Se=0;Se<oe.length;Se++){var te=oe[Se].split("=");if(1<te.length){var ke=te[0];te=te[1];var Oe=ke.split("_");k=2<=Oe.length&&Oe[1]=="type"?k+(ke+"="+te+"&"):k+(ke+"=redacted&")}}else k=null;else k=S;return"XMLHTTP REQ ("+p+") [attempt "+A+"]: "+u+`
`+d+`
`+k})}function X_(o,u,d,p,A,S,k){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+A+"]: "+u+`
`+d+`
`+S+" "+k})}function Wn(o,u,d,p){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+eI(o,d)+(p?" "+p:"")})}function Z_(o,u){o.info(function(){return"TIMEOUT: "+u})}Yr.prototype.info=function(){};function eI(o,u){if(!o.g)return u;if(!u)return null;try{var d=JSON.parse(u);if(d){for(o=0;o<d.length;o++)if(Array.isArray(d[o])){var p=d[o];if(!(2>p.length)){var A=p[1];if(Array.isArray(A)&&!(1>A.length)){var S=A[0];if(S!="noop"&&S!="stop"&&S!="close")for(var k=1;k<A.length;k++)A[k]=""}}}}return hc(d)}catch{return u}}var xs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Of={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},mc;function Ms(){}N(Ms,dc),Ms.prototype.g=function(){return new XMLHttpRequest},Ms.prototype.i=function(){return{}},mc=new Ms;function jt(o,u,d,p){this.j=o,this.i=u,this.l=d,this.R=p||1,this.U=new Kr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new xf}function xf(){this.i=null,this.g="",this.h=!1}var Mf={},gc={};function yc(o,u,d){o.L=1,o.v=Us(Et(u)),o.m=d,o.P=!0,Lf(o,null)}function Lf(o,u){o.F=Date.now(),Ls(o),o.A=Et(o.v);var d=o.A,p=o.R;Array.isArray(p)||(p=[String(p)]),Jf(d.i,"t",p),o.C=0,d=o.j.J,o.h=new xf,o.g=pp(o.j,d?u:null,!o.m),0<o.O&&(o.M=new H_(I(o.Y,o,o.g),o.O)),u=o.U,d=o.g,p=o.ca;var A="readystatechange";Array.isArray(A)||(A&&(bf[0]=A.toString()),A=bf);for(var S=0;S<A.length;S++){var k=vf(d,A[S],p||u.handleEvent,!1,u.h||u);if(!k)break;u.g[k.key]=k}u=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,u)):(o.u="GET",o.g.ea(o.A,o.u,null,u)),Qr(),Y_(o.i,o.u,o.A,o.l,o.R,o.m)}jt.prototype.ca=function(o){o=o.target;let u=this.M;u&&Tt(o)==3?u.j():this.Y(o)},jt.prototype.Y=function(o){try{if(o==this.g)e:{let Oe=Tt(this.g);var u=this.g.Ba();let Qn=this.g.Z();if(!(3>Oe)&&(Oe!=3||this.g&&(this.h.h||this.g.oa()||rp(this.g)))){this.J||Oe!=4||u==7||(u==8||0>=Qn?Qr(3):Qr(2)),vc(this);var d=this.g.Z();this.X=d;t:if(Vf(this)){var p=rp(this.g);o="";var A=p.length,S=Tt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){gn(this),Xr(this);var k="";break t}this.h.i=new c.TextDecoder}for(u=0;u<A;u++)this.h.h=!0,o+=this.h.i.decode(p[u],{stream:!(S&&u==A-1)});p.length=0,this.h.g+=o,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=d==200,X_(this.i,this.u,this.A,this.l,this.R,Oe,d),this.o){if(this.T&&!this.K){t:{if(this.g){var oe,Se=this.g;if((oe=Se.g?Se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(oe)){var te=oe;break t}}te=null}if(d=te)Wn(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,_c(this,d);else{this.o=!1,this.s=3,Fe(12),gn(this),Xr(this);break e}}if(this.P){d=!0;let et;for(;!this.J&&this.C<k.length;)if(et=tI(this,k),et==gc){Oe==4&&(this.s=4,Fe(14),d=!1),Wn(this.i,this.l,null,"[Incomplete Response]");break}else if(et==Mf){this.s=4,Fe(15),Wn(this.i,this.l,k,"[Invalid Chunk]"),d=!1;break}else Wn(this.i,this.l,et,null),_c(this,et);if(Vf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Oe!=4||k.length!=0||this.h.h||(this.s=1,Fe(16),d=!1),this.o=this.o&&d,!d)Wn(this.i,this.l,k,"[Invalid Chunked Response]"),gn(this),Xr(this);else if(0<k.length&&!this.W){this.W=!0;var ke=this.j;ke.g==this&&ke.ba&&!ke.M&&(ke.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),bc(ke),ke.M=!0,Fe(11))}}else Wn(this.i,this.l,k,null),_c(this,k);Oe==4&&gn(this),this.o&&!this.J&&(Oe==4?lp(this.j,this):(this.o=!1,Ls(this)))}else vI(this.g),d==400&&0<k.indexOf("Unknown SID")?(this.s=3,Fe(12)):(this.s=0,Fe(13)),gn(this),Xr(this)}}}catch{}finally{}};function Vf(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function tI(o,u){var d=o.C,p=u.indexOf(`
`,d);return p==-1?gc:(d=Number(u.substring(d,p)),isNaN(d)?Mf:(p+=1,p+d>u.length?gc:(u=u.slice(p,p+d),o.C=p+d,u)))}jt.prototype.cancel=function(){this.J=!0,gn(this)};function Ls(o){o.S=Date.now()+o.I,Ff(o,o.I)}function Ff(o,u){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Jr(I(o.ba,o),u)}function vc(o){o.B&&(c.clearTimeout(o.B),o.B=null)}jt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(Z_(this.i,this.A),this.L!=2&&(Qr(),Fe(17)),gn(this),this.s=2,Xr(this)):Ff(this,this.S-o)};function Xr(o){o.j.G==0||o.J||lp(o.j,o)}function gn(o){vc(o);var u=o.M;u&&typeof u.ma=="function"&&u.ma(),o.M=null,Sf(o.U),o.g&&(u=o.g,o.g=null,u.abort(),u.ma())}function _c(o,u){try{var d=o.j;if(d.G!=0&&(d.g==o||Ic(d.h,o))){if(!o.K&&Ic(d.h,o)&&d.G==3){try{var p=d.Da.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var A=p;if(A[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<o.F)zs(d),Bs(d);else break e;Ac(d),Fe(18)}}else d.za=A[1],0<d.za-d.T&&37500>A[2]&&d.F&&d.v==0&&!d.C&&(d.C=Jr(I(d.Za,d),6e3));if(1>=$f(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else vn(d,11)}else if((o.K||d.g==o)&&zs(d),!q(u))for(A=d.Da.g.parse(u),u=0;u<A.length;u++){let te=A[u];if(d.T=te[0],te=te[1],d.G==2)if(te[0]=="c"){d.K=te[1],d.ia=te[2];let ke=te[3];ke!=null&&(d.la=ke,d.j.info("VER="+d.la));let Oe=te[4];Oe!=null&&(d.Aa=Oe,d.j.info("SVER="+d.Aa));let Qn=te[5];Qn!=null&&typeof Qn=="number"&&0<Qn&&(p=1.5*Qn,d.L=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;let et=o.g;if(et){let Ws=et.g?et.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ws){var S=p.h;S.g||Ws.indexOf("spdy")==-1&&Ws.indexOf("quic")==-1&&Ws.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(wc(S,S.h),S.h=null))}if(p.D){let Sc=et.g?et.g.getResponseHeader("X-HTTP-Session-Id"):null;Sc&&(p.ya=Sc,ce(p.I,p.D,Sc))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-o.F,d.j.info("Handshake RTT: "+d.R+"ms")),p=d;var k=o;if(p.qa=fp(p,p.J?p.ia:null,p.W),k.K){Bf(p.h,k);var oe=k,Se=p.L;Se&&(oe.I=Se),oe.B&&(vc(oe),Ls(oe)),p.g=k}else cp(p);0<d.i.length&&qs(d)}else te[0]!="stop"&&te[0]!="close"||vn(d,7);else d.G==3&&(te[0]=="stop"||te[0]=="close"?te[0]=="stop"?vn(d,7):Tc(d):te[0]!="noop"&&d.l&&d.l.ta(te),d.v=0)}}Qr(4)}catch{}}var nI=class{constructor(o,u){this.g=o,this.map=u}};function Uf(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function jf(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function $f(o){return o.h?1:o.g?o.g.size:0}function Ic(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function wc(o,u){o.g?o.g.add(u):o.h=u}function Bf(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Uf.prototype.cancel=function(){if(this.i=qf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function qf(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let u=o.i;for(let d of o.g.values())u=u.concat(d.D);return u}return O(o.i)}function rI(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var u=[],d=o.length,p=0;p<d;p++)u.push(o[p]);return u}u=[],d=0;for(p in o)u[d++]=o[p];return u}function iI(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var u=[];o=o.length;for(var d=0;d<o;d++)u.push(d);return u}u=[],d=0;for(let p in o)u[d++]=p;return u}}}function zf(o,u){if(o.forEach&&typeof o.forEach=="function")o.forEach(u,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,u,void 0);else for(var d=iI(o),p=rI(o),A=p.length,S=0;S<A;S++)u.call(void 0,p[S],d&&d[S],o)}var Gf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sI(o,u){if(o){o=o.split("&");for(var d=0;d<o.length;d++){var p=o[d].indexOf("="),A=null;if(0<=p){var S=o[d].substring(0,p);A=o[d].substring(p+1)}else S=o[d];u(S,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function yn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof yn){this.h=o.h,Vs(this,o.j),this.o=o.o,this.g=o.g,Fs(this,o.s),this.l=o.l;var u=o.i,d=new ti;d.i=u.i,u.g&&(d.g=new Map(u.g),d.h=u.h),Wf(this,d),this.m=o.m}else o&&(u=String(o).match(Gf))?(this.h=!1,Vs(this,u[1]||"",!0),this.o=Zr(u[2]||""),this.g=Zr(u[3]||"",!0),Fs(this,u[4]),this.l=Zr(u[5]||"",!0),Wf(this,u[6]||"",!0),this.m=Zr(u[7]||"")):(this.h=!1,this.i=new ti(null,this.h))}yn.prototype.toString=function(){var o=[],u=this.j;u&&o.push(ei(u,Kf,!0),":");var d=this.g;return(d||u=="file")&&(o.push("//"),(u=this.o)&&o.push(ei(u,Kf,!0),"@"),o.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&o.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&o.push("/"),o.push(ei(d,d.charAt(0)=="/"?cI:aI,!0))),(d=this.i.toString())&&o.push("?",d),(d=this.m)&&o.push("#",ei(d,lI)),o.join("")};function Et(o){return new yn(o)}function Vs(o,u,d){o.j=d?Zr(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function Fs(o,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);o.s=u}else o.s=null}function Wf(o,u,d){u instanceof ti?(o.i=u,hI(o.i,o.h)):(d||(u=ei(u,uI)),o.i=new ti(u,o.h))}function ce(o,u,d){o.i.set(u,d)}function Us(o){return ce(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Zr(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function ei(o,u,d){return typeof o=="string"?(o=encodeURI(o).replace(u,oI),d&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function oI(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Kf=/[#\/\?@]/g,aI=/[#\?:]/g,cI=/[#\?]/g,uI=/[#\?@]/g,lI=/#/g;function ti(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function $t(o){o.g||(o.g=new Map,o.h=0,o.i&&sI(o.i,function(u,d){o.add(decodeURIComponent(u.replace(/\+/g," ")),d)}))}n=ti.prototype,n.add=function(o,u){$t(this),this.i=null,o=Kn(this,o);var d=this.g.get(o);return d||this.g.set(o,d=[]),d.push(u),this.h+=1,this};function Hf(o,u){$t(o),u=Kn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Qf(o,u){return $t(o),u=Kn(o,u),o.g.has(u)}n.forEach=function(o,u){$t(this),this.g.forEach(function(d,p){d.forEach(function(A){o.call(u,A,p,this)},this)},this)},n.na=function(){$t(this);let o=Array.from(this.g.values()),u=Array.from(this.g.keys()),d=[];for(let p=0;p<u.length;p++){let A=o[p];for(let S=0;S<A.length;S++)d.push(u[p])}return d},n.V=function(o){$t(this);let u=[];if(typeof o=="string")Qf(this,o)&&(u=u.concat(this.g.get(Kn(this,o))));else{o=Array.from(this.g.values());for(let d=0;d<o.length;d++)u=u.concat(o[d])}return u},n.set=function(o,u){return $t(this),this.i=null,o=Kn(this,o),Qf(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=this.V(o),0<o.length?String(o[0]):u):u};function Jf(o,u,d){Hf(o,u),0<d.length&&(o.i=null,o.g.set(Kn(o,u),O(d)),o.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],u=Array.from(this.g.keys());for(var d=0;d<u.length;d++){var p=u[d];let S=encodeURIComponent(String(p)),k=this.V(p);for(p=0;p<k.length;p++){var A=S;k[p]!==""&&(A+="="+encodeURIComponent(String(k[p]))),o.push(A)}}return this.i=o.join("&")};function Kn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function hI(o,u){u&&!o.j&&($t(o),o.i=null,o.g.forEach(function(d,p){var A=p.toLowerCase();p!=A&&(Hf(this,p),Jf(this,A,d))},o)),o.j=u}function dI(o,u){let d=new Yr;if(c.Image){let p=new Image;p.onload=R(Bt,d,"TestLoadImage: loaded",!0,u,p),p.onerror=R(Bt,d,"TestLoadImage: error",!1,u,p),p.onabort=R(Bt,d,"TestLoadImage: abort",!1,u,p),p.ontimeout=R(Bt,d,"TestLoadImage: timeout",!1,u,p),c.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else u(!1)}function fI(o,u){let d=new Yr,p=new AbortController,A=setTimeout(()=>{p.abort(),Bt(d,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:p.signal}).then(S=>{clearTimeout(A),S.ok?Bt(d,"TestPingServer: ok",!0,u):Bt(d,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(A),Bt(d,"TestPingServer: error",!1,u)})}function Bt(o,u,d,p,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),p(d)}catch{}}function pI(){this.g=new J_}function mI(o,u,d){let p=d||"";try{zf(o,function(A,S){let k=A;h(A)&&(k=hc(A)),u.push(p+S+"="+encodeURIComponent(k))})}catch(A){throw u.push(p+"type="+encodeURIComponent("_badmap")),A}}function ni(o){this.l=o.Ub||null,this.j=o.eb||!1}N(ni,dc),ni.prototype.g=function(){return new js(this.l,this.j)},ni.prototype.i=function(o){return function(){return o}}({});function js(o,u){Ne.call(this),this.D=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(js,Ne),n=js.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=u,this.readyState=1,ii(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(u.body=o),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ri(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,ii(this)),this.g&&(this.readyState=3,ii(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Yf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Yf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?ri(this):ii(this),this.readyState==3&&Yf(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,ri(this))},n.Qa=function(o){this.g&&(this.response=o,ri(this))},n.ga=function(){this.g&&ri(this)};function ri(o){o.readyState=4,o.l=null,o.j=null,o.v=null,ii(o)}n.setRequestHeader=function(o,u){this.u.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],u=this.h.entries();for(var d=u.next();!d.done;)d=d.value,o.push(d[0]+": "+d[1]),d=u.next();return o.join(`\r
`)};function ii(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(js.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Xf(o){let u="";return ne(o,function(d,p){u+=p,u+=":",u+=d,u+=`\r
`}),u}function Ec(o,u,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=Xf(d),typeof o=="string"?d!=null&&encodeURIComponent(String(d)):ce(o,u,d))}function he(o){Ne.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(he,Ne);var gI=/^https?$/i,yI=["POST","PUT"];n=he.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,u,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():mc.g(),this.v=this.o?Rf(this.o):Rf(mc),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(S){Zf(this,S);return}if(o=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var A in p)d.set(A,p[A]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let S of p.keys())d.set(S,p.get(S));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),A=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(yI,u,void 0))||p||A||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,k]of d)this.g.setRequestHeader(S,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{np(this),this.u=!0,this.g.send(o),this.u=!1}catch(S){Zf(this,S)}};function Zf(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.m=5,ep(o),$s(o)}function ep(o){o.A||(o.A=!0,Ve(o,"complete"),Ve(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ve(this,"complete"),Ve(this,"abort"),$s(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$s(this,!0)),he.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?tp(this):this.bb())},n.bb=function(){tp(this)};function tp(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Tt(o)!=4||o.Z()!=2)){if(o.u&&Tt(o)==4)Tf(o.Ea,0,o);else if(Ve(o,"readystatechange"),Tt(o)==4){o.h=!1;try{let k=o.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var d;if(!(d=u)){var p;if(p=k===0){var A=String(o.D).match(Gf)[1]||null;!A&&c.self&&c.self.location&&(A=c.self.location.protocol.slice(0,-1)),p=!gI.test(A?A.toLowerCase():"")}d=p}if(d)Ve(o,"complete"),Ve(o,"success");else{o.m=6;try{var S=2<Tt(o)?o.g.statusText:""}catch{S=""}o.l=S+" ["+o.Z()+"]",ep(o)}}finally{$s(o)}}}}function $s(o,u){if(o.g){np(o);let d=o.g,p=o.v[0]?()=>{}:null;o.g=null,o.v=null,u||Ve(o,"ready");try{d.onreadystatechange=p}catch{}}}function np(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function Tt(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<Tt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),Q_(u)}};function rp(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function vI(o){let u={};o=(o.g&&2<=Tt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(q(o[p]))continue;var d=T(o[p]);let A=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let S=u[A]||[];u[A]=S,S.push(d)}E(u,function(p){return p.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function si(o,u,d){return d&&d.internalChannelParams&&d.internalChannelParams[o]||u}function ip(o){this.Aa=0,this.i=[],this.j=new Yr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=si("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=si("baseRetryDelayMs",5e3,o),this.cb=si("retryDelaySeedMs",1e4,o),this.Wa=si("forwardChannelMaxRetries",2,o),this.wa=si("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Uf(o&&o.concurrentRequestLimit),this.Da=new pI,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ip.prototype,n.la=8,n.G=1,n.connect=function(o,u,d,p){Fe(0),this.W=o,this.H=u||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.I=fp(this,null,this.W),qs(this)};function Tc(o){if(sp(o),o.G==3){var u=o.U++,d=Et(o.I);if(ce(d,"SID",o.K),ce(d,"RID",u),ce(d,"TYPE","terminate"),oi(o,d),u=new jt(o,o.j,u),u.L=2,u.v=Us(Et(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=u.v,d=!0),d||(u.g=pp(u.j,null),u.g.ea(u.v)),u.F=Date.now(),Ls(u)}dp(o)}function Bs(o){o.g&&(bc(o),o.g.cancel(),o.g=null)}function sp(o){Bs(o),o.u&&(c.clearTimeout(o.u),o.u=null),zs(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function qs(o){if(!jf(o.h)&&!o.s){o.s=!0;var u=o.Ga;qr||yf(),zr||(qr(),zr=!0),nc.add(u,o),o.B=0}}function _I(o,u){return $f(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=u.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Jr(I(o.Ga,o,u),hp(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let A=new jt(this,this.j,o),S=this.o;if(this.S&&(S?(S=m(S),w(S,this.S)):S=this.S),this.m!==null||this.O||(A.H=S,S=null),this.P)e:{for(var u=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,4096<u){u=d;break e}if(u===4096||d===this.i.length-1){u=d+1;break e}}u=1e3}else u=1e3;u=ap(this,A,u),d=Et(this.I),ce(d,"RID",o),ce(d,"CVER",22),this.D&&ce(d,"X-HTTP-Session-Id",this.D),oi(this,d),S&&(this.O?u="headers="+encodeURIComponent(String(Xf(S)))+"&"+u:this.m&&Ec(d,this.m,S)),wc(this.h,A),this.Ua&&ce(d,"TYPE","init"),this.P?(ce(d,"$req",u),ce(d,"SID","null"),A.T=!0,yc(A,d,null)):yc(A,d,u),this.G=2}}else this.G==3&&(o?op(this,o):this.i.length==0||jf(this.h)||op(this))};function op(o,u){var d;u?d=u.l:d=o.U++;let p=Et(o.I);ce(p,"SID",o.K),ce(p,"RID",d),ce(p,"AID",o.T),oi(o,p),o.m&&o.o&&Ec(p,o.m,o.o),d=new jt(o,o.j,d,o.B+1),o.m===null&&(d.H=o.o),u&&(o.i=u.D.concat(o.i)),u=ap(o,d,1e3),d.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),wc(o.h,d),yc(d,p,u)}function oi(o,u){o.H&&ne(o.H,function(d,p){ce(u,p,d)}),o.l&&zf({},function(d,p){ce(u,p,d)})}function ap(o,u,d){d=Math.min(o.i.length,d);var p=o.l?I(o.l.Na,o.l,o):null;e:{var A=o.i;let S=-1;for(;;){let k=["count="+d];S==-1?0<d?(S=A[0].g,k.push("ofs="+S)):S=0:k.push("ofs="+S);let oe=!0;for(let Se=0;Se<d;Se++){let te=A[Se].g,ke=A[Se].map;if(te-=S,0>te)S=Math.max(0,A[Se].g-100),oe=!1;else try{mI(ke,k,"req"+te+"_")}catch{p&&p(ke)}}if(oe){p=k.join("&");break e}}}return o=o.i.splice(0,d),u.D=o,p}function cp(o){if(!o.g&&!o.u){o.Y=1;var u=o.Fa;qr||yf(),zr||(qr(),zr=!0),nc.add(u,o),o.v=0}}function Ac(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Jr(I(o.Fa,o),hp(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,up(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Jr(I(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Fe(10),Bs(this),up(this))};function bc(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function up(o){o.g=new jt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var u=Et(o.qa);ce(u,"RID","rpc"),ce(u,"SID",o.K),ce(u,"AID",o.T),ce(u,"CI",o.F?"0":"1"),!o.F&&o.ja&&ce(u,"TO",o.ja),ce(u,"TYPE","xmlhttp"),oi(o,u),o.m&&o.o&&Ec(u,o.m,o.o),o.L&&(o.g.I=o.L);var d=o.g;o=o.ia,d.L=1,d.v=Us(Et(u)),d.m=null,d.P=!0,Lf(d,o)}n.Za=function(){this.C!=null&&(this.C=null,Bs(this),Ac(this),Fe(19))};function zs(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function lp(o,u){var d=null;if(o.g==u){zs(o),bc(o),o.g=null;var p=2}else if(Ic(o.h,u))d=u.D,Bf(o.h,u),p=1;else return;if(o.G!=0){if(u.o)if(p==1){d=u.m?u.m.length:0,u=Date.now()-u.F;var A=o.B;p=Os(),Ve(p,new kf(p,d)),qs(o)}else cp(o);else if(A=u.s,A==3||A==0&&0<u.X||!(p==1&&_I(o,u)||p==2&&Ac(o)))switch(d&&0<d.length&&(u=o.h,u.i=u.i.concat(d)),A){case 1:vn(o,5);break;case 4:vn(o,10);break;case 3:vn(o,6);break;default:vn(o,2)}}}function hp(o,u){let d=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(d*=2),d*u}function vn(o,u){if(o.j.info("Error code "+u),u==2){var d=I(o.fb,o),p=o.Xa;let A=!p;p=new yn(p||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Vs(p,"https"),Us(p),A?dI(p.toString(),d):fI(p.toString(),d)}else Fe(2);o.G=0,o.l&&o.l.sa(u),dp(o),sp(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Fe(2)):(this.j.info("Failed to ping google.com"),Fe(1))};function dp(o){if(o.G=0,o.ka=[],o.l){let u=qf(o.h);(u.length!=0||o.i.length!=0)&&(C(o.ka,u),C(o.ka,o.i),o.h.i.length=0,O(o.i),o.i.length=0),o.l.ra()}}function fp(o,u,d){var p=d instanceof yn?Et(d):new yn(d);if(p.g!="")u&&(p.g=u+"."+p.g),Fs(p,p.s);else{var A=c.location;p=A.protocol,u=u?u+"."+A.hostname:A.hostname,A=+A.port;var S=new yn(null);p&&Vs(S,p),u&&(S.g=u),A&&Fs(S,A),d&&(S.l=d),p=S}return d=o.D,u=o.ya,d&&u&&ce(p,d,u),ce(p,"VER",o.la),oi(o,p),p}function pp(o,u,d){if(u&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Ca&&!o.pa?new he(new ni({eb:d})):new he(o.pa),u.Ha(o.J),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function mp(){}n=mp.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Gs(){}Gs.prototype.g=function(o,u){return new Be(o,u)};function Be(o,u){Ne.call(this),this.g=new ip(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(o?o["X-WebChannel-Client-Profile"]=u.va:o={"X-WebChannel-Client-Profile":u.va}),this.g.S=o,(o=u&&u.Sb)&&!q(o)&&(this.g.m=o),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!q(u)&&(this.g.D=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Hn(this)}N(Be,Ne),Be.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Be.prototype.close=function(){Tc(this.g)},Be.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var d={};d.__data__=o,o=d}else this.u&&(d={},d.__data__=hc(o),o=d);u.i.push(new nI(u.Ya++,o)),u.G==3&&qs(u)},Be.prototype.N=function(){this.g.l=null,delete this.j,Tc(this.g),delete this.g,Be.aa.N.call(this)};function gp(o){fc.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(let d in u){o=d;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}N(gp,fc);function yp(){pc.call(this),this.status=1}N(yp,pc);function Hn(o){this.g=o}N(Hn,mp),Hn.prototype.ua=function(){Ve(this.g,"a")},Hn.prototype.ta=function(o){Ve(this.g,new gp(o))},Hn.prototype.sa=function(o){Ve(this.g,new yp)},Hn.prototype.ra=function(){Ve(this.g,"b")},Gs.prototype.createWebChannel=Gs.prototype.g,Be.prototype.send=Be.prototype.o,Be.prototype.open=Be.prototype.m,Be.prototype.close=Be.prototype.close,ch=Ot.createWebChannelTransport=function(){return new Gs},ah=Ot.getStatEventTarget=function(){return Os()},oh=Ot.Event=mn,aa=Ot.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},xs.NO_ERROR=0,xs.TIMEOUT=8,xs.HTTP_ERROR=6,os=Ot.ErrorCode=xs,Of.COMPLETE="complete",sh=Ot.EventType=Of,Cf.EventType=Hr,Hr.OPEN="a",Hr.CLOSE="b",Hr.ERROR="c",Hr.MESSAGE="d",Ne.prototype.listen=Ne.prototype.K,_r=Ot.WebChannel=Cf,ih=Ot.FetchXmlHttpFactory=ni,he.prototype.listenOnce=he.prototype.L,he.prototype.getLastError=he.prototype.Ka,he.prototype.getLastErrorCode=he.prototype.Ba,he.prototype.getStatus=he.prototype.Z,he.prototype.getResponseJson=he.prototype.Oa,he.prototype.getResponseText=he.prototype.oa,he.prototype.send=he.prototype.ea,he.prototype.setWithCredentials=he.prototype.Ha,rh=Ot.XhrIo=he}).apply(typeof oa<"u"?oa:typeof self<"u"?self:typeof window<"u"?window:{});var qy="@firebase/firestore";var be=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};be.UNAUTHENTICATED=new be(null),be.GOOGLE_CREDENTIALS=new be("google-credentials-uid"),be.FIRST_PARTY=new be("first-party-uid"),be.MOCK_USER=new be("mock-user");var jr="10.12.1";var Vn=new tn("@firebase/firestore");function as(){return Vn.logLevel}function L(n,...e){if(Vn.logLevel<=J.DEBUG){let t=e.map(Kd);Vn.debug(`Firestore (${jr}): ${n}`,...t)}}function Mt(n,...e){if(Vn.logLevel<=J.ERROR){let t=e.map(Kd);Vn.error(`Firestore (${jr}): ${n}`,...t)}}function Sr(n,...e){if(Vn.logLevel<=J.WARN){let t=e.map(Kd);Vn.warn(`Firestore (${jr}): ${n}`,...t)}}function Kd(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function B(n="Unexpected state"){let e=`FIRESTORE (${jr}) INTERNAL ASSERTION FAILED: `+n;throw Mt(e),new Error(e)}function ae(n,e){n||B()}function z(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends Ke{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var mt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var da=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},fh=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(be.UNAUTHENTICATED))}shutdown(){}},ph=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},mh=class{constructor(e){this.t=e,this.currentUser=be.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new mt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new mt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>_(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},c=l=>{L("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(L("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new mt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(L("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ae(typeof r.accessToken=="string"),new da(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ae(e===null||typeof e=="string"),new be(e)}},gh=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=be.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},yh=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new gh(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(be.FIRST_PARTY))}shutdown(){}invalidateToken(){}},vh=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},_h=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&L("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,L("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{L("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):L("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ae(typeof t.token=="string"),this.R=t.token,new vh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function gR(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var fa=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=gR(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function re(n,e){return n<e?-1:n>e?1:0}function Rr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Pe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?re(this.nanoseconds,e.nanoseconds):re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var G=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Pe(0,0))}static max(){return new n(new Pe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var pa=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(),r===void 0?r=e.length-t:r>e.length-t&&B(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},le=class n extends pa{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},yR=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Qe=class n extends pa{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return yR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new M(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new M(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(s(),i++)}if(s(),a)throw new M(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var U=class n{constructor(e){this.path=e}static fromPath(e){return new n(le.fromString(e))}static fromName(e){return new n(le.fromString(e).popFirst(5))}static empty(){return new n(le.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&le.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return le.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new le(e.slice()))}};var Ih=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Ih.UNKNOWN_ID=-1;function vR(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=G.fromTimestamp(r===1e9?new Pe(t+1,0):new Pe(t,r));return new Fn(i,U.empty(),e)}function _R(n){return new Fn(n.readTime,n.key,-1)}var Fn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(G.min(),U.empty(),-1)}static max(){return new n(G.max(),U.empty(),-1)}};function IR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=U.comparator(n.documentKey,e.documentKey),t!==0?t:re(n.largestBatchId,e.largestBatchId))}var wR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",wh=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function As(n){return _(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==wR)throw n;L("LocalStore","Unexpectedly lost primary lease")})}var D=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),c=0;for(let l=0;l<s;l++){let h=l;t(e[h]).next(f=>{a[h]=f,++c,c===s&&r(a)},f=>i(f))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function ER(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function bs(n){return n.name==="IndexedDbTransactionError"}var wv=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Wa(n){return n==null}function fs(n){return n===0&&1/n==-1/0}function TR(n){return typeof n=="number"&&Number.isInteger(n)&&!fs(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var AR=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],_N=[...AR,"documentOverlays"],bR=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],SR=bR,IN=[...SR,"indexConfiguration","indexState","indexEntries"];function zy(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function zn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Ev(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var fe=class n{constructor(e,t){this.comparator=e,this.root=t||gt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,gt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tr(this.root,e,this.comparator,!0)}},Tr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},gt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();let e=this.left.check();if(e!==this.right.check())throw B();return e+(this.isRed()?0:1)}};gt.EMPTY=null,gt.RED=!0,gt.BLACK=!1;gt.EMPTY=new class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(e,t,r,i,s){return this}insert(e,t,r){return new gt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Me=class n{constructor(e){this.comparator=e,this.data=new fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ma(this.data.getIterator())}getIteratorFrom(e){return new ma(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},ma=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ze=class n{constructor(e){this.fields=e,e.sort(Qe.comparator)}static empty(){return new n([])}unionWith(e){let t=new Me(Qe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Rr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var ga=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var je=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ga("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};je.EMPTY_BYTE_STRING=new je("");var RR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lt(n){if(ae(!!n),typeof n=="string"){let e=0,t=RR.exec(n);if(ae(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:de(n.seconds),nanos:de(n.nanos)}}function de(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function dn(n){return typeof n=="string"?je.fromBase64String(n):je.fromUint8Array(n)}function Hd(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Qd(n){let e=n.mapValue.fields.__previous_value__;return Hd(e)?Qd(e):e}function ps(n){let e=Lt(n.mapValue.fields.__local_write_time__.timestampValue);return new Pe(e.seconds,e.nanos)}var Eh=class{constructor(e,t,r,i,s,a,c,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h}},ya=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var ca={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Un(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Hd(n)?4:Tv(n)?9007199254740991:10:B()}function _t(n,e){if(n===e)return!0;let t=Un(n);if(t!==Un(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ps(n).isEqual(ps(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Lt(i.timestampValue),c=Lt(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return dn(i.bytesValue).isEqual(dn(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return de(i.geoPointValue.latitude)===de(s.geoPointValue.latitude)&&de(i.geoPointValue.longitude)===de(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return de(i.integerValue)===de(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=de(i.doubleValue),c=de(s.doubleValue);return a===c?fs(a)===fs(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return Rr(n.arrayValue.values||[],e.arrayValue.values||[],_t);case 10:return function(i,s){let a=i.mapValue.fields||{},c=s.mapValue.fields||{};if(zy(a)!==zy(c))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!_t(a[l],c[l])))return!1;return!0}(n,e);default:return B()}}function ms(n,e){return(n.values||[]).find(t=>_t(t,e))!==void 0}function Cr(n,e){if(n===e)return 0;let t=Un(n),r=Un(e);if(t!==r)return re(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return re(n.booleanValue,e.booleanValue);case 2:return function(s,a){let c=de(s.integerValue||s.doubleValue),l=de(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,e);case 3:return Gy(n.timestampValue,e.timestampValue);case 4:return Gy(ps(n),ps(e));case 5:return re(n.stringValue,e.stringValue);case 6:return function(s,a){let c=dn(s),l=dn(a);return c.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let c=s.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){let f=re(c[h],l[h]);if(f!==0)return f}return re(c.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let c=re(de(s.latitude),de(a.latitude));return c!==0?c:re(de(s.longitude),de(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){let c=s.values||[],l=a.values||[];for(let h=0;h<c.length&&h<l.length;++h){let f=Cr(c[h],l[h]);if(f)return f}return re(c.length,l.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===ca.mapValue&&a===ca.mapValue)return 0;if(s===ca.mapValue)return 1;if(a===ca.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),h=a.fields||{},f=Object.keys(h);l.sort(),f.sort();for(let g=0;g<l.length&&g<f.length;++g){let I=re(l[g],f[g]);if(I!==0)return I;let R=Cr(c[l[g]],h[f[g]]);if(R!==0)return R}return re(l.length,f.length)}(n.mapValue,e.mapValue);default:throw B()}}function Gy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return re(n,e);let t=Lt(n),r=Lt(e),i=re(t.seconds,r.seconds);return i!==0?i:re(t.nanos,r.nanos)}function Pr(n){return Th(n)}function Th(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Lt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return dn(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return U.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Th(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${Th(t.fields[a])}`;return i+"}"}(n.mapValue):B()}function Wy(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ah(n){return!!n&&"integerValue"in n}function Jd(n){return!!n&&"arrayValue"in n}function Ky(n){return!!n&&"nullValue"in n}function Hy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function la(n){return!!n&&"mapValue"in n}function us(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return zn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=us(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=us(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Tv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var He=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!la(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=us(t)}setAll(e){let t=Qe.emptyPath(),r={},i=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=c.popLast()}a?r[c.lastSegment()]=us(a):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());la(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return _t(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];la(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){zn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(us(this.value))}};function Av(n){let e=[];return zn(n.fields,(t,r)=>{let i=new Qe([t]);if(la(r)){let s=Av(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Ze(e)}var it=class n{constructor(e,t,r,i,s,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new n(e,0,G.min(),G.min(),G.min(),He.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,G.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,G.min(),G.min(),He.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,G.min(),G.min(),He.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(G.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=He.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=He.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=G.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Dr=class{constructor(e,t){this.position=e,this.inclusive=t}};function Qy(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=U.comparator(U.fromName(a.referenceValue),t.key):r=Cr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Jy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!_t(n.position[t],e.position[t]))return!1;return!0}var Nr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function CR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var va=class{},ve=class n extends va{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Sh(e,t,r):t==="array-contains"?new Ph(e,r):t==="in"?new Dh(e,r):t==="not-in"?new Nh(e,r):t==="array-contains-any"?new kh(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Rh(e,r):new Ch(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Cr(t,this.value)):t!==null&&Un(this.value)===Un(t)&&this.matchesComparison(Cr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},st=class n extends va{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return bv(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function bv(n){return n.op==="and"}function Sv(n){return PR(n)&&bv(n)}function PR(n){for(let e of n.filters)if(e instanceof st)return!1;return!0}function bh(n){if(n instanceof ve)return n.field.canonicalString()+n.op.toString()+Pr(n.value);if(Sv(n))return n.filters.map(e=>bh(e)).join(",");{let e=n.filters.map(t=>bh(t)).join(",");return`${n.op}(${e})`}}function Rv(n,e){return n instanceof ve?function(r,i){return i instanceof ve&&r.op===i.op&&r.field.isEqual(i.field)&&_t(r.value,i.value)}(n,e):n instanceof st?function(r,i){return i instanceof st&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,c)=>s&&Rv(a,i.filters[c]),!0):!1}(n,e):void B()}function Cv(n){return n instanceof ve?function(t){return`${t.field.canonicalString()} ${t.op} ${Pr(t.value)}`}(n):n instanceof st?function(t){return t.op.toString()+" {"+t.getFilters().map(Cv).join(" ,")+"}"}(n):"Filter"}var Sh=class extends ve{constructor(e,t,r){super(e,t,r),this.key=U.fromName(r.referenceValue)}matches(e){let t=U.comparator(e.key,this.key);return this.matchesComparison(t)}},Rh=class extends ve{constructor(e,t){super(e,"in",t),this.keys=Pv("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Ch=class extends ve{constructor(e,t){super(e,"not-in",t),this.keys=Pv("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Pv(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>U.fromName(r.referenceValue))}var Ph=class extends ve{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Jd(t)&&ms(t.arrayValue,this.value)}},Dh=class extends ve{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ms(this.value.arrayValue,t)}},Nh=class extends ve{constructor(e,t){super(e,"not-in",t)}matches(e){if(ms(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!ms(this.value.arrayValue,t)}},kh=class extends ve{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Jd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ms(this.value.arrayValue,r))}};var Oh=class{constructor(e,t=null,r=[],i=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=c,this.ue=null}};function Yy(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Oh(n,e,t,r,i,s,a)}function Yd(n){let e=z(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>bh(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Wa(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Pr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Pr(r)).join(",")),e.ue=t}return e.ue}function Xd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!CR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Rv(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Jy(n.startAt,e.startAt)&&Jy(n.endAt,e.endAt)}function xh(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var jn=class{constructor(e,t=null,r=[],i=[],s=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function DR(n,e,t,r,i,s,a,c){return new jn(n,e,t,r,i,s,a,c)}function Ka(n){return new jn(n)}function Xy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Dv(n){return n.collectionGroup!==null}function ls(n){let e=z(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Me(Qe.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Nr(s,r))}),t.has(Qe.keyField().canonicalString())||e.ce.push(new Nr(Qe.keyField(),r))}return e.ce}function yt(n){let e=z(n);return e.le||(e.le=NR(e,ls(n))),e.le}function NR(n,e){if(n.limitType==="F")return Yy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Nr(i.field,s)});let t=n.endAt?new Dr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Dr(n.startAt.position,n.startAt.inclusive):null;return Yy(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Mh(n,e){let t=n.filters.concat([e]);return new jn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Lh(n,e,t){return new jn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ha(n,e){return Xd(yt(n),yt(e))&&n.limitType===e.limitType}function Nv(n){return`${Yd(yt(n))}|lt:${n.limitType}`}function Ir(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Cv(i)).join(", ")}]`),Wa(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Pr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Pr(i)).join(",")),`Target(${r})`}(yt(n))}; limitType=${n.limitType})`}function Qa(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):U.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of ls(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,c,l){let h=Qy(a,c,l);return a.inclusive?h<=0:h<0}(r.startAt,ls(r),i)||r.endAt&&!function(a,c,l){let h=Qy(a,c,l);return a.inclusive?h>=0:h>0}(r.endAt,ls(r),i))}(n,e)}function kR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function kv(n){return(e,t)=>{let r=!1;for(let i of ls(n)){let s=OR(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function OR(n,e,t){let r=n.field.isKeyField()?U.comparator(e.key,t.key):function(s,a,c){let l=a.data.field(s),h=c.data.field(s);return l!==null&&h!==null?Cr(l,h):B()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B()}}var fn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){zn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Ev(this.inner)}size(){return this.innerSize}};var xR=new fe(U.comparator);function Vt(){return xR}var Ov=new fe(U.comparator);function cs(...n){let e=Ov;for(let t of n)e=e.insert(t.key,t);return e}function xv(n){let e=Ov;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function xn(){return hs()}function Mv(){return hs()}function hs(){return new fn(n=>n.toString(),(n,e)=>n.isEqual(e))}var MR=new fe(U.comparator),LR=new Me(U.comparator);function Y(...n){let e=LR;for(let t of n)e=e.add(t);return e}var VR=new Me(re);function FR(){return VR}function Lv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fs(e)?"-0":e}}function Vv(n){return{integerValue:""+n}}function UR(n,e){return TR(e)?Vv(e):Lv(n,e)}var kr=class{constructor(){this._=void 0}};function jR(n,e,t){return n instanceof Or?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Hd(s)&&(s=Qd(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof $n?Uv(n,e):n instanceof Bn?jv(n,e):function(i,s){let a=Fv(i,s),c=Zy(a)+Zy(i.Pe);return Ah(a)&&Ah(i.Pe)?Vv(c):Lv(i.serializer,c)}(n,e)}function $R(n,e,t){return n instanceof $n?Uv(n,e):n instanceof Bn?jv(n,e):t}function Fv(n,e){return n instanceof xr?function(r){return Ah(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Or=class extends kr{},$n=class extends kr{constructor(e){super(),this.elements=e}};function Uv(n,e){let t=$v(e);for(let r of n.elements)t.some(i=>_t(i,r))||t.push(r);return{arrayValue:{values:t}}}var Bn=class extends kr{constructor(e){super(),this.elements=e}};function jv(n,e){let t=$v(e);for(let r of n.elements)t=t.filter(i=>!_t(i,r));return{arrayValue:{values:t}}}var xr=class extends kr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Zy(n){return de(n.integerValue||n.doubleValue)}function $v(n){return Jd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function BR(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof $n&&i instanceof $n||r instanceof Bn&&i instanceof Bn?Rr(r.elements,i.elements,_t):r instanceof xr&&i instanceof xr?_t(r.Pe,i.Pe):r instanceof Or&&i instanceof Or}(n.transform,e.transform)}var Vh=class{constructor(e,t){this.version=e,this.transformResults=t}},xt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ha(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Mr=class{};function Bv(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _a(n.key,xt.none()):new qn(n.key,n.data,xt.none());{let t=n.data,r=He.empty(),i=new Me(Qe.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new It(n.key,r,new Ze(i.toArray()),xt.none())}}function qR(n,e,t){n instanceof qn?function(i,s,a){let c=i.value.clone(),l=tv(i.fieldTransforms,s,a.transformResults);c.setAll(l),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof It?function(i,s,a){if(!ha(i.precondition,s))return void s.convertToUnknownDocument(a.version);let c=tv(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(qv(i)),l.setAll(c),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function ds(n,e,t,r){return n instanceof qn?function(s,a,c,l){if(!ha(s.precondition,a))return c;let h=s.value.clone(),f=nv(s.fieldTransforms,l,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(n,e,t,r):n instanceof It?function(s,a,c,l){if(!ha(s.precondition,a))return c;let h=nv(s.fieldTransforms,l,a),f=a.data;return f.setAll(qv(s)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,e,t,r):function(s,a,c){return ha(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(n,e,t)}function zR(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Fv(r.transform,i||null);s!=null&&(t===null&&(t=He.empty()),t.set(r.field,s))}return t||null}function ev(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Rr(r,i,(s,a)=>BR(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var qn=class extends Mr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},It=class extends Mr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function qv(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function tv(n,e,t){let r=new Map;ae(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,c=e.data.field(s.field);r.set(s.field,$R(a,c,t[i]))}return r}function nv(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,jR(s,a,e))}return r}var _a=class extends Mr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Fh=class extends Mr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Uh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&qR(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ds(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ds(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Mv();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,c=this.applyToLocalView(a,s.mutatedFields);c=t.has(i.key)?null:c;let l=Bv(a,c);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(G.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Y())}isEqual(e){return this.batchId===e.batchId&&Rr(this.mutations,e.mutations,(t,r)=>ev(t,r))&&Rr(this.baseMutations,e.baseMutations,(t,r)=>ev(t,r))}},jh=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ae(e.mutations.length===r.length);let i=function(){return MR}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var $h=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Bh=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ge,Z;function GR(n){switch(n){default:return B();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function zv(n){if(n===void 0)return Mt("GRPC error has no .code"),P.UNKNOWN;switch(n){case ge.OK:return P.OK;case ge.CANCELLED:return P.CANCELLED;case ge.UNKNOWN:return P.UNKNOWN;case ge.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case ge.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case ge.INTERNAL:return P.INTERNAL;case ge.UNAVAILABLE:return P.UNAVAILABLE;case ge.UNAUTHENTICATED:return P.UNAUTHENTICATED;case ge.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case ge.NOT_FOUND:return P.NOT_FOUND;case ge.ALREADY_EXISTS:return P.ALREADY_EXISTS;case ge.PERMISSION_DENIED:return P.PERMISSION_DENIED;case ge.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case ge.ABORTED:return P.ABORTED;case ge.OUT_OF_RANGE:return P.OUT_OF_RANGE;case ge.UNIMPLEMENTED:return P.UNIMPLEMENTED;case ge.DATA_LOSS:return P.DATA_LOSS;default:return B()}}(Z=ge||(ge={}))[Z.OK=0]="OK",Z[Z.CANCELLED=1]="CANCELLED",Z[Z.UNKNOWN=2]="UNKNOWN",Z[Z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Z[Z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Z[Z.NOT_FOUND=5]="NOT_FOUND",Z[Z.ALREADY_EXISTS=6]="ALREADY_EXISTS",Z[Z.PERMISSION_DENIED=7]="PERMISSION_DENIED",Z[Z.UNAUTHENTICATED=16]="UNAUTHENTICATED",Z[Z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Z[Z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Z[Z.ABORTED=10]="ABORTED",Z[Z.OUT_OF_RANGE=11]="OUT_OF_RANGE",Z[Z.UNIMPLEMENTED=12]="UNIMPLEMENTED",Z[Z.INTERNAL=13]="INTERNAL",Z[Z.UNAVAILABLE=14]="UNAVAILABLE",Z[Z.DATA_LOSS=15]="DATA_LOSS";var rv=null;function WR(){return new TextEncoder}var KR=new ln([4294967295,4294967295],0);function iv(n){let e=WR().encode(n),t=new nh;return t.update(e),new Uint8Array(t.digest())}function sv(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ln([t,r],0),new ln([i,s],0)]}var qh=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Mn(`Invalid padding: ${t}`);if(r<0)throw new Mn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Mn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Mn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ln.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(ln.fromNumber(r)));return i.compare(KR)===1&&(i=new ln([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=iv(e),[r,i]=sv(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.Ie===0)return;let t=iv(e),[r,i]=sv(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Mn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ia=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,gs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(G.min(),i,new fe(re),Vt(),Y())}},gs=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Y(),Y(),Y())}};var Ar=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},wa=class{constructor(e,t){this.targetId=e,this.me=t}},Ea=class{constructor(e,t,r=je.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ta=class{constructor(){this.fe=0,this.ge=av(),this.pe=je.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=Y(),t=Y(),r=Y();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:B()}}),new gs(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=av()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ae(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},zh=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Vt(),this.qe=ov(),this.Qe=new fe(re)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:B()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(xh(s))if(r===0){let a=new U(s.path);this.Ue(t,a,it.newNoDocument(a,G.min()))}else ae(r===1);else{let a=this.Ye(t);if(a!==r){let c=this.Ze(e),l=c?this.Xe(c,e,a):1;if(l!==0){this.je(t);let h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,h)}rv?.et(function(f,g,I,R,N){var O,C,x,q,Q,K;let _e={localCacheCount:f,existenceFilterCount:g.count,databaseId:I.database,projectId:I.projectId},ne=g.unchangedNames;return ne&&(_e.bloomFilter={applied:N===0,hashCount:(O=ne?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(q=(x=(C=ne?.bits)===null||C===void 0?void 0:C.bitmap)===null||x===void 0?void 0:x.length)!==null&&q!==void 0?q:0,padding:(K=(Q=ne?.bits)===null||Q===void 0?void 0:Q.padding)!==null&&K!==void 0?K:0,mightContain:E=>{var m;return(m=R?.mightContain(E))!==null&&m!==void 0&&m}}),_e}(a,e.me,this.Le.tt(),c,l))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,c;try{a=dn(r).toUint8Array()}catch(l){if(l instanceof ga)return Sr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new qh(a,i,s)}catch(l){return Sr(l instanceof Mn?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Ie===0?null:c}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.Le.tt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let c=this.Je(a);if(c){if(s.current&&xh(c.target)){let l=new U(c.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,it.newNoDocument(l,e))}s.be&&(t.set(a,s.Ce()),s.ve())}});let r=Y();this.qe.forEach((s,a)=>{let c=!0;a.forEachWhile(l=>{let h=this.Je(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let i=new Ia(e,t,this.Qe,this.ke,r);return this.ke=Vt(),this.qe=ov(),this.Qe=new fe(re),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ta,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Me(re),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||L("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ta),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function ov(){return new fe(U.comparator)}function av(){return new fe(U.comparator)}var HR={asc:"ASCENDING",desc:"DESCENDING"},QR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JR={and:"AND",or:"OR"},Gh=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Wh(n,e){return n.useProto3Json||Wa(e)?e:{value:e}}function Aa(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gv(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function YR(n,e){return Aa(n,e.toTimestamp())}function vt(n){return ae(!!n),G.fromTimestamp(function(t){let r=Lt(t);return new Pe(r.seconds,r.nanos)}(n))}function Zd(n,e){return Kh(n,e).canonicalString()}function Kh(n,e){let t=function(i){return new le(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Wv(n){let e=le.fromString(n);return ae(Yv(e)),e}function Hh(n,e){return Zd(n.databaseId,e.path)}function uh(n,e){let t=Wv(e);if(t.get(1)!==n.databaseId.projectId)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new U(Hv(t))}function Kv(n,e){return Zd(n.databaseId,e)}function XR(n){let e=Wv(n);return e.length===4?le.emptyPath():Hv(e)}function Qh(n){return new le(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Hv(n){return ae(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function cv(n,e,t){return{name:Hh(n,e),fields:t.value.mapValue.fields}}function ZR(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:B()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,f){return h.useProto3Json?(ae(f===void 0||typeof f=="string"),je.fromBase64String(f||"")):(ae(f===void 0||f instanceof Buffer||f instanceof Uint8Array),je.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){let f=h.code===void 0?P.UNKNOWN:zv(h.code);return new M(f,h.message||"")}(a);t=new Ea(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=uh(n,r.document.name),s=vt(r.document.updateTime),a=r.document.createTime?vt(r.document.createTime):G.min(),c=new He({mapValue:{fields:r.document.fields}}),l=it.newFoundDocument(i,s,a,c),h=r.targetIds||[],f=r.removedTargetIds||[];t=new Ar(h,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=uh(n,r.document),s=r.readTime?vt(r.readTime):G.min(),a=it.newNoDocument(i,s),c=r.removedTargetIds||[];t=new Ar([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=uh(n,r.document),s=r.removedTargetIds||[];t=new Ar([],s,i,null)}else{if(!("filter"in e))return B();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new Bh(i,s),c=r.targetId;t=new wa(c,a)}}return t}function e0(n,e){let t;if(e instanceof qn)t={update:cv(n,e.key,e.value)};else if(e instanceof _a)t={delete:Hh(n,e.key)};else if(e instanceof It)t={update:cv(n,e.key,e.data),updateMask:u0(e.fieldMask)};else{if(!(e instanceof Fh))return B();t={verify:Hh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let c=a.transform;if(c instanceof Or)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof $n)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Bn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof xr)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw B()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:YR(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:B()}(n,e.precondition)),t}function t0(n,e){return n&&n.length>0?(ae(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?vt(i.updateTime):vt(s);return a.isEqual(G.min())&&(a=vt(s)),new Vh(a,i.transformResults||[])}(t,e))):[]}function n0(n,e){return{documents:[Kv(n,e.path)]}}function r0(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Kv(n,i);let s=function(h){if(h.length!==0)return Jv(st.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(h){if(h.length!==0)return h.map(f=>function(I){return{field:wr(I.field),direction:o0(I.dir)}}(f))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let c=Wh(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:t,parent:i}}function i0(n){let e=XR(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ae(r===1);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(g){let I=Qv(g);return I instanceof st&&Sv(I)?I.getFilters():[I]}(t.where));let a=[];t.orderBy&&(a=function(g){return g.map(I=>function(N){return new Nr(Er(N.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(I))}(t.orderBy));let c=null;t.limit&&(c=function(g){let I;return I=typeof g=="object"?g.value:g,Wa(I)?null:I}(t.limit));let l=null;t.startAt&&(l=function(g){let I=!!g.before,R=g.values||[];return new Dr(R,I)}(t.startAt));let h=null;return t.endAt&&(h=function(g){let I=!g.before,R=g.values||[];return new Dr(R,I)}(t.endAt)),DR(e,i,a,s,c,"F",l,h)}function s0(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Qv(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Er(t.unaryFilter.field);return ve.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Er(t.unaryFilter.field);return ve.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Er(t.unaryFilter.field);return ve.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Er(t.unaryFilter.field);return ve.create(a,"!=",{nullValue:"NULL_VALUE"});default:return B()}}(n):n.fieldFilter!==void 0?function(t){return ve.create(Er(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return B()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return st.create(t.compositeFilter.filters.map(r=>Qv(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B()}}(t.compositeFilter.op))}(n):B()}function o0(n){return HR[n]}function a0(n){return QR[n]}function c0(n){return JR[n]}function wr(n){return{fieldPath:n.canonicalString()}}function Er(n){return Qe.fromServerFormat(n.fieldPath)}function Jv(n){return n instanceof ve?function(t){if(t.op==="=="){if(Hy(t.value))return{unaryFilter:{field:wr(t.field),op:"IS_NAN"}};if(Ky(t.value))return{unaryFilter:{field:wr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Hy(t.value))return{unaryFilter:{field:wr(t.field),op:"IS_NOT_NAN"}};if(Ky(t.value))return{unaryFilter:{field:wr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wr(t.field),op:a0(t.op),value:t.value}}}(n):n instanceof st?function(t){let r=t.getFilters().map(i=>Jv(i));return r.length===1?r[0]:{compositeFilter:{op:c0(t.op),filters:r}}}(n):B()}function u0(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Yv(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ys=class n{constructor(e,t,r,i,s=G.min(),a=G.min(),c=je.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Jh=class{constructor(e){this.ct=e}};function l0(n){let e=i0({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Lh(e,e.limit,"L"):e}var ba=class{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(de(e.integerValue));else if("doubleValue"in e){let r=de(e.doubleValue);isNaN(r)?this.Et(t,13):(this.Et(t,15),fs(r)?t.dt(0):t.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(t,20),typeof r=="string"&&(r=Lt(r)),t.At(`${r.seconds||""}`),t.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(dn(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(t,45),t.dt(r.latitude||0),t.dt(r.longitude||0)}else"mapValue"in e?Tv(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):B()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){let r=e.fields||{};this.Et(t,55);for(let i of Object.keys(r))this.Rt(i,t),this.It(r[i],t)}wt(e,t){let r=e.values||[];this.Et(t,50);for(let i of r)this.It(i,t)}gt(e,t){this.Et(t,37),U.fromName(e).path.forEach(r=>{this.Et(t,60),this.St(r,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}};ba.bt=new ba;var Yh=class{constructor(){this._n=new Xh}addToCollectionParentIndex(e,t){return this._n.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(Fn.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(Fn.min())}updateCollectionGroup(e,t,r){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}},Xh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Me(le.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Me(le.comparator)).toArray()}};var EN=new Uint8Array(0);var pt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};pt.DEFAULT_COLLECTION_PERCENTILE=10,pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pt.DEFAULT=new pt(41943040,pt.DEFAULT_COLLECTION_PERCENTILE,pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pt.DISABLED=new pt(-1,0,0);var vs=class n{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new n(0)}static Ln(){return new n(-1)}};var Zh=class{constructor(){this.changes=new fn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,it.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?D.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ed=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var td=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ds(r.mutation,i,Ze.empty(),Pe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Y()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Y()){let i=xn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=cs();return s.forEach((c,l)=>{a=a.insert(c,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=xn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Y()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,r,i){let s=Vt(),a=hs(),c=function(){return hs()}();return t.forEach((l,h)=>{let f=r.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof It)?s=s.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),ds(f.mutation,h,f.mutation.getFieldMask(),Pe.now())):a.set(h.key,Ze.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((h,f)=>a.set(h,f)),t.forEach((h,f)=>{var g;return c.set(h,new ed(f,(g=a.get(h))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,t){let r=hs(),i=new fe((a,c)=>a-c),s=Y();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let c of a)c.keys().forEach(l=>{let h=t.get(l);if(h===null)return;let f=r.get(l)||Ze.empty();f=c.applyToLocalView(h,f),r.set(l,f);let g=(i.get(c.batchId)||Y()).add(l);i=i.insert(c.batchId,g)})}).next(()=>{let a=[],c=i.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),h=l.key,f=l.value,g=Mv();f.forEach(I=>{if(!s.has(I)){let R=Bv(t.get(I),r.get(I));R!==null&&g.set(I,R),s=s.add(I)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return D.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return U.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Dv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):D.resolve(xn()),c=-1,l=s;return a.next(h=>D.forEach(h,(f,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),s.get(f)?D.resolve():this.remoteDocumentCache.getEntry(e,f).next(I=>{l=l.insert(f,I)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,l,h,Y())).next(f=>({batchId:c,changes:xv(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new U(t)).next(r=>{let i=cs();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=cs();return this.indexManager.getCollectionParents(e,s).next(c=>D.forEach(c,l=>{let h=function(g,I){return new jn(I,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(f=>{f.forEach((g,I)=>{a=a.insert(g,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,h)=>{let f=h.getKey();a.get(f)===null&&(a=a.insert(f,it.newInvalidDocument(f)))});let c=cs();return a.forEach((l,h)=>{let f=s.get(l);f!==void 0&&ds(f.mutation,h,Ze.empty(),Pe.now()),Qa(t,h)&&(c=c.insert(l,h))}),c})}};var nd=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return D.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:vt(i.createTime)}}(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(i){return{name:i.name,query:l0(i.bundledQuery),readTime:vt(i.readTime)}}(t)),D.resolve()}};var rd=class{constructor(){this.overlays=new fe(U.comparator),this.hr=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){let r=xn();return D.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),D.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),D.resolve()}getOverlaysForCollection(e,t,r){let i=xn(),s=t.length+1,a=new U(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){let l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return D.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new fe((h,f)=>h-f),a=this.overlays.getIterator();for(;a.hasNext();){let h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let f=s.get(h.largestBatchId);f===null&&(f=xn(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}let c=xn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=i)););return D.resolve(c)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new $h(t,r));let s=this.hr.get(t);s===void 0&&(s=Y(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}};var _s=class{constructor(){this.Pr=new Me(ye.Ir),this.Tr=new Me(ye.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){let r=new ye(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new ye(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){let t=new U(new le([])),r=new ye(t,e),i=new ye(t,e+1),s=[];return this.Tr.forEachInRange([r,i],a=>{this.Ar(a),s.push(a.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let t=new U(new le([])),r=new ye(t,e),i=new ye(t,e+1),s=Y();return this.Tr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new ye(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ye=class{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return U.comparator(e.key,t.key)||re(e.pr,t.pr)}static Er(e,t){return re(e.pr,t.pr)||U.comparator(e.key,t.key)}};var id=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Me(ye.Ir)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Uh(s,t,r,i);this.mutationQueue.push(a);for(let c of i)this.wr=this.wr.add(new ye(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return D.resolve(a)}lookupMutationBatch(e,t){return D.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.br(r),s=i<0?0:i;return D.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ye(t,0),i=new ye(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],a=>{let c=this.Sr(a.pr);s.push(c)}),D.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Me(re);return t.forEach(i=>{let s=new ye(i,0),a=new ye(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,a],c=>{r=r.add(c.pr)})}),D.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;U.isDocumentKey(s)||(s=s.child(""));let a=new ye(new U(s),0),c=new Me(re);return this.wr.forEachWhile(l=>{let h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(c=c.add(l.pr)),!0)},a),D.resolve(this.Dr(c))}Dr(e){let t=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ae(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return D.forEach(t.mutations,i=>{let s=new ye(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){let r=new ye(t,0),i=this.wr.firstAfterOrEqual(r);return D.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var sd=class{constructor(e){this.vr=e,this.docs=function(){return new fe(U.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return D.resolve(r?r.document.mutableCopy():it.newInvalidDocument(t))}getEntries(e,t){let r=Vt();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():it.newInvalidDocument(i))}),D.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Vt(),a=t.path,c=new U(a.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:h,value:{document:f}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||IR(_R(f),r)<=0||(i.has(f.key)||Qa(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return D.resolve(s)}getAllFromCollectionGroup(e,t,r,i){B()}Fr(e,t){return D.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new od(this)}getSize(e){return D.resolve(this.size)}},od=class extends Zh{constructor(e){super(),this.ar=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),D.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}};var ad=class{constructor(e){this.persistence=e,this.Mr=new fn(t=>Yd(t),Xd),this.lastRemoteSnapshotVersion=G.min(),this.highestTargetId=0,this.Or=0,this.Nr=new _s,this.targetCount=0,this.Lr=vs.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,i)=>t(i)),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),D.resolve()}qn(e){this.Mr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Lr=new vs(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.qn(t),D.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Mr.forEach((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.Mr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),D.waitFor(s).next(()=>i)}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){let r=this.Mr.get(t)||null;return D.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),D.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),D.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),D.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Nr.gr(t);return D.resolve(r)}containsKey(e,t){return D.resolve(this.Nr.containsKey(t))}};var cd=class{constructor(e,t){this.Br={},this.overlays={},this.kr=new wv(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new ad(this),this.indexManager=new Yh,this.remoteDocumentCache=function(i){return new sd(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Jh(t),this.$r=new nd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new rd,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new id(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){L("MemoryPersistence","Starting transaction:",e);let i=new ud(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,t){return D.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}},ud=class extends wh{constructor(e){super(),this.currentSequenceNumber=e}},ld=class n{constructor(e){this.persistence=e,this.zr=new _s,this.jr=null}static Hr(e){return new n(e)}get Jr(){if(this.jr)return this.jr;throw B()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),D.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),D.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.Jr,r=>{let i=U.fromPath(r);return this.Yr(e,i).next(s=>{s||t.removeEntry(i,G.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return D.or([()=>D.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}};var hd=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=i}static Ki(e,t){let r=Y(),i=Y();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var dd=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var fd=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Rg()?8:ER(we())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ji(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Hi(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new dd;return this.Ji(e,t,a).next(c=>{if(s.result=c,this.Ui)return this.Yi(e,t,a,c.size)})}).next(()=>s.result)}Yi(e,t,r,i){return r.documentReadCount<this.Wi?(as()<=J.DEBUG&&L("QueryEngine","SDK will not create cache indexes for query:",Ir(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),D.resolve()):(as()<=J.DEBUG&&L("QueryEngine","Query:",Ir(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(as()<=J.DEBUG&&L("QueryEngine","The SDK decides to create cache indexes for query:",Ir(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yt(t))):D.resolve())}ji(e,t){if(Xy(t))return D.resolve(null);let r=yt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Lh(t,null,"F"),r=yt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=Y(...s);return this.zi.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(l=>{let h=this.Zi(t,c);return this.Xi(t,h,a,l.readTime)?this.ji(e,Lh(t,null,"F")):this.es(e,h,t,l)}))})))}Hi(e,t,r,i){return Xy(t)||i.isEqual(G.min())?D.resolve(null):this.zi.getDocuments(e,r).next(s=>{let a=this.Zi(t,s);return this.Xi(t,a,r,i)?D.resolve(null):(as()<=J.DEBUG&&L("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ir(t)),this.es(e,a,t,vR(i,-1)).next(c=>c))})}Zi(e,t){let r=new Me(kv(e));return t.forEach((i,s)=>{Qa(e,s)&&(r=r.add(s))}),r}Xi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,t,r){return as()<=J.DEBUG&&L("QueryEngine","Using full collection scan to execute query:",Ir(t)),this.zi.getDocumentsMatchingQuery(e,t,Fn.min(),r)}es(e,t,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var pd=class{constructor(e,t,r,i){this.persistence=e,this.ts=t,this.serializer=i,this.ns=new fe(re),this.rs=new fn(s=>Yd(s),Xd),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new td(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}};function h0(n,e,t,r){return new pd(n,e,t,r)}function Xv(n,e){return _(this,null,function*(){let t=z(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],c=[],l=Y();for(let h of i){a.push(h.batchId);for(let f of h.mutations)l=l.add(f.key)}for(let h of s){c.push(h.batchId);for(let f of h.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(r,l).next(h=>({us:h,removedBatchIds:a,addedBatchIds:c}))})})})}function d0(n,e){let t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(c,l,h,f){let g=h.batch,I=g.keys(),R=D.resolve();return I.forEach(N=>{R=R.next(()=>f.getEntry(l,N)).next(O=>{let C=h.docVersions.get(N);ae(C!==null),O.version.compareTo(C)<0&&(g.applyToRemoteDocument(O,h),O.isValidDocument()&&(O.setReadTime(h.commitVersion),f.addEntry(O)))})}),R.next(()=>c.mutationQueue.removeMutationBatch(l,g))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let l=Y();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Zv(n){let e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function f0(n,e){let t=z(n),r=e.snapshotVersion,i=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.os.newChangeBuffer({trackRemovals:!0});i=t.ns;let c=[];e.targetChanges.forEach((f,g)=>{let I=i.get(g);if(!I)return;c.push(t.Qr.removeMatchingKeys(s,f.removedDocuments,g).next(()=>t.Qr.addMatchingKeys(s,f.addedDocuments,g)));let R=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?R=R.withResumeToken(je.EMPTY_BYTE_STRING,G.min()).withLastLimboFreeSnapshotVersion(G.min()):f.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(f.resumeToken,r)),i=i.insert(g,R),function(O,C,x){return O.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(I,R,f)&&c.push(t.Qr.updateTargetData(s,R))});let l=Vt(),h=Y();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),c.push(p0(s,a,e.documentUpdates).next(f=>{l=f.cs,h=f.ls})),!r.isEqual(G.min())){let f=t.Qr.getLastRemoteSnapshotVersion(s).next(g=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(f)}return D.waitFor(c).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,h)).next(()=>l)}).then(s=>(t.ns=i,s))}function p0(n,e,t){let r=Y(),i=Y();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Vt();return t.forEach((c,l)=>{let h=s.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),l.isNoDocument()&&l.version.isEqual(G.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):L("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)}),{cs:a,ls:i}})}function m0(n,e){let t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function g0(n,e){let t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Qr.getTargetData(r,e).next(s=>s?(i=s,D.resolve(i)):t.Qr.allocateTargetId(r).next(a=>(i=new ys(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}function md(n,e,t){return _(this,null,function*(){let r=z(n),i=r.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!bs(a))throw a;L("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function uv(n,e,t){let r=z(n),i=G.min(),s=Y();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,h,f){let g=z(l),I=g.rs.get(f);return I!==void 0?D.resolve(g.ns.get(I)):g.Qr.getTargetData(h,f)}(r,a,yt(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(a,c.targetId).next(l=>{s=l})}).next(()=>r.ts.getDocumentsMatchingQuery(a,e,t?i:G.min(),t?s:Y())).next(c=>(y0(r,kR(e),c),{documents:c,hs:s})))}function y0(n,e,t){let r=n.ss.get(e)||G.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ss.set(e,r)}var Sa=class{constructor(){this.activeTargetIds=FR()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var gd=class{constructor(){this.no=new Sa,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Sa,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var yd=class{io(e){}shutdown(){}};var Ra=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){L("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){L("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var ua=null;function lh(){return ua===null?ua=function(){return 268435456+Math.round(2147483648*Math.random())}():ua++,"0x"+ua.toString(16)}var v0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var vd=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var xe="WebChannelConnection",_d=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(t,r,i,s,a){let c=lh(),l=this.vo(t,r.toUriEncodedString());L("RestConnection",`Sending RPC '${t}' ${c}:`,l,i);let h={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(h,s,a),this.Mo(t,l,h,i).then(f=>(L("RestConnection",`Received RPC '${t}' ${c}: `,f),f),f=>{throw Sr("RestConnection",`RPC '${t}' ${c} failed with error: `,f,"url: ",l,"request:",i),f})}xo(t,r,i,s,a,c){return this.Co(t,r,i,s,a)}Fo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+jr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}vo(t,r){let i=v0[t];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,i){let s=lh();return new Promise((a,c)=>{let l=new rh;l.setWithCredentials(!0),l.listenOnce(sh.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case os.NO_ERROR:let f=l.getResponseJson();L(xe,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case os.TIMEOUT:L(xe,`RPC '${e}' ${s} timed out`),c(new M(P.DEADLINE_EXCEEDED,"Request time out"));break;case os.HTTP_ERROR:let g=l.getStatus();if(L(xe,`RPC '${e}' ${s} failed with status:`,g,"response text:",l.getResponseText()),g>0){let I=l.getResponseJson();Array.isArray(I)&&(I=I[0]);let R=I?.error;if(R&&R.status&&R.message){let N=function(C){let x=C.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(x)>=0?x:P.UNKNOWN}(R.status);c(new M(N,R.message))}else c(new M(P.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new M(P.UNAVAILABLE,"Connection failed."));break;default:B()}}finally{L(xe,`RPC '${e}' ${s} completed.`)}});let h=JSON.stringify(i);L(xe,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,r,15)})}Oo(e,t,r){let i=lh(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ch(),c=ah(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.xmlHttpFactory=new ih({})),this.Fo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let f=s.join("");L(xe,`Creating RPC '${e}' stream ${i}: ${f}`,l);let g=a.createWebChannel(f,l),I=!1,R=!1,N=new vd({lo:C=>{R?L(xe,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(I||(L(xe,`Opening RPC '${e}' stream ${i} transport.`),g.open(),I=!0),L(xe,`RPC '${e}' stream ${i} sending:`,C),g.send(C))},ho:()=>g.close()}),O=(C,x,q)=>{C.listen(x,Q=>{try{q(Q)}catch(K){setTimeout(()=>{throw K},0)}})};return O(g,_r.EventType.OPEN,()=>{R||(L(xe,`RPC '${e}' stream ${i} transport opened.`),N.mo())}),O(g,_r.EventType.CLOSE,()=>{R||(R=!0,L(xe,`RPC '${e}' stream ${i} transport closed`),N.po())}),O(g,_r.EventType.ERROR,C=>{R||(R=!0,Sr(xe,`RPC '${e}' stream ${i} transport errored:`,C),N.po(new M(P.UNAVAILABLE,"The operation could not be completed")))}),O(g,_r.EventType.MESSAGE,C=>{var x;if(!R){let q=C.data[0];ae(!!q);let Q=q,K=Q.error||((x=Q[0])===null||x===void 0?void 0:x.error);if(K){L(xe,`RPC '${e}' stream ${i} received error:`,K);let _e=K.status,ne=function(v){let w=ge[v];if(w!==void 0)return zv(w)}(_e),E=K.message;ne===void 0&&(ne=P.INTERNAL,E="Unknown error status: "+_e+" with message "+K.message),R=!0,N.po(new M(ne,E)),g.close()}else L(xe,`RPC '${e}' stream ${i} received:`,q),N.yo(q)}}),O(c,oh.STAT_EVENT,C=>{C.stat===aa.PROXY?L(xe,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===aa.NOPROXY&&L(xe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.fo()},0),N}};function hh(){return typeof document<"u"?document:null}function Ja(n){return new Gh(n,!0)}var Ca=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-r);i>0&&L("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var Pa=class{constructor(e,t,r,i,s,a,c,l){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Ca(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return _(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return _(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,t){return _(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(Mt(t.toString()),Mt("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(t)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===t&&this.u_(r,i)},r=>{e(()=>{let i=new M(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,t){let r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>_(this,null,function*(){this.state=0,this.start()}))}c_(e){return L("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(L("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Id=class extends Pa{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();let t=ZR(this.serializer,e),r=function(s){if(!("targetChange"in s))return G.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?G.min():a.readTime?vt(a.readTime):G.min()}(e);return this.listener.h_(t,r)}P_(e){let t={};t.database=Qh(this.serializer),t.addTarget=function(s,a){let c,l=a.target;if(c=xh(l)?{documents:n0(s,l)}:{query:r0(s,l)._t},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Gv(s,a.resumeToken);let h=Wh(s,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(G.min())>0){c.readTime=Aa(s,a.snapshotVersion.toTimestamp());let h=Wh(s,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);let r=s0(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){let t={};t.database=Qh(this.serializer),t.removeTarget=e,this.i_(t)}},wd=class extends Pa{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(ae(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let t=t0(e.writeResults,e.commitTime),r=vt(e.commitTime);return this.listener.A_(r,t)}return ae(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=Qh(this.serializer),this.i_(e)}d_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>e0(this.serializer,r))};this.i_(t)}};var Ed=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,Kh(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(P.UNKNOWN,s.toString())})}xo(e,t,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.xo(e,Kh(t,r),i,a,c,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new M(P.UNKNOWN,a.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},Td=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Mt(t),this.y_=!1):L("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var Ad=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(a=>{r.enqueueAndForget(()=>_(this,null,function*(){Gn(this)&&(L("RemoteStore","Restarting streams for network reachability change."),yield function(l){return _(this,null,function*(){let h=z(l);h.M_.add(4),yield Ss(h),h.N_.set("Unknown"),h.M_.delete(4),yield Ya(h)})}(this))}))}),this.N_=new Td(r,i)}};function Ya(n){return _(this,null,function*(){if(Gn(n))for(let e of n.x_)yield e(!0)})}function Ss(n){return _(this,null,function*(){for(let e of n.x_)yield e(!1)})}function e_(n,e){let t=z(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),rf(t)?nf(t):$r(t).Xo()&&tf(t,e))}function ef(n,e){let t=z(n),r=$r(t);t.F_.delete(e),r.Xo()&&t_(t,e),t.F_.size===0&&(r.Xo()?r.n_():Gn(t)&&t.N_.set("Unknown"))}function tf(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(G.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}$r(n).P_(e)}function t_(n,e){n.L_.xe(e),$r(n).I_(e)}function nf(n){n.L_=new zh({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),$r(n).start(),n.N_.w_()}function rf(n){return Gn(n)&&!$r(n).Zo()&&n.F_.size>0}function Gn(n){return z(n).M_.size===0}function n_(n){n.L_=void 0}function _0(n){return _(this,null,function*(){n.N_.set("Online")})}function I0(n){return _(this,null,function*(){n.F_.forEach((e,t)=>{tf(n,e)})})}function w0(n,e){return _(this,null,function*(){n_(n),rf(n)?(n.N_.D_(e),nf(n)):n.N_.set("Unknown")})}function E0(n,e,t){return _(this,null,function*(){if(n.N_.set("Online"),e instanceof Ea&&e.state===2&&e.cause)try{yield function(i,s){return _(this,null,function*(){let a=s.cause;for(let c of s.targetIds)i.F_.has(c)&&(yield i.remoteSyncer.rejectListen(c,a),i.F_.delete(c),i.L_.removeTarget(c))})}(n,e)}catch(r){L("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Da(n,r)}else if(e instanceof Ar?n.L_.Ke(e):e instanceof wa?n.L_.He(e):n.L_.We(e),!t.isEqual(G.min()))try{let r=yield Zv(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let c=s.L_.rt(a);return c.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){let f=s.F_.get(h);f&&s.F_.set(h,f.withResumeToken(l.resumeToken,a))}}),c.targetMismatches.forEach((l,h)=>{let f=s.F_.get(l);if(!f)return;s.F_.set(l,f.withResumeToken(je.EMPTY_BYTE_STRING,f.snapshotVersion)),t_(s,l);let g=new ys(f.target,l,h,f.sequenceNumber);tf(s,g)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){L("RemoteStore","Failed to raise snapshot:",r),yield Da(n,r)}})}function Da(n,e,t){return _(this,null,function*(){if(!bs(e))throw e;n.M_.add(1),yield Ss(n),n.N_.set("Offline"),t||(t=()=>Zv(n.localStore)),n.asyncQueue.enqueueRetryable(()=>_(this,null,function*(){L("RemoteStore","Retrying IndexedDB access"),yield t(),n.M_.delete(1),yield Ya(n)}))})}function r_(n,e){return e().catch(t=>Da(n,t,e))}function Xa(n){return _(this,null,function*(){let e=z(n),t=pn(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;T0(e);)try{let i=yield m0(e.localStore,r);if(i===null){e.v_.length===0&&t.n_();break}r=i.batchId,A0(e,i)}catch(i){yield Da(e,i)}i_(e)&&s_(e)})}function T0(n){return Gn(n)&&n.v_.length<10}function A0(n,e){n.v_.push(e);let t=pn(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function i_(n){return Gn(n)&&!pn(n).Zo()&&n.v_.length>0}function s_(n){pn(n).start()}function b0(n){return _(this,null,function*(){pn(n).V_()})}function S0(n){return _(this,null,function*(){let e=pn(n);for(let t of n.v_)e.d_(t.mutations)})}function R0(n,e,t){return _(this,null,function*(){let r=n.v_.shift(),i=jh.from(r,e,t);yield r_(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Xa(n)})}function C0(n,e){return _(this,null,function*(){e&&pn(n).E_&&(yield function(r,i){return _(this,null,function*(){if(function(a){return GR(a)&&a!==P.ABORTED}(i.code)){let s=r.v_.shift();pn(r).t_(),yield r_(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Xa(r)}})}(n,e)),i_(n)&&s_(n)})}function lv(n,e){return _(this,null,function*(){let t=z(n);t.asyncQueue.verifyOperationInProgress(),L("RemoteStore","RemoteStore received new credentials");let r=Gn(t);t.M_.add(3),yield Ss(t),r&&t.N_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),yield Ya(t)})}function P0(n,e){return _(this,null,function*(){let t=z(n);e?(t.M_.delete(2),yield Ya(t)):e||(t.M_.add(2),yield Ss(t),t.N_.set("Unknown"))})}function $r(n){return n.B_||(n.B_=function(t,r,i){let s=z(t);return s.f_(),new Id(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:_0.bind(null,n),To:I0.bind(null,n),Ao:w0.bind(null,n),h_:E0.bind(null,n)}),n.x_.push(e=>_(this,null,function*(){e?(n.B_.t_(),rf(n)?nf(n):n.N_.set("Unknown")):(yield n.B_.stop(),n_(n))}))),n.B_}function pn(n){return n.k_||(n.k_=function(t,r,i){let s=z(t);return s.f_(),new wd(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:b0.bind(null,n),Ao:C0.bind(null,n),R_:S0.bind(null,n),A_:R0.bind(null,n)}),n.x_.push(e=>_(this,null,function*(){e?(n.k_.t_(),yield Xa(n)):(yield n.k_.stop(),n.v_.length>0&&(L("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))}))),n.k_}var bd=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new mt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,c=new n(e,t,a,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function sf(n,e){if(Mt("AsyncQueue",`${e}: ${n}`),bs(n))return new M(P.UNAVAILABLE,`${e}: ${n}`);throw n}var Na=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||U.comparator(t.key,r.key):(t,r)=>U.comparator(t.key,r.key),this.keyedMap=cs(),this.sortedSet=new fe(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var ka=class{constructor(){this.q_=new fe(U.comparator)}track(e){let t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):B():this.q_=this.q_.insert(t,e)}Q_(){let e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}},Lr=class n{constructor(e,t,r,i,s,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(c=>{a.push({type:0,doc:c})}),new n(e,t,Na.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ha(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Sd=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},Rd=class{constructor(){this.queries=new fn(e=>Nv(e),Ha),this.onlineState="Unknown",this.z_=new Set}};function o_(n,e){return _(this,null,function*(){let t=z(n),r=3,i=e.query,s=t.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new Sd,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield t.onListen(i,!0);break;case 1:s.K_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let c=sf(a,`Initialization of query '${Ir(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&of(t)})}function a_(n,e){return _(this,null,function*(){let t=z(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.U_.indexOf(e);a>=0&&(s.U_.splice(a,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function D0(n,e){let t=z(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let c of a.U_)c.H_(i)&&(r=!0);a.K_=i}}r&&of(t)}function N0(n,e,t){let r=z(n),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(t);r.queries.delete(e)}function of(n){n.z_.forEach(e=>{e.next()})}var Cd,hv;(hv=Cd||(Cd={})).J_="default",hv.Cache="cache";var Oa=class{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Lr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;let r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Lr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Cd.Cache}};var xa=class{constructor(e){this.key=e}},Ma=class{constructor(e){this.key=e}},Pd=class{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=Y(),this.mutatedKeys=Y(),this.Ia=kv(e),this.Ta=new Na(this.Ia)}get Ea(){return this.la}da(e,t){let r=t?t.Aa:new ka,i=t?t.Ta:this.Ta,s=t?t.mutatedKeys:this.mutatedKeys,a=i,c=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,g)=>{let I=i.get(f),R=Qa(this.query,g)?g:null,N=!!I&&this.mutatedKeys.has(I.key),O=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations),C=!1;I&&R?I.data.isEqual(R.data)?N!==O&&(r.track({type:3,doc:R}),C=!0):this.Ra(I,R)||(r.track({type:2,doc:R}),C=!0,(l&&this.Ia(R,l)>0||h&&this.Ia(R,h)<0)&&(c=!0)):!I&&R?(r.track({type:0,doc:R}),C=!0):I&&!R&&(r.track({type:1,doc:I}),C=!0,(l||h)&&(c=!0)),C&&(R?(a=a.add(R),s=O?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{Ta:a,Aa:r,Xi:c,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let a=e.Aa.Q_();a.sort((f,g)=>function(R,N){let O=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B()}};return O(R)-O(N)}(f.type,g.type)||this.Ia(f.doc,g.doc)),this.Va(r),i=i!=null&&i;let c=t&&!i?this.ma():[],l=this.Pa.size===0&&this.current&&!i?1:0,h=l!==this.ha;return this.ha=l,a.length!==0||h?{snapshot:new Lr(this.query,e.Ta,s,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:c}:{fa:c}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new ka,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=Y(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new Ma(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new xa(r))}),t}pa(e){this.la=e.hs,this.Pa=Y();let t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Lr.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},Dd=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Nd=class{constructor(e){this.key=e,this.wa=!1}},kd=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Sa={},this.ba=new fn(c=>Nv(c),Ha),this.Da=new Map,this.Ca=new Set,this.va=new fe(U.comparator),this.Fa=new Map,this.Ma=new _s,this.xa={},this.Oa=new Map,this.Na=vs.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function k0(n,e,t=!0){return _(this,null,function*(){let r=f_(n),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield c_(r,e,t,!0),i})}function O0(n,e){return _(this,null,function*(){let t=f_(n);yield c_(t,e,!0,!1)})}function c_(n,e,t,r){return _(this,null,function*(){let i=yield g0(n.localStore,yt(e)),s=i.targetId,a=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",c;return r&&(c=yield x0(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&e_(n.remoteStore,i),c})}function x0(n,e,t,r,i){return _(this,null,function*(){n.Ba=(g,I,R)=>function(O,C,x,q){return _(this,null,function*(){let Q=C.view.da(x);Q.Xi&&(Q=yield uv(O.localStore,C.query,!1).then(({documents:E})=>C.view.da(E,Q)));let K=q&&q.targetChanges.get(C.targetId),_e=q&&q.targetMismatches.get(C.targetId)!=null,ne=C.view.applyChanges(Q,O.isPrimaryClient,K,_e);return fv(O,C.targetId,ne.fa),ne.snapshot})}(n,g,I,R);let s=yield uv(n.localStore,e,!0),a=new Pd(e,s.hs),c=a.da(s.documents),l=gs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=a.applyChanges(c,n.isPrimaryClient,l);fv(n,t,h.fa);let f=new Dd(e,t,a);return n.ba.set(e,f),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),h.snapshot})}function M0(n,e,t){return _(this,null,function*(){let r=z(n),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(a=>!Ha(a,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield md(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&ef(r.remoteStore,i.targetId),Od(r,i.targetId)}).catch(As))):(Od(r,i.targetId),yield md(r.localStore,i.targetId,!0))})}function L0(n,e){return _(this,null,function*(){let t=z(n),r=t.ba.get(e),i=t.Da.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ef(t.remoteStore,r.targetId))})}function V0(n,e,t){return _(this,null,function*(){let r=z0(n);try{let i=yield function(a,c){let l=z(a),h=Pe.now(),f=c.reduce((R,N)=>R.add(N.key),Y()),g,I;return l.persistence.runTransaction("Locally write mutations","readwrite",R=>{let N=Vt(),O=Y();return l.os.getEntries(R,f).next(C=>{N=C,N.forEach((x,q)=>{q.isValidDocument()||(O=O.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(R,N)).next(C=>{g=C;let x=[];for(let q of c){let Q=zR(q,g.get(q.key).overlayedDocument);Q!=null&&x.push(new It(q.key,Q,Av(Q.value.mapValue),xt.exists(!0)))}return l.mutationQueue.addMutationBatch(R,h,x,c)}).next(C=>{I=C;let x=C.applyToLocalDocumentSet(g,O);return l.documentOverlayCache.saveOverlays(R,C.batchId,x)})}).then(()=>({batchId:I.batchId,changes:xv(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,c,l){let h=a.xa[a.currentUser.toKey()];h||(h=new fe(re)),h=h.insert(c,l),a.xa[a.currentUser.toKey()]=h}(r,i.batchId,t),yield Rs(r,i.changes),yield Xa(r.remoteStore)}catch(i){let s=sf(i,"Failed to persist write");t.reject(s)}})}function u_(n,e){return _(this,null,function*(){let t=z(n);try{let r=yield f0(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Fa.get(s);a&&(ae(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.wa=!0:i.modifiedDocuments.size>0?ae(a.wa):i.removedDocuments.size>0&&(ae(a.wa),a.wa=!1))}),yield Rs(t,r,e)}catch(r){yield As(r)}})}function dv(n,e,t){let r=z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ba.forEach((s,a)=>{let c=a.view.j_(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){let l=z(a);l.onlineState=c;let h=!1;l.queries.forEach((f,g)=>{for(let I of g.U_)I.j_(c)&&(h=!0)}),h&&of(l)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function F0(n,e,t){return _(this,null,function*(){let r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Fa.get(e),s=i&&i.key;if(s){let a=new fe(U.comparator);a=a.insert(s,it.newNoDocument(s,G.min()));let c=Y().add(s),l=new Ia(G.min(),new Map,new fe(re),a,c);yield u_(r,l),r.va=r.va.remove(s),r.Fa.delete(e),af(r)}else yield md(r.localStore,e,!1).then(()=>Od(r,e,t)).catch(As)})}function U0(n,e){return _(this,null,function*(){let t=z(n),r=e.batch.batchId;try{let i=yield d0(t.localStore,e);h_(t,r,null),l_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Rs(t,i)}catch(i){yield As(i)}})}function j0(n,e,t){return _(this,null,function*(){let r=z(n);try{let i=yield function(a,c){let l=z(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return l.mutationQueue.lookupMutationBatch(h,c).next(g=>(ae(g!==null),f=g.keys(),l.mutationQueue.removeMutationBatch(h,g))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>l.localDocuments.getDocuments(h,f))})}(r.localStore,e);h_(r,e,t),l_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Rs(r,i)}catch(i){yield As(i)}})}function l_(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function h_(n,e,t){let r=z(n),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Od(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||d_(n,r)})}function d_(n,e){n.Ca.delete(e.path.canonicalString());let t=n.va.get(e);t!==null&&(ef(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),af(n))}function fv(n,e,t){for(let r of t)r instanceof xa?(n.Ma.addReference(r.key,e),$0(n,r)):r instanceof Ma?(L("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||d_(n,r.key)):B()}function $0(n,e){let t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(L("SyncEngine","New document in limbo: "+t),n.Ca.add(r),af(n))}function af(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){let e=n.Ca.values().next().value;n.Ca.delete(e);let t=new U(le.fromString(e)),r=n.Na.next();n.Fa.set(r,new Nd(t)),n.va=n.va.insert(t,r),e_(n.remoteStore,new ys(yt(Ka(t.path)),r,"TargetPurposeLimboResolution",wv.oe))}}function Rs(n,e,t){return _(this,null,function*(){let r=z(n),i=[],s=[],a=[];r.ba.isEmpty()||(r.ba.forEach((c,l)=>{a.push(r.Ba(l,e,t).then(h=>{if((h||t)&&r.isPrimaryClient){let f=h&&!h.fromCache;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(h){i.push(h);let f=hd.Ki(l.targetId,h);s.push(f)}}))}),yield Promise.all(a),r.Sa.h_(i),yield function(l,h){return _(this,null,function*(){let f=z(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>D.forEach(h,I=>D.forEach(I.qi,R=>f.persistence.referenceDelegate.addReference(g,I.targetId,R)).next(()=>D.forEach(I.Qi,R=>f.persistence.referenceDelegate.removeReference(g,I.targetId,R)))))}catch(g){if(!bs(g))throw g;L("LocalStore","Failed to update sequence numbers: "+g)}for(let g of h){let I=g.targetId;if(!g.fromCache){let R=f.ns.get(I),N=R.snapshotVersion,O=R.withLastLimboFreeSnapshotVersion(N);f.ns=f.ns.insert(I,O)}}})}(r.localStore,s))})}function B0(n,e){return _(this,null,function*(){let t=z(n);if(!t.currentUser.isEqual(e)){L("SyncEngine","User change. New user:",e.toKey());let r=yield Xv(t.localStore,e);t.currentUser=e,function(s,a){s.Oa.forEach(c=>{c.forEach(l=>{l.reject(new M(P.CANCELLED,a))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Rs(t,r.us)}})}function q0(n,e){let t=z(n),r=t.Fa.get(e);if(r&&r.wa)return Y().add(r.key);{let i=Y(),s=t.Da.get(e);if(!s)return i;for(let a of s){let c=t.ba.get(a);i=i.unionWith(c.view.Ea)}return i}}function f_(n){let e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=u_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=q0.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=F0.bind(null,e),e.Sa.h_=D0.bind(null,e.eventManager),e.Sa.ka=N0.bind(null,e.eventManager),e}function z0(n){let e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=U0.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=j0.bind(null,e),e}var La=class{constructor(){this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){this.serializer=Ja(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return h0(this.persistence,new fd,e.initialUser,this.serializer)}createPersistence(e){return new cd(ld.Hr,this.serializer)}createSharedClientState(e){return new gd}terminate(){return _(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var xd=class{initialize(e,t){return _(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>dv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=B0.bind(null,this.syncEngine),yield P0(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Rd}()}createDatastore(e){let t=Ja(e.databaseInfo.databaseId),r=function(s){return new _d(s)}(e.databaseInfo);return function(s,a,c,l){return new Ed(s,a,c,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,c){return new Ad(r,i,s,a,c)}(this.localStore,this.datastore,e.asyncQueue,t=>dv(this.syncEngine,t,0),function(){return Ra.D()?new Ra:new yd}())}createSyncEngine(e,t){return function(i,s,a,c,l,h,f){let g=new kd(i,s,a,c,l,h);return f&&(g.La=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return _(this,null,function*(){var e;yield function(r){return _(this,null,function*(){let i=z(r);L("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Ss(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};var Va=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Mt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var Md=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=be.UNAUTHENTICATED,this.clientId=fa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>_(this,null,function*(){L("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(L("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new mt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=sf(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function dh(n,e){return _(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),L("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>_(this,null,function*(){r.isEqual(i)||(yield Xv(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function pv(n,e){return _(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield W0(n);L("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>lv(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>lv(e.remoteStore,i)),n._onlineComponents=e})}function G0(n){return n.name==="FirebaseError"?n.code===P.FAILED_PRECONDITION||n.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function W0(n){return _(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){L("FirestoreClient","Using user provided OfflineComponentProvider");try{yield dh(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!G0(t))throw t;Sr("Error using user provided cache. Falling back to memory cache: "+t),yield dh(n,new La)}}else L("FirestoreClient","Using default OfflineComponentProvider"),yield dh(n,new La);return n._offlineComponents})}function p_(n){return _(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(L("FirestoreClient","Using user provided OnlineComponentProvider"),yield pv(n,n._uninitializedComponentsProvider._online)):(L("FirestoreClient","Using default OnlineComponentProvider"),yield pv(n,new xd))),n._onlineComponents})}function K0(n){return p_(n).then(e=>e.syncEngine)}function Ld(n){return _(this,null,function*(){let e=yield p_(n),t=e.eventManager;return t.onListen=k0.bind(null,e.syncEngine),t.onUnlisten=M0.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=O0.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=L0.bind(null,e.syncEngine),t})}function H0(n,e,t={}){let r=new mt;return n.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,a,c,l,h){let f=new Va({next:I=>{a.enqueueAndForget(()=>a_(s,g));let R=I.docs.has(c);!R&&I.fromCache?h.reject(new M(P.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&I.fromCache&&l&&l.source==="server"?h.reject(new M(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(I)},error:I=>h.reject(I)}),g=new Oa(Ka(c.path),f,{includeMetadataChanges:!0,ra:!0});return o_(s,g)}(yield Ld(n),n.asyncQueue,e,t,r)})),r.promise}function m_(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var mv=new Map;function g_(n,e,t){if(!t)throw new M(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Q0(n,e,t,r){if(e===!0&&r===!0)throw new M(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gv(n){if(!U.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function yv(n){if(U.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Za(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B()}function rt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Za(n);throw new M(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Fa=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Q0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=m_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Vr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fa({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fa(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new fh;switch(r.type){case"firstParty":return new yh(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=mv.get(t);r&&(L("ComponentProvider","Removing Datastore"),mv.delete(t),r.terminate())}(this),Promise.resolve()}};function y_(n,e,t,r={}){var i;let s=(n=rt(n,Vr))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Sr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let c,l;if(typeof r.mockUserToken=="string")c=r.mockUserToken,l=be.MOCK_USER;else{c=Eg(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new M(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new be(h)}n._authCredentials=new ph(new da(c,l))}}var Fr=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Le=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},hn=class n extends Fr{constructor(e,t,r){super(e,t,Ka(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new U(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function v_(n,e,...t){if(n=me(n),g_("collection","path",e),n instanceof Vr){let r=le.fromString(e,...t);return yv(r),new hn(n,null,r)}{if(!(n instanceof Le||n instanceof hn))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(le.fromString(e,...t));return yv(r),new hn(n.firestore,null,r)}}function cf(n,e,...t){if(n=me(n),arguments.length===1&&(e=fa.newId()),g_("doc","path",e),n instanceof Vr){let r=le.fromString(e,...t);return gv(r),new Le(n,null,new U(r))}{if(!(n instanceof Le||n instanceof hn))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(le.fromString(e,...t));return gv(r),new Le(n.firestore,n instanceof hn?n.converter:null,new U(r))}}var Vd=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Ca(this,"async_queue_retry"),this.hu=()=>{let t=hh();t&&L("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};let e=hh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let t=hh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let t=new mt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return _(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!bs(e))throw e;L("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(r);throw Mt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);let i=bd.createAndSchedule(this,e,t,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&B()}verifyOperationInProgress(){}du(){return _(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let t=this._u.indexOf(e);this._u.splice(t,1)}};function vv(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Ft=class extends Vr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new Vd}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||I_(this),this._firestoreClient.terminate()}};function __(n,e){let t=typeof n=="object"?n:fr(),r=typeof n=="string"?n:e||"(default)",i=Hi(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=wg("firestore");s&&y_(i,...s)}return i}function uf(n){return n._firestoreClient||I_(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function I_(n){var e,t,r;let i=n._freezeSettings(),s=function(c,l,h,f){return new Eh(c,l,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,m_(f.experimentalLongPollingOptions),f.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new Md(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Is=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(je.fromBase64String(e))}catch(t){throw new M(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ur=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ws=class{constructor(e){this._methodName=e}};var Es=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return re(this._lat,e._lat)||re(this._long,e._long)}};var J0=/^__.*__$/,Fd=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new It(e,this.data,this.fieldMask,t,this.fieldTransforms):new qn(e,this.data,t,this.fieldTransforms)}},Ua=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new It(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function w_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}var Ud=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return $a(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(w_(this.fu)&&J0.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},jd=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ja(e)}Fu(e,t,r,i=!1){return new Ud({fu:e,methodName:t,vu:r,path:Qe.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ec(n){let e=n._freezeSettings(),t=Ja(n._databaseId);return new jd(n._databaseId,!!e.ignoreUndefinedProperties,t)}function E_(n,e,t,r,i,s={}){let a=n.Fu(s.merge||s.mergeFields?2:0,e,t,i);lf("Data must be an object, but it was:",a,r);let c=T_(r,a),l,h;if(s.merge)l=new Ze(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){let f=[];for(let g of s.mergeFields){let I=$d(e,g,t);if(!a.contains(I))throw new M(P.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);b_(f,I)||f.push(I)}l=new Ze(f),h=a.fieldTransforms.filter(g=>l.covers(g.field))}else l=null,h=a.fieldTransforms;return new Fd(new He(c),l,h)}var ja=class n extends ws{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function Y0(n,e,t,r){let i=n.Fu(1,e,t);lf("Data must be an object, but it was:",i,r);let s=[],a=He.empty();zn(r,(l,h)=>{let f=hf(e,l,t);h=me(h);let g=i.Su(f);if(h instanceof ja)s.push(f);else{let I=Cs(h,g);I!=null&&(s.push(f),a.set(f,I))}});let c=new Ze(s);return new Ua(a,c,i.fieldTransforms)}function X0(n,e,t,r,i,s){let a=n.Fu(1,e,t),c=[$d(e,r,t)],l=[i];if(s.length%2!=0)throw new M(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)c.push($d(e,s[I])),l.push(s[I+1]);let h=[],f=He.empty();for(let I=c.length-1;I>=0;--I)if(!b_(h,c[I])){let R=c[I],N=l[I];N=me(N);let O=a.Su(R);if(N instanceof ja)h.push(R);else{let C=Cs(N,O);C!=null&&(h.push(R),f.set(R,C))}}let g=new Ze(h);return new Ua(f,g,a.fieldTransforms)}function Z0(n,e,t,r=!1){return Cs(t,n.Fu(r?4:3,e))}function Cs(n,e){if(A_(n=me(n)))return lf("Unsupported field value:",e,n),T_(n,e);if(n instanceof ws)return function(r,i){if(!w_(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let c of r){let l=Cs(c,i.bu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=me(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return UR(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Pe.fromDate(r);return{timestampValue:Aa(i.serializer,s)}}if(r instanceof Pe){let s=new Pe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Aa(i.serializer,s)}}if(r instanceof Es)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Is)return{bytesValue:Gv(i.serializer,r._byteString)};if(r instanceof Le){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Du(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Zd(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${Za(r)}`)}(n,e)}function T_(n,e){let t={};return Ev(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zn(n,(r,i)=>{let s=Cs(i,e.pu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function A_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Pe||n instanceof Es||n instanceof Is||n instanceof Le||n instanceof ws)}function lf(n,e,t){if(!A_(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Za(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function $d(n,e,t){if((e=me(e))instanceof Ur)return e._internalPath;if(typeof e=="string")return hf(n,e);throw $a("Field path arguments must be of type string or ",n,!1,void 0,t)}var eC=new RegExp("[~\\*/\\[\\]]");function hf(n,e,t){if(e.search(eC)>=0)throw $a(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ur(...e.split("."))._internalPath}catch{throw $a(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $a(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new M(P.INVALID_ARGUMENT,c+n+l)}function b_(n,e){return n.some(t=>t.isEqual(e))}var Ba=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Le(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Bd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(df("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Bd=class extends Ba{data(){return super.data()}};function df(n,e){return typeof e=="string"?hf(n,e):e instanceof Ur?e._internalPath:e._delegate._internalPath}function tC(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new M(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ts=class{},qd=class extends Ts{};function S_(n,e,...t){let r=[];e instanceof Ts&&r.push(e),r=r.concat(t),function(s){let a=s.filter(l=>l instanceof zd).length,c=s.filter(l=>l instanceof qa).length;if(a>1||a>0&&c>0)throw new M(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var qa=class n extends qd{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return C_(e._query,t),new Fr(e.firestore,e.converter,Mh(e._query,t))}_parse(e){let t=ec(e.firestore);return function(s,a,c,l,h,f,g){let I;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new M(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Iv(g,f);let R=[];for(let N of g)R.push(_v(l,s,N));I={arrayValue:{values:R}}}else I=_v(l,s,g)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Iv(g,f),I=Z0(c,a,g,f==="in"||f==="not-in");return ve.create(h,f,I)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function R_(n,e,t){let r=e,i=df("where",n);return qa._create(i,r,t)}var zd=class n extends Ts{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:st.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i,c=s.getFlattenedFilters();for(let l of c)C_(a,l),a=Mh(a,l)}(e._query,t),new Fr(e.firestore,e.converter,Mh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function _v(n,e,t){if(typeof(t=me(t))=="string"){if(t==="")throw new M(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dv(e)&&t.indexOf("/")!==-1)throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(le.fromString(t));if(!U.isDocumentKey(r))throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wy(n,new U(r))}if(t instanceof Le)return Wy(n,t._key);throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Za(t)}.`)}function Iv(n,e){if(!Array.isArray(n)||n.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function C_(n,e){let t=function(i,s){for(let a of i)for(let c of a.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Gd=class{convertValue(e,t="none"){switch(Un(e)){case 0:return null;case 1:return e.booleanValue;case 2:return de(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(dn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw B()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return zn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Es(de(e.latitude),de(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Qd(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ps(e));default:return null}}convertTimestamp(e){let t=Lt(e);return new Pe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=le.fromString(e);ae(Yv(r));let i=new ya(r.get(1),r.get(3)),s=new U(r.popFirst(5));return i.isEqual(t)||Mt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function P_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Ln=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},za=class extends Ba{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new br(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(df("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},br=class extends za{data(e={}){return super.data(e)}},Wd=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ln(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new br(this._firestore,this._userDataWriter,r.key,r,new Ln(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{let l=new br(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Ln(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new br(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Ln(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),h=-1,f=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:nC(c.type),doc:l,oldIndex:h,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function nC(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B()}}function D_(n){n=rt(n,Le);let e=rt(n.firestore,Ft);return H0(uf(e),n._key).then(t=>x_(e,n,t))}var Ga=class extends Gd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Is(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,t)}};function N_(n,e,t){n=rt(n,Le);let r=rt(n.firestore,Ft),i=P_(n.converter,e,t);return pf(r,[E_(ec(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,xt.none())])}function k_(n,e,t,...r){n=rt(n,Le);let i=rt(n.firestore,Ft),s=ec(i),a;return a=typeof(e=me(e))=="string"||e instanceof Ur?X0(s,"updateDoc",n._key,e,t,r):Y0(s,"updateDoc",n._key,e),pf(i,[a.toMutation(n._key,xt.exists(!0))])}function O_(n,e){let t=rt(n.firestore,Ft),r=cf(n),i=P_(n.converter,e);return pf(t,[E_(ec(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,xt.exists(!1))]).then(()=>r)}function ff(n,...e){var t,r,i;n=me(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||vv(e[a])||(s=e[a],a++);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(vv(e[a])){let g=e[a];e[a]=(t=g.next)===null||t===void 0?void 0:t.bind(g),e[a+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[a+2]=(i=g.complete)===null||i===void 0?void 0:i.bind(g)}let l,h,f;if(n instanceof Le)h=rt(n.firestore,Ft),f=Ka(n._key.path),l={next:g=>{e[a]&&e[a](x_(h,n,g))},error:e[a+1],complete:e[a+2]};else{let g=rt(n,Fr);h=rt(g.firestore,Ft),f=g._query;let I=new Ga(h);l={next:R=>{e[a]&&e[a](new Wd(h,I,g,R))},error:e[a+1],complete:e[a+2]},tC(n._query)}return function(I,R,N,O){let C=new Va(O),x=new Oa(R,C,N);return I.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return o_(yield Ld(I),x)})),()=>{C.$a(),I.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return a_(yield Ld(I),x)}))}}(uf(h),f,c,l)}function pf(n,e){return function(r,i){let s=new mt;return r.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return V0(yield K0(r),i,s)})),s.promise}(uf(n),e)}function x_(n,e,t){let r=t.docs.get(e._key),i=new Ga(n);return new za(n,i,e._key,r,new Ln(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){jr=i})(sn),rn(new Xe("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),c=new Ft(new mh(r.getProvider("auth-internal")),new _h(r.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new M(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ya(h.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),Ee(qy,"4.6.3",e),Ee(qy,"4.6.3","esm2017")})();var tc=function(){return tc=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},tc.apply(this,arguments)};var sC={includeMetadataChanges:!1};function M_(n,e){return e===void 0&&(e=sC),new At(function(t){var r=ff(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function L_(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:tc(tc({},r),(t={},t[e.idField]=n.id,t))}function V_(n){return M_(n,{includeMetadataChanges:!0}).pipe(ee(function(e){return e.docs}))}function F_(n,e){return e===void 0&&(e={}),V_(n).pipe(ee(function(t){return t.map(function(r){return L_(r,e)})}))}var Ps=class{constructor(e){return e}},U_="firestore",mf=class{constructor(){return Qi(U_)}};var gf=new ie("angularfire2.firestore-instances");function oC(n,e){let t=Vo(U_,n,e);return t&&new Ps(t)}function aC(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ps(r)}}var cC={provide:mf,deps:[[new Ue,gf]]},uC={provide:Ps,useFactory:oC,deps:[[new Ue,gf],Pt]};function Yk(n,...e){return Ee("angularfire",Cn.full,"fst"),tt([uC,cC,{provide:gf,useFactory:aC(n),multi:!0,deps:[pe,bt,gr,Pn,[new Ue,ss],[new Ue,mr],...e]}])}var Xk=Ae(F_,!0);var Zk=Ae(O_,!0);var eO=Ae(v_,!0);var tO=Ae(cf,!0);var nO=Ae(D_,!0);var rO=Ae(__,!0);var iO=Ae(S_,!0);var sO=Ae(N_,!0);var oO=Ae(k_,!0);var aO=Ae(R_,!0);export{wn as a,PI as b,EC as c,Im as d,qC as e,fw as f,Zt as g,qw as h,Rt as i,hP as j,dP as k,fP as l,wg as m,Eg as n,Ke as o,me as p,Xe as q,rn as r,Hi as s,sn as t,fr as u,Ee as v,Cn as w,Vo as x,Qi as y,mr as z,gr as A,Ae as B,Pt as C,Pn as D,tD as E,nD as F,is as G,ss as H,tN as I,nN as J,rN as K,iN as L,sN as M,Ps as N,Yk as O,Xk as P,Zk as Q,eO as R,tO as S,nO as T,rO as U,iO as V,sO as W,oO as X,aO as Y};
